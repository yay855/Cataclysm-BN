<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cataclysm BN: character_funcs Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cataclysm BN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacecharacter__funcs.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">character_funcs Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcharacter__funcs_1_1comfort__response__t.html">comfort_response_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a8614d6647ae110ba51944af26b80ecb7"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7">comfort_level</a> { <br />
&#160;&#160;<a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a79a2520f22b9e1526ff93176029603b8">impossible</a> = -999
, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7ac19a5c3628d86633a40e23c78d4ff67d">uncomfortable</a> = -7
, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a5da248ea6840aca1ae2b417b17982a89">neutral</a> = 0
, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a1493fbda00a5e67f5f6d8d619489a6af">slightly_comfortable</a> = 3
, <br />
&#160;&#160;<a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7aff52b9c1eee2349b5099deb92b8307ed">comfortable</a> = 5
, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a2d02b60eaa3c25912ee2e3ba0b669068">very_comfortable</a> = 10
<br />
 }</td></tr>
<tr class="separator:a8614d6647ae110ba51944af26b80ecb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a470b862a6936cbfbd1e80a46b78f1914"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtime__duration.html">time_duration</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a470b862a6936cbfbd1e80a46b78f1914">estimate_effect_dur</a> (int skill_lvl, const <a class="el" href="type__id_8h.html#acc8305d21e9a186d196c8ff88ba2cf19">efftype_id</a> &amp;<a class="el" href="classeffect.html">effect</a>, const <a class="el" href="classtime__duration.html">time_duration</a> &amp;error_magnitude, int threshold, const <a class="el" href="classCreature.html">Creature</a> &amp;target)</td></tr>
<tr class="memdesc:a470b862a6936cbfbd1e80a46b78f1914"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimate effect duration based on relevant skill.  <a href="namespacecharacter__funcs.html#a470b862a6936cbfbd1e80a46b78f1914">More...</a><br /></td></tr>
<tr class="separator:a470b862a6936cbfbd1e80a46b78f1914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa760a90e1a9cc452c7b756bcde2a60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#adaa760a90e1a9cc452c7b756bcde2a60">siphon</a> (<a class="el" href="classCharacter.html">Character</a> &amp;ch, <a class="el" href="classvehicle.html">vehicle</a> &amp;veh, const <a class="el" href="type__id_8h.html#ac2f82f863d4e9e8f267a77a73910ebbf">itype_id</a> &amp;desired_liquid)</td></tr>
<tr class="memdesc:adaa760a90e1a9cc452c7b756bcde2a60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Siphons fuel (if available) from the specified vehicle into container or similar via game::handle_liquid.  <a href="namespacecharacter__funcs.html#adaa760a90e1a9cc452c7b756bcde2a60">More...</a><br /></td></tr>
<tr class="separator:adaa760a90e1a9cc452c7b756bcde2a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862df11441bba358b82fa47ce88ebe85"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a862df11441bba358b82fa47ce88ebe85">is_fun_to_read</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;ch, const <a class="el" href="classitem.html">item</a> &amp;book)</td></tr>
<tr class="memdesc:a862df11441bba358b82fa47ce88ebe85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether character considers it fun to read the book.  <a href="namespacecharacter__funcs.html#a862df11441bba358b82fa47ce88ebe85">More...</a><br /></td></tr>
<tr class="separator:a862df11441bba358b82fa47ce88ebe85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa9f2cc376f03128e0a486a90c7376fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#aaa9f2cc376f03128e0a486a90c7376fa">get_book_fun_for</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;ch, const <a class="el" href="classitem.html">item</a> &amp;book)</td></tr>
<tr class="memdesc:aaa9f2cc376f03128e0a486a90c7376fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns enjoyability value of a book for given character.  <a href="namespacecharacter__funcs.html#aaa9f2cc376f03128e0a486a90c7376fa">More...</a><br /></td></tr>
<tr class="separator:aaa9f2cc376f03128e0a486a90c7376fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1686a89929a324a03d1396cac6ab1a24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcharacter__funcs_1_1comfort__response__t.html">comfort_response_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a1686a89929a324a03d1396cac6ab1a24">base_comfort_value</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="structtripoint.html">tripoint</a> &amp;p)</td></tr>
<tr class="memdesc:a1686a89929a324a03d1396cac6ab1a24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate point's ability to serve as a bed.  <a href="namespacecharacter__funcs.html#a1686a89929a324a03d1396cac6ab1a24">More...</a><br /></td></tr>
<tr class="separator:a1686a89929a324a03d1396cac6ab1a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a392d1b99006a4f1f16c773e38762043d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a392d1b99006a4f1f16c773e38762043d">rate_sleep_spot</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="structtripoint.html">tripoint</a> &amp;p)</td></tr>
<tr class="memdesc:a392d1b99006a4f1f16c773e38762043d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate point's ability to serve as a bed.  <a href="namespacecharacter__funcs.html#a392d1b99006a4f1f16c773e38762043d">More...</a><br /></td></tr>
<tr class="separator:a392d1b99006a4f1f16c773e38762043d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d62ac71c344a9b0482777456bb7b74"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a16d62ac71c344a9b0482777456bb7b74">roll_can_sleep</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a16d62ac71c344a9b0482777456bb7b74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checked each turn during "lying_down", returns true if the avatar falls asleep.  <a href="namespacecharacter__funcs.html#a16d62ac71c344a9b0482777456bb7b74">More...</a><br /></td></tr>
<tr class="separator:a16d62ac71c344a9b0482777456bb7b74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dce7cdd9fb67e45d224f22aea0ff920"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a0dce7cdd9fb67e45d224f22aea0ff920">can_interface_armor</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a0dce7cdd9fb67e45d224f22aea0ff920"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether character has an active bionic capable of interfacing with power armor.  <a href="namespacecharacter__funcs.html#a0dce7cdd9fb67e45d224f22aea0ff920">More...</a><br /></td></tr>
<tr class="separator:a0dce7cdd9fb67e45d224f22aea0ff920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c63f47142d40af0092a1be132a53efa"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a6c63f47142d40af0092a1be132a53efa">fmt_wielded_weapon</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a6c63f47142d40af0092a1be132a53efa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the formatted name of the currently wielded item (if any) with current gun mode (if gun)  <a href="namespacecharacter__funcs.html#a6c63f47142d40af0092a1be132a53efa">More...</a><br /></td></tr>
<tr class="separator:a6c63f47142d40af0092a1be132a53efa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d2e2c3c197301f7e9c3e4608e912eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a95d2e2c3c197301f7e9c3e4608e912eb">add_pain_msg</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, int val, <a class="el" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980">body_part</a> bp)</td></tr>
<tr class="memdesc:a95d2e2c3c197301f7e9c3e4608e912eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add message describing how character feels pain.  <a href="namespacecharacter__funcs.html#a95d2e2c3c197301f7e9c3e4608e912eb">More...</a><br /></td></tr>
<tr class="separator:a95d2e2c3c197301f7e9c3e4608e912eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ed0deeee8eeb3cd6d3339fefd86e30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a84ed0deeee8eeb3cd6d3339fefd86e30">normalize</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a84ed0deeee8eeb3cd6d3339fefd86e30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset <a class="el" href="classCharacter.html">Character</a>'s weapon and body state (limb hp, stamina, active martial art)  <a href="namespacecharacter__funcs.html#a84ed0deeee8eeb3cd6d3339fefd86e30">More...</a><br /></td></tr>
<tr class="separator:a84ed0deeee8eeb3cd6d3339fefd86e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bb166af94213cb87deb941f1852509e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a6bb166af94213cb87deb941f1852509e">store_in_container</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who, <a class="el" href="classitem.html">item</a> &amp;container, <a class="el" href="classitem.html">item</a> &amp;put, bool penalties, int base_cost)</td></tr>
<tr class="memdesc:a6bb166af94213cb87deb941f1852509e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores an item inside another consuming moves proportional to weapon skill and volume.  <a href="namespacecharacter__funcs.html#a6bb166af94213cb87deb941f1852509e">More...</a><br /></td></tr>
<tr class="separator:a6bb166af94213cb87deb941f1852509e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da89a8af73cef834ada9624a6669a31"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a4da89a8af73cef834ada9624a6669a31">try_wield_contents</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who, <a class="el" href="classitem.html">item</a> &amp;container, <a class="el" href="classitem.html">item</a> *internal_item, bool penalties, int base_cost)</td></tr>
<tr class="memdesc:a4da89a8af73cef834ada9624a6669a31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to wield a contained item consuming moves proportional to weapon skill and volume.  <a href="namespacecharacter__funcs.html#a4da89a8af73cef834ada9624a6669a31">More...</a><br /></td></tr>
<tr class="separator:a4da89a8af73cef834ada9624a6669a31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11c9faad62fd3d26d41cbf1d68391bb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#ab11c9faad62fd3d26d41cbf1d68391bb">try_uncanny_dodge</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:ab11c9faad62fd3d26d41cbf1d68391bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to execute an uncanny dodge bionic ability.  <a href="namespacecharacter__funcs.html#ab11c9faad62fd3d26d41cbf1d68391bb">More...</a><br /></td></tr>
<tr class="separator:ab11c9faad62fd3d26d41cbf1d68391bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13637305f9b6578e07749ae4ab8e784d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcata_1_1optional.html">cata::optional</a>&lt; <a class="el" href="structtripoint.html">tripoint</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a13637305f9b6578e07749ae4ab8e784d">pick_safe_adjacent_tile</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a13637305f9b6578e07749ae4ab8e784d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns an unoccupied, safe adjacent point.  <a href="namespacecharacter__funcs.html#a13637305f9b6578e07749ae4ab8e784d">More...</a><br /></td></tr>
<tr class="separator:a13637305f9b6578e07749ae4ab8e784d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a399c6dcbda8cc41854ac06749ba45d86"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a399c6dcbda8cc41854ac06749ba45d86">is_bp_immune_to</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, <a class="el" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980">body_part</a> bp, <a class="el" href="structdamage__unit.html">damage_unit</a> dam)</td></tr>
<tr class="memdesc:a399c6dcbda8cc41854ac06749ba45d86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if character's body part is immune to given damage.  <a href="namespacecharacter__funcs.html#a399c6dcbda8cc41854ac06749ba45d86">More...</a><br /></td></tr>
<tr class="separator:a399c6dcbda8cc41854ac06749ba45d86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1841dddaff2b8469caeb0fb5a2e161e8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classnpc.html">npc</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a1841dddaff2b8469caeb0fb5a2e161e8">get_crafting_helpers</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, int max=-1)</td></tr>
<tr class="memdesc:a1841dddaff2b8469caeb0fb5a2e161e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns nearby NPCs ready and willing to help with crafting or some other manual task.  <a href="namespacecharacter__funcs.html#a1841dddaff2b8469caeb0fb5a2e161e8">More...</a><br /></td></tr>
<tr class="separator:a1841dddaff2b8469caeb0fb5a2e161e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9c092872bd448a887024fe5379816d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#abb9c092872bd448a887024fe5379816d">get_lift_strength</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:abb9c092872bd448a887024fe5379816d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns <a class="el" href="classCharacter.html">Character</a> lift strength unassisted by helpers or equipment.  <a href="namespacecharacter__funcs.html#abb9c092872bd448a887024fe5379816d">More...</a><br /></td></tr>
<tr class="separator:abb9c092872bd448a887024fe5379816d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc55ada93348dbdeea0b7f69151956f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#afc55ada93348dbdeea0b7f69151956f5">get_lift_strength_with_helpers</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:afc55ada93348dbdeea0b7f69151956f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns <a class="el" href="classCharacter.html">Character</a> lift strength without equipment including bonus from nearby helpers.  <a href="namespacecharacter__funcs.html#afc55ada93348dbdeea0b7f69151956f5">More...</a><br /></td></tr>
<tr class="separator:afc55ada93348dbdeea0b7f69151956f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa14127fd34677b0e529bb14166513850"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#aa14127fd34677b0e529bb14166513850">can_lift_with_helpers</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, int lift_required)</td></tr>
<tr class="memdesc:aa14127fd34677b0e529bb14166513850"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether character can lift given value (includes bonus from helpers).  <a href="namespacecharacter__funcs.html#aa14127fd34677b0e529bb14166513850">More...</a><br /></td></tr>
<tr class="separator:aa14127fd34677b0e529bb14166513850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7bfa36ae343bba14f1630cc9350f2d9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#ae7bfa36ae343bba14f1630cc9350f2d9">list_ammo</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="classitem.html">item</a> &amp;base, std::vector&lt; <a class="el" href="classitem__reload__option.html">item_reload_option</a> &gt; &amp;ammo_list, bool include_empty_mags, bool include_potential)</td></tr>
<tr class="memdesc:ae7bfa36ae343bba14f1630cc9350f2d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">List ammo suitable for given item.  <a href="namespacecharacter__funcs.html#ae7bfa36ae343bba14f1630cc9350f2d9">More...</a><br /></td></tr>
<tr class="separator:ae7bfa36ae343bba14f1630cc9350f2d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c310418ea1c2bab8b4b03d7e0981df9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classitem__reload__option.html">item_reload_option</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a4c310418ea1c2bab8b4b03d7e0981df9">select_ammo</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="classitem.html">item</a> &amp;base, std::vector&lt; <a class="el" href="classitem__reload__option.html">item_reload_option</a> &gt; opts)</td></tr>
<tr class="memdesc:a4c310418ea1c2bab8b4b03d7e0981df9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select ammo from the provided options.  <a href="namespacecharacter__funcs.html#a4c310418ea1c2bab8b4b03d7e0981df9">More...</a><br /></td></tr>
<tr class="separator:a4c310418ea1c2bab8b4b03d7e0981df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b4188451961979984887e12b54e27c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classitem__reload__option.html">item_reload_option</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a8b4188451961979984887e12b54e27c3">select_ammo</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="classitem.html">item</a> &amp;base, bool prompt=false, bool include_empty_mags=true, bool include_potential=false)</td></tr>
<tr class="memdesc:a8b4188451961979984887e12b54e27c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select suitable ammo with which to reload the item.  <a href="namespacecharacter__funcs.html#a8b4188451961979984887e12b54e27c3">More...</a><br /></td></tr>
<tr class="separator:a8b4188451961979984887e12b54e27c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67879d31b9151a69132475569b1de783"><td class="memItemLeft" align="right" valign="top">std::vector&lt; const <a class="el" href="classitem.html">item</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a67879d31b9151a69132475569b1de783">get_ammo_items</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="type__id_8h.html#a4a240e1107e45f10d64b78f1b5f58d59">ammotype</a> &amp;at)</td></tr>
<tr class="memdesc:a67879d31b9151a69132475569b1de783"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns character's items that are ammo and have the matching ammo type.  <a href="namespacecharacter__funcs.html#a67879d31b9151a69132475569b1de783">More...</a><br /></td></tr>
<tr class="separator:a67879d31b9151a69132475569b1de783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f96350c8609af351eb0c0b83d899748"><td class="memTemplParams" colspan="2">template&lt;typename T , typename Output &gt; </td></tr>
<tr class="memitem:a5f96350c8609af351eb0c0b83d899748"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a5f96350c8609af351eb0c0b83d899748">find_ammo_helper</a> (T &amp;src, const <a class="el" href="classitem.html">item</a> &amp;obj, bool empty, Output out, bool nested)</td></tr>
<tr class="separator:a5f96350c8609af351eb0c0b83d899748"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0d4f519cd76c1891183b3c557bdf007"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classitem__location.html">item_location</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#af0d4f519cd76c1891183b3c557bdf007">find_ammo_items_or_mags</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="classitem.html">item</a> &amp;obj, bool empty=true, int radius=1)</td></tr>
<tr class="memdesc:af0d4f519cd76c1891183b3c557bdf007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches for ammo or magazines that can be used to reload given item.  <a href="namespacecharacter__funcs.html#af0d4f519cd76c1891183b3c557bdf007">More...</a><br /></td></tr>
<tr class="separator:af0d4f519cd76c1891183b3c557bdf007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23064b8a06c8495a2faca7aff01b1c05"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classitem__location.html">item_location</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a23064b8a06c8495a2faca7aff01b1c05">find_reloadables</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a23064b8a06c8495a2faca7aff01b1c05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches for weapons and magazines that can be reloaded.  <a href="namespacecharacter__funcs.html#a23064b8a06c8495a2faca7aff01b1c05">More...</a><br /></td></tr>
<tr class="separator:a23064b8a06c8495a2faca7aff01b1c05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97bfa1444b6ed6f142910821e84fe313"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a97bfa1444b6ed6f142910821e84fe313">ammo_count_for</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="classitem.html">item</a> &amp;gun)</td></tr>
<tr class="memdesc:a97bfa1444b6ed6f142910821e84fe313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts ammo and UPS charges (lower of) for a given gun on the character.  <a href="namespacecharacter__funcs.html#a97bfa1444b6ed6f142910821e84fe313">More...</a><br /></td></tr>
<tr class="separator:a97bfa1444b6ed6f142910821e84fe313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35eeb8ee18c0888409eb1a131da3aae1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a35eeb8ee18c0888409eb1a131da3aae1">show_skill_capped_notice</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="type__id_8h.html#a13f6e54f55e89d7c6cd86da6d0a7e785">skill_id</a> &amp;id)</td></tr>
<tr class="memdesc:a35eeb8ee18c0888409eb1a131da3aae1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This shows warning to the player that their current activity will not give them xp.  <a href="namespacecharacter__funcs.html#a35eeb8ee18c0888409eb1a131da3aae1">More...</a><br /></td></tr>
<tr class="separator:a35eeb8ee18c0888409eb1a131da3aae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa9463f9c384d1e193bdbc8dc337f8d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#afa9463f9c384d1e193bdbc8dc337f8d3">update_body_wetness</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="structw__point.html">w_point</a> &amp;weather)</td></tr>
<tr class="memdesc:afa9463f9c384d1e193bdbc8dc337f8d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maintains body wetness and handles the rate at which the player dries.  <a href="namespacecharacter__funcs.html#afa9463f9c384d1e193bdbc8dc337f8d3">More...</a><br /></td></tr>
<tr class="separator:afa9463f9c384d1e193bdbc8dc337f8d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b6391933c53c0461e4e64fa9930d472"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a8b6391933c53c0461e4e64fa9930d472">do_pause</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a8b6391933c53c0461e4e64fa9930d472"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do pause action ('.  <a href="namespacecharacter__funcs.html#a8b6391933c53c0461e4e64fa9930d472">More...</a><br /></td></tr>
<tr class="separator:a8b6391933c53c0461e4e64fa9930d472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b7fa49a536bb361b3a6b2ef669bea4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a53b7fa49a536bb361b3a6b2ef669bea4">search_surroundings</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a53b7fa49a536bb361b3a6b2ef669bea4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search surrounding squares for traps (and maybe other things in the future).  <a href="namespacecharacter__funcs.html#a53b7fa49a536bb361b3a6b2ef669bea4">More...</a><br /></td></tr>
<tr class="separator:a53b7fa49a536bb361b3a6b2ef669bea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a641323aa837163a8a245868a5043035a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a641323aa837163a8a245868a5043035a">update_mental_focus</a> (<a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a641323aa837163a8a245868a5043035a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses calc_focus_change to update the player's current focus.  <a href="namespacecharacter__funcs.html#a641323aa837163a8a245868a5043035a">More...</a><br /></td></tr>
<tr class="separator:a641323aa837163a8a245868a5043035a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:adda4d5fd10b7216c49a0f9b6010de579"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#adda4d5fd10b7216c49a0f9b6010de579">fine_detail_vision_mod</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:adda4d5fd10b7216c49a0f9b6010de579"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates multiplier for the time taken to perform tasks that require detail vision (reading, crafting, etc.).  <a href="namespacecharacter__funcs.html#adda4d5fd10b7216c49a0f9b6010de579">More...</a><br /></td></tr>
<tr class="separator:adda4d5fd10b7216c49a0f9b6010de579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03ea116da570af10c630e0fe3a7ea6fc"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a03ea116da570af10c630e0fe3a7ea6fc">fine_detail_vision_mod</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="structtripoint.html">tripoint</a> &amp;p)</td></tr>
<tr class="separator:a03ea116da570af10c630e0fe3a7ea6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a813a9decd34980fe53f38ba18ffd6374"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a813a9decd34980fe53f38ba18ffd6374">can_see_fine_details</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who)</td></tr>
<tr class="memdesc:a813a9decd34980fe53f38ba18ffd6374"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether character vision at given pos is good enough to see fine details.  <a href="namespacecharacter__funcs.html#a813a9decd34980fe53f38ba18ffd6374">More...</a><br /></td></tr>
<tr class="separator:a813a9decd34980fe53f38ba18ffd6374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68c0c236c653e5217f1436bfadd54664"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a68c0c236c653e5217f1436bfadd54664">can_see_fine_details</a> (const <a class="el" href="classCharacter.html">Character</a> &amp;who, const <a class="el" href="structtripoint.html">tripoint</a> &amp;p)</td></tr>
<tr class="separator:a68c0c236c653e5217f1436bfadd54664"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac767ac632c0c783c8615f5e920cc938e"><td class="memItemLeft" align="right" valign="top">constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#ac767ac632c0c783c8615f5e920cc938e">FINE_VISION_THRESHOLD</a> = 4.0f</td></tr>
<tr class="memdesc:ac767ac632c0c783c8615f5e920cc938e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Threshold for fine detail vision mod.  <a href="namespacecharacter__funcs.html#ac767ac632c0c783c8615f5e920cc938e">More...</a><br /></td></tr>
<tr class="separator:ac767ac632c0c783c8615f5e920cc938e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e103652bd1f087acad98fa135eca4a4"><td class="memItemLeft" align="right" valign="top">constexpr float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecharacter__funcs.html#a4e103652bd1f087acad98fa135eca4a4">FINE_VISION_PERFECT</a> = 1.0f</td></tr>
<tr class="memdesc:a4e103652bd1f087acad98fa135eca4a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value for perfect fine detail vision.  <a href="namespacecharacter__funcs.html#a4e103652bd1f087acad98fa135eca4a4">More...</a><br /></td></tr>
<tr class="separator:a4e103652bd1f087acad98fa135eca4a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a8614d6647ae110ba51944af26b80ecb7" name="a8614d6647ae110ba51944af26b80ecb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8614d6647ae110ba51944af26b80ecb7">&#9670;&nbsp;</a></span>comfort_level</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7">character_funcs::comfort_level</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a8614d6647ae110ba51944af26b80ecb7a79a2520f22b9e1526ff93176029603b8" name="a8614d6647ae110ba51944af26b80ecb7a79a2520f22b9e1526ff93176029603b8"></a>impossible&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8614d6647ae110ba51944af26b80ecb7ac19a5c3628d86633a40e23c78d4ff67d" name="a8614d6647ae110ba51944af26b80ecb7ac19a5c3628d86633a40e23c78d4ff67d"></a>uncomfortable&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8614d6647ae110ba51944af26b80ecb7a5da248ea6840aca1ae2b417b17982a89" name="a8614d6647ae110ba51944af26b80ecb7a5da248ea6840aca1ae2b417b17982a89"></a>neutral&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8614d6647ae110ba51944af26b80ecb7a1493fbda00a5e67f5f6d8d619489a6af" name="a8614d6647ae110ba51944af26b80ecb7a1493fbda00a5e67f5f6d8d619489a6af"></a>slightly_comfortable&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8614d6647ae110ba51944af26b80ecb7aff52b9c1eee2349b5099deb92b8307ed" name="a8614d6647ae110ba51944af26b80ecb7aff52b9c1eee2349b5099deb92b8307ed"></a>comfortable&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8614d6647ae110ba51944af26b80ecb7a2d02b60eaa3c25912ee2e3ba0b669068" name="a8614d6647ae110ba51944af26b80ecb7a2d02b60eaa3c25912ee2e3ba0b669068"></a>very_comfortable&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="character__functions_8h_source.html#l00082">82</a> of file <a class="el" href="character__functions_8h_source.html">character_functions.h</a>.</p>
<div class="fragment"><div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                         {</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <a class="code hl_enumvalue" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a79a2520f22b9e1526ff93176029603b8">impossible</a> = -999,</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <a class="code hl_enumvalue" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7ac19a5c3628d86633a40e23c78d4ff67d">uncomfortable</a> = -7,</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <a class="code hl_enumvalue" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a5da248ea6840aca1ae2b417b17982a89">neutral</a> = 0,</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <a class="code hl_enumvalue" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a1493fbda00a5e67f5f6d8d619489a6af">slightly_comfortable</a> = 3,</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <a class="code hl_enumvalue" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7aff52b9c1eee2349b5099deb92b8307ed">comfortable</a> = 5,</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <a class="code hl_enumvalue" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a2d02b60eaa3c25912ee2e3ba0b669068">very_comfortable</a> = 10</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>};</div>
<div class="ttc" id="anamespacecharacter__funcs_html_a8614d6647ae110ba51944af26b80ecb7a1493fbda00a5e67f5f6d8d619489a6af"><div class="ttname"><a href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a1493fbda00a5e67f5f6d8d619489a6af">character_funcs::comfort_level::slightly_comfortable</a></div><div class="ttdeci">@ slightly_comfortable</div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a8614d6647ae110ba51944af26b80ecb7a2d02b60eaa3c25912ee2e3ba0b669068"><div class="ttname"><a href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a2d02b60eaa3c25912ee2e3ba0b669068">character_funcs::comfort_level::very_comfortable</a></div><div class="ttdeci">@ very_comfortable</div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a8614d6647ae110ba51944af26b80ecb7a5da248ea6840aca1ae2b417b17982a89"><div class="ttname"><a href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a5da248ea6840aca1ae2b417b17982a89">character_funcs::comfort_level::neutral</a></div><div class="ttdeci">@ neutral</div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a8614d6647ae110ba51944af26b80ecb7a79a2520f22b9e1526ff93176029603b8"><div class="ttname"><a href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a79a2520f22b9e1526ff93176029603b8">character_funcs::comfort_level::impossible</a></div><div class="ttdeci">@ impossible</div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a8614d6647ae110ba51944af26b80ecb7ac19a5c3628d86633a40e23c78d4ff67d"><div class="ttname"><a href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7ac19a5c3628d86633a40e23c78d4ff67d">character_funcs::comfort_level::uncomfortable</a></div><div class="ttdeci">@ uncomfortable</div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a8614d6647ae110ba51944af26b80ecb7aff52b9c1eee2349b5099deb92b8307ed"><div class="ttname"><a href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7aff52b9c1eee2349b5099deb92b8307ed">character_funcs::comfort_level::comfortable</a></div><div class="ttdeci">@ comfortable</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a95d2e2c3c197301f7e9c3e4608e912eb" name="a95d2e2c3c197301f7e9c3e4608e912eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95d2e2c3c197301f7e9c3e4608e912eb">&#9670;&nbsp;</a></span>add_pain_msg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::add_pain_msg </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980">body_part</a>&#160;</td>
          <td class="paramname"><em>bp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add message describing how character feels pain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> that feels the pain </td></tr>
    <tr><td class="paramname">val</td><td>Amount of pain </td></tr>
    <tr><td class="paramname">bp</td><td>Target body part, use num_bp if no specific body part. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00449">449</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>{</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#af20cb84a6e8ccc0ed66c352edf29143b">trait_NOPAIN</a> ) ) {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    }</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <span class="keywordflow">if</span>( bp == <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ac09d37dac773806a42c13041ba254700">num_bp</a> ) {</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>        <span class="keywordflow">if</span>( val &gt; 20 ) {</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your body is wracked with excruciating pain!&quot;</span> ) );</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( val &gt; 10 ) {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your body is wracked with terrible pain!&quot;</span> ) );</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( val &gt; 5 ) {</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your body is wracked with pain!&quot;</span> ) );</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( val &gt; 1 ) {</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your body pains you!&quot;</span> ) );</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your body aches.&quot;</span> ) );</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        <span class="keywordflow">if</span>( val &gt; 20 ) {</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your %s is wracked with excruciating pain!&quot;</span> ),</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>                                   <a class="code hl_function" href="bodypart_8cpp.html#ab29c0bad9828b787ace4d04a5e951c6b">body_part_name_accusative</a>( bp ) );</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( val &gt; 10 ) {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your %s is wracked with terrible pain!&quot;</span> ),</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>                                   <a class="code hl_function" href="bodypart_8cpp.html#ab29c0bad9828b787ace4d04a5e951c6b">body_part_name_accusative</a>( bp ) );</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( val &gt; 5 ) {</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your %s is wracked with pain!&quot;</span> ),</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>                                   <a class="code hl_function" href="bodypart_8cpp.html#ab29c0bad9828b787ace4d04a5e951c6b">body_part_name_accusative</a>( bp ) );</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( val &gt; 1 ) {</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your %s pains you!&quot;</span> ),</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>                                   <a class="code hl_function" href="bodypart_8cpp.html#ab29c0bad9828b787ace4d04a5e951c6b">body_part_name_accusative</a>( bp ) );</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your %s aches.&quot;</span> ),</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>                                   <a class="code hl_function" href="bodypart_8cpp.html#ab29c0bad9828b787ace4d04a5e951c6b">body_part_name_accusative</a>( bp ) );</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>        }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    }</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>}</div>
<div class="ttc" id="abodypart_8cpp_html_ab29c0bad9828b787ace4d04a5e951c6b"><div class="ttname"><a href="bodypart_8cpp.html#ab29c0bad9828b787ace4d04a5e951c6b">body_part_name_accusative</a></div><div class="ttdeci">std::string body_part_name_accusative(body_part bp, int number)</div><div class="ttdoc">Returns the matching accusative name of the body_part token, i.e.</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8cpp_source.html#l00329">bodypart.cpp:329</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980ac09d37dac773806a42c13041ba254700"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ac09d37dac773806a42c13041ba254700">num_bp</a></div><div class="ttdeci">@ num_bp</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00053">bodypart.h:52</a></div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_af20cb84a6e8ccc0ed66c352edf29143b"><div class="ttname"><a href="character__functions_8cpp.html#af20cb84a6e8ccc0ed66c352edf29143b">trait_NOPAIN</a></div><div class="ttdeci">static const trait_id trait_NOPAIN(&quot;NOPAIN&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_af06dd97724f4f05df782e7a4b4f9cfe1"><div class="ttname"><a href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">Character::has_trait</a></div><div class="ttdeci">bool has_trait(const trait_id &amp;b) const override</div><div class="ttdoc">Returns true if the player has the entered trait.</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8cpp_source.html#l00101">mutation.cpp:101</a></div></div>
<div class="ttc" id="aclassCreature_html_a91dc4715c36eef7d116f944be9a4d435"><div class="ttname"><a href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">Creature::add_msg_if_player</a></div><div class="ttdeci">virtual void add_msg_if_player(const std::string &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00597">creature.h:597</a></div></div>
<div class="ttc" id="atranslations_8h_html_aa829053017e23ef22d44dccecba63a34"><div class="ttname"><a href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a></div><div class="ttdeci">#define _(msg)</div><div class="ttdef"><b>Definition:</b> <a href="translations_8h_source.html#l00116">translations.h:116</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="creature_8h_source.html#l00597">Creature::add_msg_if_player()</a>, <a class="el" href="bodypart_8cpp_source.html#l00329">body_part_name_accusative()</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="bodypart_8h_source.html#l00052">num_bp</a>, and <a class="el" href="character__functions_8cpp.html#af20cb84a6e8ccc0ed66c352edf29143b">trait_NOPAIN</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__turn_8cpp_source.html#l00321">Character::process_one_effect()</a>.</p>

</div>
</div>
<a id="a97bfa1444b6ed6f142910821e84fe313" name="a97bfa1444b6ed6f142910821e84fe313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97bfa1444b6ed6f142910821e84fe313">&#9670;&nbsp;</a></span>ammo_count_for()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int character_funcs::ammo_count_for </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>gun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Counts ammo and UPS charges (lower of) for a given gun on the character. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l01180">1180</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>{</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = <a class="code hl_variable" href="classitem.html#a109dfb20d6dac296bab6c44db0f8ab1a">item::INFINITE_CHARGES</a>;</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>    <span class="keywordflow">if</span>( !gun.<a class="code hl_function" href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">is_gun</a>() ) {</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>    }</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span> </div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>    <span class="keywordtype">int</span> required = gun.<a class="code hl_function" href="classitem.html#a7dc5d9ccf5638ae80cebe1864050fa26">ammo_required</a>();</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span> </div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>    <span class="keywordflow">if</span>( required &gt; 0 ) {</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>        <span class="keywordtype">int</span> total_ammo = 0;</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>        total_ammo += gun.<a class="code hl_function" href="classitem.html#a26c025fd4909bd31c8e91ed87905507b">ammo_remaining</a>();</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span> </div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>        <span class="keywordtype">bool</span> has_mag = gun.<a class="code hl_function" href="classitem.html#aa7e9319c5779e2e1c550158ee8a2cc98">magazine_integral</a>();</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span> </div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>        <span class="keyword">const</span> <span class="keyword">auto</span> found_ammo = <a class="code hl_function" href="namespacecharacter__funcs.html#af0d4f519cd76c1891183b3c557bdf007">find_ammo_items_or_mags</a>( who, gun, <span class="keyword">true</span>, -1 );</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>        <span class="keywordtype">int</span> loose_ammo = 0;</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;ammo : found_ammo ) {</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>            <span class="keywordflow">if</span>( ammo-&gt;is_magazine() ) {</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>                has_mag = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>                total_ammo += ammo-&gt;ammo_remaining();</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ammo-&gt;is_ammo() ) {</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>                loose_ammo += ammo-&gt;charges;</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>            }</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>        }</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span> </div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>        <span class="keywordflow">if</span>( has_mag ) {</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>            total_ammo += loose_ammo;</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>        }</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span> </div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>        <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = std::min( <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>, total_ammo / required );</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    }</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span> </div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>    <span class="keywordtype">int</span> ups_drain = gun.<a class="code hl_function" href="classitem.html#af6bd135500675d45eb9b79b196d9558e">get_gun_ups_drain</a>();</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    <span class="keywordflow">if</span>( ups_drain &gt; 0 ) {</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>        <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = std::min( <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>, who.<a class="code hl_function" href="classvisitable.html#a517e20b6f6c13b8316d5cce8e310b871">charges_of</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a55a80a9bbab1925d5462d46d355c2b6e">itype_UPS</a> ) / ups_drain );</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>    }</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span> </div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>}</div>
<div class="ttc" id="acharacter__functions_8cpp_html_a55a80a9bbab1925d5462d46d355c2b6e"><div class="ttname"><a href="character__functions_8cpp.html#a55a80a9bbab1925d5462d46d355c2b6e">itype_UPS</a></div><div class="ttdeci">static const itype_id itype_UPS(&quot;UPS&quot;)</div></div>
<div class="ttc" id="aclassitem_html_a109dfb20d6dac296bab6c44db0f8ab1a"><div class="ttname"><a href="classitem.html#a109dfb20d6dac296bab6c44db0f8ab1a">item::INFINITE_CHARGES</a></div><div class="ttdeci">static const int INFINITE_CHARGES</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l02155">item.h:2155</a></div></div>
<div class="ttc" id="aclassitem_html_a26c025fd4909bd31c8e91ed87905507b"><div class="ttname"><a href="classitem.html#a26c025fd4909bd31c8e91ed87905507b">item::ammo_remaining</a></div><div class="ttdeci">int ammo_remaining() const</div><div class="ttdoc">Quantity of ammunition currently loaded in tool, gun or auxiliary gunmod.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07382">item.cpp:7382</a></div></div>
<div class="ttc" id="aclassitem_html_a2912b2e15a4eec07a5070fffbbd152e8"><div class="ttname"><a href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">item::is_gun</a></div><div class="ttdeci">bool is_gun() const</div><div class="ttdoc">Can this item be used to perform a ranged attack?</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06517">item.cpp:6517</a></div></div>
<div class="ttc" id="aclassitem_html_a7dc5d9ccf5638ae80cebe1864050fa26"><div class="ttname"><a href="classitem.html#a7dc5d9ccf5638ae80cebe1864050fa26">item::ammo_required</a></div><div class="ttdeci">int ammo_required() const</div><div class="ttdoc">Quantity of ammunition consumed per usage of tool or with each shot of gun.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07452">item.cpp:7452</a></div></div>
<div class="ttc" id="aclassitem_html_aa7e9319c5779e2e1c550158ee8a2cc98"><div class="ttname"><a href="classitem.html#aa7e9319c5779e2e1c550158ee8a2cc98">item::magazine_integral</a></div><div class="ttdeci">bool magazine_integral() const</div><div class="ttdoc">Does item have an integral magazine (as opposed to allowing detachable magazines)</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07660">item.cpp:7660</a></div></div>
<div class="ttc" id="aclassitem_html_af6bd135500675d45eb9b79b196d9558e"><div class="ttname"><a href="classitem.html#af6bd135500675d45eb9b79b196d9558e">item::get_gun_ups_drain</a></div><div class="ttdeci">int get_gun_ups_drain() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09927">item.cpp:9927</a></div></div>
<div class="ttc" id="aclassvisitable_html_a517e20b6f6c13b8316d5cce8e310b871"><div class="ttname"><a href="classvisitable.html#a517e20b6f6c13b8316d5cce8e310b871">visitable::charges_of</a></div><div class="ttdeci">int charges_of(const itype_id &amp;what, int limit=INT_MAX, const std::function&lt; bool(const item &amp;)&gt; &amp;filter=return_true&lt; item &gt;, std::function&lt; void(int)&gt; visitor=nullptr) const</div><div class="ttdoc">Count maximum available charges from this instance and any contained items.</div><div class="ttdef"><b>Definition:</b> <a href="visitable_8cpp_source.html#l00943">visitable.cpp:943</a></div></div>
<div class="ttc" id="anamespacecata_1_1hash64__detail_html_a5ca825db6fd06946302c60daa97333e4"><div class="ttname"><a href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">cata::hash64_detail::ret</a></div><div class="ttdeci">T ret</div><div class="ttdef"><b>Definition:</b> <a href="hash__utils_8h_source.html#l00097">hash_utils.h:97</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_af0d4f519cd76c1891183b3c557bdf007"><div class="ttname"><a href="namespacecharacter__funcs.html#af0d4f519cd76c1891183b3c557bdf007">character_funcs::find_ammo_items_or_mags</a></div><div class="ttdeci">std::vector&lt; item_location &gt; find_ammo_items_or_mags(const Character &amp;who, const item &amp;obj, bool empty, int radius)</div><div class="ttdoc">Searches for ammo or magazines that can be used to reload given item.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l01135">character_functions.cpp:1135</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="item_8cpp_source.html#l07382">item::ammo_remaining()</a>, <a class="el" href="item_8cpp_source.html#l07452">item::ammo_required()</a>, <a class="el" href="item_8h_source.html#l02196">item::charges</a>, <a class="el" href="visitable_8cpp_source.html#l00943">visitable&lt; T &gt;::charges_of()</a>, <a class="el" href="character__functions_8cpp_source.html#l01135">find_ammo_items_or_mags()</a>, <a class="el" href="item_8cpp_source.html#l09927">item::get_gun_ups_drain()</a>, <a class="el" href="item_8h_source.html#l02155">item::INFINITE_CHARGES</a>, <a class="el" href="item_8cpp_source.html#l06582">item::is_ammo()</a>, <a class="el" href="item_8cpp_source.html#l06517">item::is_gun()</a>, <a class="el" href="item_8cpp_source.html#l06557">item::is_magazine()</a>, <a class="el" href="character__functions_8cpp.html#a55a80a9bbab1925d5462d46d355c2b6e">itype_UPS</a>, <a class="el" href="item_8cpp_source.html#l07660">item::magazine_integral()</a>, and <a class="el" href="hash__utils_8h_source.html#l00097">cata::hash64_detail::ret</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctalk_8cpp_source.html#l03339">give_item_to()</a>.</p>

</div>
</div>
<a id="a1686a89929a324a03d1396cac6ab1a24" name="a1686a89929a324a03d1396cac6ab1a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1686a89929a324a03d1396cac6ab1a24">&#9670;&nbsp;</a></span>base_comfort_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcharacter__funcs_1_1comfort__response__t.html">comfort_response_t</a> character_funcs::base_comfort_value </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtripoint.html">tripoint</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rate point's ability to serve as a bed. </p>
<p >Only takes certain mutations into account, and not fatigue nor stimulants. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00182">182</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>{</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="comment">// Comfort of sleeping spots is &quot;objective&quot;, while sleep_spot( p ) is &quot;subjective&quot;</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="comment">// As in the latter also checks for fatigue and other variables while this function</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="comment">// only looks at the base comfyness of something. It&#39;s still subjective, in a sense,</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="comment">// as arachnids who sleep in webs will find most places comfortable for instance.</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordtype">int</span> comfort = 0;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <a class="code hl_struct" href="structcharacter__funcs_1_1comfort__response__t.html">comfort_response_t</a> comfort_response;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <span class="keywordtype">bool</span> plantsleep = who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#aba25188f1c6479109ff8fb4004f03ebb">trait_CHLOROMORPH</a> );</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="keywordtype">bool</span> fungaloid_cosplay = who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a039c3379527621f928cbc2e62686108c">trait_M_SKIN3</a> );</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keywordtype">bool</span> websleep = who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a0e02f772574a897b72bd8fc3c48e7f3d">trait_WEB_WALKER</a> );</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="keywordtype">bool</span> webforce = who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#af9f531764978ce897647a8b151bebfef">trait_THRESH_SPIDER</a> ) &amp;&amp; ( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a81b633e679725d3a23cfed0548dd0a17">trait_WEB_SPINNER</a> ) ||</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                    ( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a6d71b37c506e3143c525c4021a580366">trait_WEB_WEAVER</a> ) ) );</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    <span class="keywordtype">bool</span> in_shell = who.<a class="code hl_function" href="classCharacter.html#a225de862f8875f9ff96ec8a303213404">has_active_mutation</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a930a7d3aa631d14eb81c3f2fa9a6863e">trait_SHELL2</a> );</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="keywordtype">bool</span> watersleep = who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#abf29a0f9f2b03dbf9baa8dd6af688d41">trait_WATERSLEEP</a> );</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <a class="code hl_class" href="classmap.html">map</a> &amp;here = <a class="code hl_function" href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a>();</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <span class="keyword">const</span> <a class="code hl_class" href="classoptional__vpart__position.html">optional_vpart_position</a> vp = here.<a class="code hl_function" href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">veh_at</a>( p );</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structmaptile.html">maptile</a> tile = here.<a class="code hl_function" href="classmap.html#a267286ed64b9685c23cf335b2bd225bb">maptile_at</a>( p );</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structtrap.html">trap</a> &amp;trap_at_pos = tile.<a class="code hl_function" href="structmaptile.html#ac97edb7a058025aff0f7921d88b92e3a">get_trap_t</a>();</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <span class="keyword">const</span> <a class="code hl_class" href="classint__id.html">ter_id</a> ter_at_pos = tile.<a class="code hl_function" href="structmaptile.html#a9ea19f651f4ce0a70d044fac9caf6f90">get_ter</a>();</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keyword">const</span> <a class="code hl_class" href="classint__id.html">furn_id</a> furn_at_pos = tile.<a class="code hl_function" href="structmaptile.html#a5c9e3d51ccd6ac8307ed526a0a3c48fb">get_furn</a>();</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <span class="keywordtype">int</span> web = here.<a class="code hl_function" href="classmap.html#a34f983a946812fa51de439bd68f6dc09">get_field_intensity</a>( p, <a class="code hl_variable" href="field__type_8cpp.html#afca1ca43633c0fc76d866752559218d4">fd_web</a> );</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <span class="comment">// Some mutants have different comfort needs</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <span class="keywordflow">if</span>( !plantsleep &amp;&amp; !webforce ) {</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        <span class="keywordflow">if</span>( in_shell ) {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            comfort += 1 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::slightly_comfortable );</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            <span class="comment">// Note: shelled individuals can still use sleeping aids!</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( vp ) {</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            <span class="keyword">const</span> <a class="code hl_class" href="classcata_1_1optional.html">cata::optional&lt;vpart_reference&gt;</a> carg = vp.<a class="code hl_function" href="classoptional__vpart__position.html#a2f0829fa83c2c4d3007e26b91af11856">part_with_feature</a>( <span class="stringliteral">&quot;CARGO&quot;</span>, <span class="keyword">false</span> );</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>            <span class="keyword">const</span> <a class="code hl_class" href="classcata_1_1optional.html">cata::optional&lt;vpart_reference&gt;</a> <a class="code hl_function" href="namespacetrapfunc.html#ae7a0f58d463e414463d41d908e7b87ea">board</a> = vp.<a class="code hl_function" href="classoptional__vpart__position.html#a2f0829fa83c2c4d3007e26b91af11856">part_with_feature</a>( <span class="stringliteral">&quot;BOARDABLE&quot;</span>, <span class="keyword">true</span> );</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            <span class="keywordflow">if</span>( carg ) {</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                <span class="keyword">const</span> <a class="code hl_class" href="classvehicle__stack.html">vehicle_stack</a> items = vp-&gt;vehicle().get_items( carg-&gt;part_index() );</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> &amp;items_it : items ) {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>                    <span class="keywordflow">if</span>( items_it.has_flag( <span class="stringliteral">&quot;SLEEP_AID&quot;</span> ) ) {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>                        <span class="comment">// Note: BED + SLEEP_AID = 9 pts, or 1 pt below very_comfortable</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>                        comfort += 1 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::slightly_comfortable );</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>                        comfort_response.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#a884dc3843bf221f63b408da4d979cf23">aid</a> = &amp;items_it;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>                        <span class="keywordflow">break</span>; <span class="comment">// prevents using more than 1 sleep aid</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                    }</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                }</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            }</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            <span class="keywordflow">if</span>( <a class="code hl_function" href="namespacetrapfunc.html#ae7a0f58d463e414463d41d908e7b87ea">board</a> ) {</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                comfort += <a class="code hl_function" href="namespacetrapfunc.html#ae7a0f58d463e414463d41d908e7b87ea">board</a>-&gt;info().comfort;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>                comfort -= here.<a class="code hl_function" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( p );</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>            }</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        }</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>        <span class="comment">// Not in a vehicle, start checking furniture/terrain/traps at this point in decreasing order</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( furn_at_pos != <a class="code hl_variable" href="mapdata_8cpp.html#a98423a935af4b918d68f206e63f6cf7f">f_null</a> ) {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>            comfort += 0 + furn_at_pos.<a class="code hl_function" href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">obj</a>().<a class="code hl_variable" href="structfurn__t.html#af40d2527bd923a4829e7077904c53e69">comfort</a>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>        }</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        <span class="comment">// Web sleepers can use their webs if better furniture isn&#39;t available</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( websleep &amp;&amp; web &gt;= 3 ) {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>            comfort += 1 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::slightly_comfortable );</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#a2c6e2bf4cee22b3ff74d7e69a18795af">t_improvised_shelter</a> ) {</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            comfort += 0 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::slightly_comfortable );</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#aa4d82f7bb5458062f399e93bc5c3b275">t_floor</a> || ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#a11826be697fa3ff211d8884a4f558a2e">t_floor_waxed</a> ||</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>                   ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#adbcea8876c02c9f2100b1c2acf437432">t_carpet_red</a> || ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#a90d36c50a0c5ef5e41c897606548d34f">t_carpet_yellow</a> ||</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>                   ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#abc0c2be123f082ee974a6b4163ce76d3">t_carpet_green</a> || ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#a8822ab192d044d0d96828f6f3414a48b">t_carpet_purple</a> ) {</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>            comfort += 1 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::neutral );</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !trap_at_pos.<a class="code hl_function" href="structtrap.html#a6a9ac96c5c81eb31093e049ffeac8b4f">is_null</a>() ) {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>            comfort += 0 + trap_at_pos.<a class="code hl_variable" href="structtrap.html#a9e32dc8e92c961fb52b3086421c62b8e">comfort</a>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>            <span class="comment">// Not a comfortable sleeping spot</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>            comfort -= here.<a class="code hl_function" href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">move_cost</a>( p );</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        }</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>        <span class="keywordflow">if</span>( comfort_response.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#a884dc3843bf221f63b408da4d979cf23">aid</a> == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            <span class="keyword">const</span> <a class="code hl_class" href="classmap__stack.html">map_stack</a> items = here.<a class="code hl_function" href="classmap.html#a5130a127601b67e569eaef37a1a88610">i_at</a>( p );</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> &amp;items_it : items ) {</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>                <span class="keywordflow">if</span>( items_it.has_flag( <span class="stringliteral">&quot;SLEEP_AID&quot;</span> ) ) {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>                    <span class="comment">// Note: BED + SLEEP_AID = 9 pts, or 1 pt below very_comfortable</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>                    comfort += 1 + <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::slightly_comfortable );</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>                    comfort_response.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#a884dc3843bf221f63b408da4d979cf23">aid</a> = &amp;items_it;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>                    <span class="keywordflow">break</span>; <span class="comment">// prevents using more than 1 sleep aid</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>                }</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>            }</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        }</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        <span class="keywordflow">if</span>( fungaloid_cosplay &amp;&amp; here.<a class="code hl_function" href="classmap.html#a516c0764134cc86b57297811520395f7">has_flag_ter_or_furn</a>( <a class="code hl_function" href="character__functions_8cpp.html#ae002e878ae18d5606ca01aeaa659a44c">flag_FUNGUS</a>, p ) ) {</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>            comfort += <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::very_comfortable );</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( watersleep &amp;&amp; here.<a class="code hl_function" href="classmap.html#af0e872a5d0a7bf1e9745aeb18d3b5e44">has_flag_ter</a>( <a class="code hl_function" href="character__functions_8cpp.html#abe2fc5a03319b12f5fec303eb13687bb">flag_SWIMMABLE</a>, p ) ) {</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>            comfort += <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::very_comfortable );</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        }</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( plantsleep ) {</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>        <span class="keywordflow">if</span>( vp || furn_at_pos != <a class="code hl_variable" href="mapdata_8cpp.html#a98423a935af4b918d68f206e63f6cf7f">f_null</a> ) {</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            <span class="comment">// Sleep ain&#39;t happening in a vehicle or on furniture</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>            comfort = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::impossible );</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            <span class="comment">// It&#39;s very easy for Chloromorphs to get to sleep on soil!</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>            <span class="keywordflow">if</span>( ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#aa4573ce2c594834a8ced806a5099f3e3">t_dirt</a> || ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#ae6822029506d9cb25c5077dfec866b86">t_pit</a> || ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#af636f3d89f77cfd0ebb47c3d4ecac0c1">t_dirtmound</a> ||</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>                ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#acde4690b771efe403c3c6b972e839df7">t_pit_shallow</a> ) {</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>                comfort += <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::very_comfortable );</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>            }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>            <span class="comment">// Not as much if you have to dig through stuff first</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ter_at_pos == <a class="code hl_variable" href="mapdata_8cpp.html#a32dc54d9fe56e71bbb905cbb67a782eb">t_grass</a> ) {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>                comfort += <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::comfortable );</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>            }</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>            <span class="comment">// Sleep ain&#39;t happening</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>                comfort = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::impossible );</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            }</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        }</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        <span class="comment">// Has webforce</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        <span class="keywordflow">if</span>( web &gt;= 3 ) {</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            <span class="comment">// Thick Web and you&#39;re good to go</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>            comfort += <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::very_comfortable );</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>            comfort = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::impossible );</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    }</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <span class="keywordflow">if</span>( comfort &gt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::comfortable ) ) {</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>        comfort_response.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#af678f41d1dfcd14b9504c107a946ff14">level</a> = comfort_level::very_comfortable;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( comfort &gt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::slightly_comfortable ) ) {</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        comfort_response.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#af678f41d1dfcd14b9504c107a946ff14">level</a> = comfort_level::comfortable;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( comfort &gt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::neutral ) ) {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        comfort_response.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#af678f41d1dfcd14b9504c107a946ff14">level</a> = comfort_level::slightly_comfortable;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( comfort == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_level::neutral ) ) {</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        comfort_response.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#af678f41d1dfcd14b9504c107a946ff14">level</a> = comfort_level::neutral;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        comfort_response.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#af678f41d1dfcd14b9504c107a946ff14">level</a> = comfort_level::uncomfortable;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    }</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    <span class="keywordflow">return</span> comfort_response;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>}</div>
<div class="ttc" id="acharacter__functions_8cpp_html_a039c3379527621f928cbc2e62686108c"><div class="ttname"><a href="character__functions_8cpp.html#a039c3379527621f928cbc2e62686108c">trait_M_SKIN3</a></div><div class="ttdeci">static const trait_id trait_M_SKIN3(&quot;M_SKIN3&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a0e02f772574a897b72bd8fc3c48e7f3d"><div class="ttname"><a href="character__functions_8cpp.html#a0e02f772574a897b72bd8fc3c48e7f3d">trait_WEB_WALKER</a></div><div class="ttdeci">static const trait_id trait_WEB_WALKER(&quot;WEB_WALKER&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a6d71b37c506e3143c525c4021a580366"><div class="ttname"><a href="character__functions_8cpp.html#a6d71b37c506e3143c525c4021a580366">trait_WEB_WEAVER</a></div><div class="ttdeci">static const trait_id trait_WEB_WEAVER(&quot;WEB_WEAVER&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a81b633e679725d3a23cfed0548dd0a17"><div class="ttname"><a href="character__functions_8cpp.html#a81b633e679725d3a23cfed0548dd0a17">trait_WEB_SPINNER</a></div><div class="ttdeci">static const trait_id trait_WEB_SPINNER(&quot;WEB_SPINNER&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a930a7d3aa631d14eb81c3f2fa9a6863e"><div class="ttname"><a href="character__functions_8cpp.html#a930a7d3aa631d14eb81c3f2fa9a6863e">trait_SHELL2</a></div><div class="ttdeci">static const trait_id trait_SHELL2(&quot;SHELL2&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_aba25188f1c6479109ff8fb4004f03ebb"><div class="ttname"><a href="character__functions_8cpp.html#aba25188f1c6479109ff8fb4004f03ebb">trait_CHLOROMORPH</a></div><div class="ttdeci">static const trait_id trait_CHLOROMORPH(&quot;CHLOROMORPH&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_abe2fc5a03319b12f5fec303eb13687bb"><div class="ttname"><a href="character__functions_8cpp.html#abe2fc5a03319b12f5fec303eb13687bb">flag_SWIMMABLE</a></div><div class="ttdeci">static const std::string flag_SWIMMABLE(&quot;SWIMMABLE&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_abf29a0f9f2b03dbf9baa8dd6af688d41"><div class="ttname"><a href="character__functions_8cpp.html#abf29a0f9f2b03dbf9baa8dd6af688d41">trait_WATERSLEEP</a></div><div class="ttdeci">static const trait_id trait_WATERSLEEP(&quot;WATERSLEEP&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_ae002e878ae18d5606ca01aeaa659a44c"><div class="ttname"><a href="character__functions_8cpp.html#ae002e878ae18d5606ca01aeaa659a44c">flag_FUNGUS</a></div><div class="ttdeci">static const std::string flag_FUNGUS(&quot;FUNGUS&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_af9f531764978ce897647a8b151bebfef"><div class="ttname"><a href="character__functions_8cpp.html#af9f531764978ce897647a8b151bebfef">trait_THRESH_SPIDER</a></div><div class="ttdeci">static const trait_id trait_THRESH_SPIDER(&quot;THRESH_SPIDER&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a225de862f8875f9ff96ec8a303213404"><div class="ttname"><a href="classCharacter.html#a225de862f8875f9ff96ec8a303213404">Character::has_active_mutation</a></div><div class="ttdeci">bool has_active_mutation(const trait_id &amp;b) const</div><div class="ttdef"><b>Definition:</b> <a href="mutation_8cpp_source.html#l00365">mutation.cpp:365</a></div></div>
<div class="ttc" id="aclasscata_1_1optional_html"><div class="ttname"><a href="classcata_1_1optional.html">cata::optional</a></div><div class="ttdef"><b>Definition:</b> <a href="optional_8h_source.html#l00030">optional.h:31</a></div></div>
<div class="ttc" id="aclassint__id_html"><div class="ttname"><a href="classint__id.html">int_id&lt; ter_t &gt;</a></div></div>
<div class="ttc" id="aclassint__id_html_a4796245d3cd6e0283670698a98d46ae9"><div class="ttname"><a href="classint__id.html#a4796245d3cd6e0283670698a98d46ae9">int_id::obj</a></div><div class="ttdeci">const T &amp; obj() const</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00026">ammo_effect.cpp:26</a></div></div>
<div class="ttc" id="aclassitem_html"><div class="ttname"><a href="classitem.html">item</a></div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l00210">item.h:211</a></div></div>
<div class="ttc" id="aclassmap__stack_html"><div class="ttname"><a href="classmap__stack.html">map_stack</a></div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00104">map.h:105</a></div></div>
<div class="ttc" id="aclassmap_html"><div class="ttname"><a href="classmap.html">map</a></div><div class="ttdoc">Manage and cache data about a part of the map.</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00383">map.h:384</a></div></div>
<div class="ttc" id="aclassmap_html_a267286ed64b9685c23cf335b2bd225bb"><div class="ttname"><a href="classmap.html#a267286ed64b9685c23cf335b2bd225bb">map::maptile_at</a></div><div class="ttdeci">maptile maptile_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00259">map.cpp:259</a></div></div>
<div class="ttc" id="aclassmap_html_a34f983a946812fa51de439bd68f6dc09"><div class="ttname"><a href="classmap.html#a34f983a946812fa51de439bd68f6dc09">map::get_field_intensity</a></div><div class="ttdeci">int get_field_intensity(const tripoint &amp;p, const field_type_id &amp;type) const</div><div class="ttdoc">Get the intensity of a field entry (field_entry::intensity), if there is no field of that type,...</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l05409">map.cpp:5409</a></div></div>
<div class="ttc" id="aclassmap_html_a5130a127601b67e569eaef37a1a88610"><div class="ttname"><a href="classmap.html#a5130a127601b67e569eaef37a1a88610">map::i_at</a></div><div class="ttdeci">map_stack i_at(const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l04118">map.cpp:4118</a></div></div>
<div class="ttc" id="aclassmap_html_a516c0764134cc86b57297811520395f7"><div class="ttname"><a href="classmap.html#a516c0764134cc86b57297811520395f7">map::has_flag_ter_or_furn</a></div><div class="ttdeci">bool has_flag_ter_or_furn(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02380">map.cpp:2380</a></div></div>
<div class="ttc" id="aclassmap_html_aa487d96256c3d35db7a1bf273156b64a"><div class="ttname"><a href="classmap.html#aa487d96256c3d35db7a1bf273156b64a">map::veh_at</a></div><div class="ttdeci">optional_vpart_position veh_at(const tripoint &amp;p) const</div><div class="ttdoc">Checks if tile is occupied by vehicle and by which part.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01067">map.cpp:1067</a></div></div>
<div class="ttc" id="aclassmap_html_abe9e7b93cf8ee15c370ad55c3138c4f6"><div class="ttname"><a href="classmap.html#abe9e7b93cf8ee15c370ad55c3138c4f6">map::move_cost</a></div><div class="ttdeci">int move_cost(const tripoint &amp;p, const vehicle *ignored_vehicle=nullptr) const</div><div class="ttdoc">Calculate the cost to move past the tile at p.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01838">map.cpp:1838</a></div></div>
<div class="ttc" id="aclassmap_html_af0e872a5d0a7bf1e9745aeb18d3b5e44"><div class="ttname"><a href="classmap.html#af0e872a5d0a7bf1e9745aeb18d3b5e44">map::has_flag_ter</a></div><div class="ttdeci">bool has_flag_ter(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02370">map.cpp:2370</a></div></div>
<div class="ttc" id="aclassoptional__vpart__position_html"><div class="ttname"><a href="classoptional__vpart__position.html">optional_vpart_position</a></div><div class="ttdoc">Simple wrapper to forward functions that may return a cata::optional to vpart_position.</div><div class="ttdef"><b>Definition:</b> <a href="vpart__position_8h_source.html#l00103">vpart_position.h:104</a></div></div>
<div class="ttc" id="aclassoptional__vpart__position_html_a2f0829fa83c2c4d3007e26b91af11856"><div class="ttname"><a href="classoptional__vpart__position.html#a2f0829fa83c2c4d3007e26b91af11856">optional_vpart_position::part_with_feature</a></div><div class="ttdeci">cata::optional&lt; vpart_reference &gt; part_with_feature(const std::string &amp;f, bool unbroken) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l02482">vehicle.cpp:2482</a></div></div>
<div class="ttc" id="aclassvehicle__stack_html"><div class="ttname"><a href="classvehicle__stack.html">vehicle_stack</a></div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00123">vehicle.h:124</a></div></div>
<div class="ttc" id="afield__type_8cpp_html_afca1ca43633c0fc76d866752559218d4"><div class="ttname"><a href="field__type_8cpp.html#afca1ca43633c0fc76d866752559218d4">fd_web</a></div><div class="ttdeci">field_type_id fd_web</div><div class="ttdef"><b>Definition:</b> <a href="field__type_8cpp_source.html#l00340">field_type.cpp:340</a></div></div>
<div class="ttc" id="amap_8cpp_html_acb0b34be6e497bdd2f9f40ae6929d562"><div class="ttname"><a href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a></div><div class="ttdeci">map &amp; get_map()</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00146">map.cpp:146</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_a11826be697fa3ff211d8884a4f558a2e"><div class="ttname"><a href="mapdata_8cpp.html#a11826be697fa3ff211d8884a4f558a2e">t_floor_waxed</a></div><div class="ttdeci">ter_id t_floor_waxed</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00634">mapdata.cpp:634</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_a2c6e2bf4cee22b3ff74d7e69a18795af"><div class="ttname"><a href="mapdata_8cpp.html#a2c6e2bf4cee22b3ff74d7e69a18795af">t_improvised_shelter</a></div><div class="ttdeci">ter_id t_improvised_shelter</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00718">mapdata.cpp:718</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_a32dc54d9fe56e71bbb905cbb67a782eb"><div class="ttname"><a href="mapdata_8cpp.html#a32dc54d9fe56e71bbb905cbb67a782eb">t_grass</a></div><div class="ttdeci">ter_id t_grass</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00630">mapdata.cpp:630</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_a8822ab192d044d0d96828f6f3414a48b"><div class="ttname"><a href="mapdata_8cpp.html#a8822ab192d044d0d96828f6f3414a48b">t_carpet_purple</a></div><div class="ttdeci">ter_id t_carpet_purple</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00636">mapdata.cpp:636</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_a90d36c50a0c5ef5e41c897606548d34f"><div class="ttname"><a href="mapdata_8cpp.html#a90d36c50a0c5ef5e41c897606548d34f">t_carpet_yellow</a></div><div class="ttdeci">ter_id t_carpet_yellow</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00636">mapdata.cpp:636</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_a98423a935af4b918d68f206e63f6cf7f"><div class="ttname"><a href="mapdata_8cpp.html#a98423a935af4b918d68f206e63f6cf7f">f_null</a></div><div class="ttdeci">furn_id f_null</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l01097">mapdata.cpp:1097</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_aa4573ce2c594834a8ced806a5099f3e3"><div class="ttname"><a href="mapdata_8cpp.html#aa4573ce2c594834a8ced806a5099f3e3">t_dirt</a></div><div class="ttdeci">ter_id t_dirt</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00627">mapdata.cpp:627</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_aa4d82f7bb5458062f399e93bc5c3b275"><div class="ttname"><a href="mapdata_8cpp.html#aa4d82f7bb5458062f399e93bc5c3b275">t_floor</a></div><div class="ttdeci">ter_id t_floor</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00634">mapdata.cpp:634</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_abc0c2be123f082ee974a6b4163ce76d3"><div class="ttname"><a href="mapdata_8cpp.html#abc0c2be123f082ee974a6b4163ce76d3">t_carpet_green</a></div><div class="ttdeci">ter_id t_carpet_green</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00636">mapdata.cpp:636</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_acde4690b771efe403c3c6b972e839df7"><div class="ttname"><a href="mapdata_8cpp.html#acde4690b771efe403c3c6b972e839df7">t_pit_shallow</a></div><div class="ttdeci">ter_id t_pit_shallow</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00627">mapdata.cpp:627</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_adbcea8876c02c9f2100b1c2acf437432"><div class="ttname"><a href="mapdata_8cpp.html#adbcea8876c02c9f2100b1c2acf437432">t_carpet_red</a></div><div class="ttdeci">ter_id t_carpet_red</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00636">mapdata.cpp:636</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_ae6822029506d9cb25c5077dfec866b86"><div class="ttname"><a href="mapdata_8cpp.html#ae6822029506d9cb25c5077dfec866b86">t_pit</a></div><div class="ttdeci">ter_id t_pit</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00627">mapdata.cpp:627</a></div></div>
<div class="ttc" id="amapdata_8cpp_html_af636f3d89f77cfd0ebb47c3d4ecac0c1"><div class="ttname"><a href="mapdata_8cpp.html#af636f3d89f77cfd0ebb47c3d4ecac0c1">t_dirtmound</a></div><div class="ttdeci">ter_id t_dirtmound</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8cpp_source.html#l00627">mapdata.cpp:627</a></div></div>
<div class="ttc" id="anamespacetrapfunc_html_ae7a0f58d463e414463d41d908e7b87ea"><div class="ttname"><a href="namespacetrapfunc.html#ae7a0f58d463e414463d41d908e7b87ea">trapfunc::board</a></div><div class="ttdeci">bool board(const tripoint &amp;p, Creature *c, item *i)</div><div class="ttdef"><b>Definition:</b> <a href="trapfunc_8cpp_source.html#l00172">trapfunc.cpp:172</a></div></div>
<div class="ttc" id="astructcharacter__funcs_1_1comfort__response__t_html"><div class="ttname"><a href="structcharacter__funcs_1_1comfort__response__t.html">character_funcs::comfort_response_t</a></div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8h_source.html#l00091">character_functions.h:91</a></div></div>
<div class="ttc" id="astructcharacter__funcs_1_1comfort__response__t_html_a884dc3843bf221f63b408da4d979cf23"><div class="ttname"><a href="structcharacter__funcs_1_1comfort__response__t.html#a884dc3843bf221f63b408da4d979cf23">character_funcs::comfort_response_t::aid</a></div><div class="ttdeci">const item * aid</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8h_source.html#l00093">character_functions.h:93</a></div></div>
<div class="ttc" id="astructcharacter__funcs_1_1comfort__response__t_html_af678f41d1dfcd14b9504c107a946ff14"><div class="ttname"><a href="structcharacter__funcs_1_1comfort__response__t.html#af678f41d1dfcd14b9504c107a946ff14">character_funcs::comfort_response_t::level</a></div><div class="ttdeci">comfort_level level</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8h_source.html#l00092">character_functions.h:92</a></div></div>
<div class="ttc" id="astructfurn__t_html_af40d2527bd923a4829e7077904c53e69"><div class="ttname"><a href="structfurn__t.html#af40d2527bd923a4829e7077904c53e69">furn_t::comfort</a></div><div class="ttdeci">int comfort</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00507">mapdata.h:507</a></div></div>
<div class="ttc" id="astructmaptile_html"><div class="ttname"><a href="structmaptile.html">maptile</a></div><div class="ttdoc">A wrapper for a submap point.</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00238">submap.h:238</a></div></div>
<div class="ttc" id="astructmaptile_html_a5c9e3d51ccd6ac8307ed526a0a3c48fb"><div class="ttname"><a href="structmaptile.html#a5c9e3d51ccd6ac8307ed526a0a3c48fb">maptile::get_furn</a></div><div class="ttdeci">furn_id get_furn() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00256">submap.h:256</a></div></div>
<div class="ttc" id="astructmaptile_html_a9ea19f651f4ce0a70d044fac9caf6f90"><div class="ttname"><a href="structmaptile.html#a9ea19f651f4ce0a70d044fac9caf6f90">maptile::get_ter</a></div><div class="ttdeci">ter_id get_ter() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00260">submap.h:260</a></div></div>
<div class="ttc" id="astructmaptile_html_ac97edb7a058025aff0f7921d88b92e3a"><div class="ttname"><a href="structmaptile.html#ac97edb7a058025aff0f7921d88b92e3a">maptile::get_trap_t</a></div><div class="ttdeci">const trap &amp; get_trap_t() const</div><div class="ttdef"><b>Definition:</b> <a href="submap_8h_source.html#l00264">submap.h:264</a></div></div>
<div class="ttc" id="astructtrap_html"><div class="ttname"><a href="structtrap.html">trap</a></div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00086">trap.h:86</a></div></div>
<div class="ttc" id="astructtrap_html_a6a9ac96c5c81eb31093e049ffeac8b4f"><div class="ttname"><a href="structtrap.html#a6a9ac96c5c81eb31093e049ffeac8b4f">trap::is_null</a></div><div class="ttdeci">bool is_null() const</div><div class="ttdoc">Whether this is the null-traps, aka no trap at all.</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00245">trap.cpp:245</a></div></div>
<div class="ttc" id="astructtrap_html_a9e32dc8e92c961fb52b3086421c62b8e"><div class="ttname"><a href="structtrap.html#a9e32dc8e92c961fb52b3086421c62b8e">trap::comfort</a></div><div class="ttdeci">int comfort</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00119">trap.h:119</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__functions_8h_source.html#l00093">character_funcs::comfort_response_t::aid</a>, <a class="el" href="trapfunc_8cpp_source.html#l00172">trapfunc::board()</a>, <a class="el" href="mapdata_8h_source.html#l00507">furn_t::comfort</a>, <a class="el" href="trap_8h_source.html#l00119">trap::comfort</a>, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7aff52b9c1eee2349b5099deb92b8307ed">comfortable</a>, <a class="el" href="mapdata_8cpp_source.html#l01097">f_null</a>, <a class="el" href="field__type_8cpp_source.html#l00340">fd_web</a>, <a class="el" href="character__functions_8cpp.html#ae002e878ae18d5606ca01aeaa659a44c">flag_FUNGUS()</a>, <a class="el" href="character__functions_8cpp.html#abe2fc5a03319b12f5fec303eb13687bb">flag_SWIMMABLE()</a>, <a class="el" href="map_8cpp_source.html#l05409">map::get_field_intensity()</a>, <a class="el" href="submap_8h_source.html#l00256">maptile::get_furn()</a>, <a class="el" href="map_8cpp_source.html#l00146">get_map()</a>, <a class="el" href="submap_8h_source.html#l00260">maptile::get_ter()</a>, <a class="el" href="submap_8h_source.html#l00264">maptile::get_trap_t()</a>, <a class="el" href="mutation_8cpp_source.html#l00365">Character::has_active_mutation()</a>, <a class="el" href="map_8cpp_source.html#l02370">map::has_flag_ter()</a>, <a class="el" href="map_8cpp_source.html#l02380">map::has_flag_ter_or_furn()</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="map_8cpp_source.html#l04118">map::i_at()</a>, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a79a2520f22b9e1526ff93176029603b8">impossible</a>, <a class="el" href="trap_8cpp_source.html#l00245">trap::is_null()</a>, <a class="el" href="character__functions_8h_source.html#l00092">character_funcs::comfort_response_t::level</a>, <a class="el" href="map_8cpp_source.html#l00259">map::maptile_at()</a>, <a class="el" href="map_8cpp_source.html#l01838">map::move_cost()</a>, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a5da248ea6840aca1ae2b417b17982a89">neutral</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00026">int_id&lt; T &gt;::obj()</a>, <a class="el" href="vehicle_8cpp_source.html#l02482">optional_vpart_position::part_with_feature()</a>, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a1493fbda00a5e67f5f6d8d619489a6af">slightly_comfortable</a>, <a class="el" href="mapdata_8cpp_source.html#l00636">t_carpet_green</a>, <a class="el" href="mapdata_8cpp_source.html#l00636">t_carpet_purple</a>, <a class="el" href="mapdata_8cpp_source.html#l00636">t_carpet_red</a>, <a class="el" href="mapdata_8cpp_source.html#l00636">t_carpet_yellow</a>, <a class="el" href="mapdata_8cpp_source.html#l00627">t_dirt</a>, <a class="el" href="mapdata_8cpp_source.html#l00627">t_dirtmound</a>, <a class="el" href="mapdata_8cpp_source.html#l00634">t_floor</a>, <a class="el" href="mapdata_8cpp_source.html#l00634">t_floor_waxed</a>, <a class="el" href="mapdata_8cpp_source.html#l00630">t_grass</a>, <a class="el" href="mapdata_8cpp_source.html#l00718">t_improvised_shelter</a>, <a class="el" href="mapdata_8cpp_source.html#l00627">t_pit</a>, <a class="el" href="mapdata_8cpp_source.html#l00627">t_pit_shallow</a>, <a class="el" href="character__functions_8cpp.html#aba25188f1c6479109ff8fb4004f03ebb">trait_CHLOROMORPH</a>, <a class="el" href="character__functions_8cpp.html#a039c3379527621f928cbc2e62686108c">trait_M_SKIN3</a>, <a class="el" href="character__functions_8cpp.html#a930a7d3aa631d14eb81c3f2fa9a6863e">trait_SHELL2</a>, <a class="el" href="character__functions_8cpp.html#af9f531764978ce897647a8b151bebfef">trait_THRESH_SPIDER</a>, <a class="el" href="character__functions_8cpp.html#abf29a0f9f2b03dbf9baa8dd6af688d41">trait_WATERSLEEP</a>, <a class="el" href="character__functions_8cpp.html#a81b633e679725d3a23cfed0548dd0a17">trait_WEB_SPINNER</a>, <a class="el" href="character__functions_8cpp.html#a0e02f772574a897b72bd8fc3c48e7f3d">trait_WEB_WALKER</a>, <a class="el" href="character__functions_8cpp.html#a6d71b37c506e3143c525c4021a580366">trait_WEB_WEAVER</a>, <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7ac19a5c3628d86633a40e23c78d4ff67d">uncomfortable</a>, <a class="el" href="map_8cpp_source.html#l01067">map::veh_at()</a>, and <a class="el" href="namespacecharacter__funcs.html#a8614d6647ae110ba51944af26b80ecb7a2d02b60eaa3c25912ee2e3ba0b669068">very_comfortable</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l00313">rate_sleep_spot()</a>, and <a class="el" href="character_8cpp_source.html#l04764">Character::update_needs()</a>.</p>

</div>
</div>
<a id="a0dce7cdd9fb67e45d224f22aea0ff920" name="a0dce7cdd9fb67e45d224f22aea0ff920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dce7cdd9fb67e45d224f22aea0ff920">&#9670;&nbsp;</a></span>can_interface_armor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::can_interface_armor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether character has an active bionic capable of interfacing with power armor. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00401">401</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>{</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    <span class="keywordtype">bool</span> okay = std::any_of( who.<a class="code hl_variable" href="classCharacter.html#a388bca3ef975bd265c67df45bb280bee">my_bionics</a>-&gt;begin(), who.<a class="code hl_variable" href="classCharacter.html#a388bca3ef975bd265c67df45bb280bee">my_bionics</a>-&gt;end(),</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    []( <span class="keyword">const</span> <a class="code hl_struct" href="structbionic.html">bionic</a> &amp; <a class="code hl_variable" href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a> ) {</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>        return b.powered &amp;&amp; b.info().has_flag( STATIC( flag_str_id( <span class="stringliteral">&quot;BIONIC_ARMOR_INTERFACE&quot;</span> ) ) );</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    } );</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    <span class="keywordflow">return</span> okay;</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>}</div>
<div class="ttc" id="aclassCharacter_html_a388bca3ef975bd265c67df45bb280bee"><div class="ttname"><a href="classCharacter.html#a388bca3ef975bd265c67df45bb280bee">Character::my_bionics</a></div><div class="ttdeci">pimpl&lt; bionic_collection &gt; my_bionics</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01549">character.h:1549</a></div></div>
<div class="ttc" id="amagic_8cpp_html_aa93a189fb7bbbf87be54bcc7bd11bb6f"><div class="ttname"><a href="magic_8cpp.html#aa93a189fb7bbbf87be54bcc7bd11bb6f">b</a></div><div class="ttdeci">constexpr double b</div><div class="ttdef"><b>Definition:</b> <a href="magic_8cpp_source.html#l01031">magic.cpp:1031</a></div></div>
<div class="ttc" id="astructbionic_html"><div class="ttname"><a href="structbionic.html">bionic</a></div><div class="ttdef"><b>Definition:</b> <a href="bionics_8h_source.html#l00151">bionics.h:151</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="magic_8cpp_source.html#l01031">b</a>, and <a class="el" href="character_8h_source.html#l01549">Character::my_bionics</a>.</p>

<p class="reference">Referenced by <a class="el" href="character_8cpp_source.html#l07375">Character::consume_charges()</a>, <a class="el" href="character_8cpp_source.html#l07320">Character::has_enough_charges()</a>, <a class="el" href="item_8cpp_source.html#l09461">item::process_tool()</a>, <a class="el" href="item_8cpp_source.html#l07987">item::units_remaining()</a>, <a class="el" href="iuse__actor_8cpp_source.html#l00214">iuse_transform::use()</a>, and <a class="el" href="iuse__actor_8cpp_source.html#l00916">set_transform_iuse::use()</a>.</p>

</div>
</div>
<a id="aa14127fd34677b0e529bb14166513850" name="aa14127fd34677b0e529bb14166513850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa14127fd34677b0e529bb14166513850">&#9670;&nbsp;</a></span>can_lift_with_helpers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::can_lift_with_helpers </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lift_required</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns whether character can lift given value (includes bonus from helpers). </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00701">701</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>{</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecharacter__funcs.html#afc55ada93348dbdeea0b7f69151956f5">get_lift_strength_with_helpers</a>( who ) &gt;= lift_required;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>}</div>
<div class="ttc" id="anamespacecharacter__funcs_html_afc55ada93348dbdeea0b7f69151956f5"><div class="ttname"><a href="namespacecharacter__funcs.html#afc55ada93348dbdeea0b7f69151956f5">character_funcs::get_lift_strength_with_helpers</a></div><div class="ttdeci">int get_lift_strength_with_helpers(const Character &amp;who)</div><div class="ttdoc">Returns Character lift strength without equipment including bonus from nearby helpers.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00691">character_functions.cpp:691</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__functions_8cpp_source.html#l00691">get_lift_strength_with_helpers()</a>.</p>

<p class="reference">Referenced by <a class="el" href="activity__item__handling_8cpp_source.html#l01290">can_do_activity_there()</a>, <a class="el" href="veh__interact_8cpp_source.html#l01761">veh_interact::can_remove_part()</a>, and <a class="el" href="veh__interact_8cpp_source.html#l00708">veh_interact::update_part_requirements()</a>.</p>

</div>
</div>
<a id="a813a9decd34980fe53f38ba18ffd6374" name="a813a9decd34980fe53f38ba18ffd6374"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a813a9decd34980fe53f38ba18ffd6374">&#9670;&nbsp;</a></span>can_see_fine_details() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::can_see_fine_details </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether character vision at given pos is good enough to see fine details. </p>
<p >Fine vision is required for some interactions (reading, crafting, etc.)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> to check for </td></tr>
    <tr><td class="paramname">pos</td><td>Check remote spot as if the character were standing there </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00172">172</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>{</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecharacter__funcs.html#a68c0c236c653e5217f1436bfadd54664">can_see_fine_details</a>( who, who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() );</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>}</div>
<div class="ttc" id="aclassCharacter_html_ad24859164517ed6e392e21df69527199"><div class="ttname"><a href="classCharacter.html#ad24859164517ed6e392e21df69527199">Character::pos</a></div><div class="ttdeci">const tripoint &amp; pos() const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00587">character.cpp:587</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a68c0c236c653e5217f1436bfadd54664"><div class="ttname"><a href="namespacecharacter__funcs.html#a68c0c236c653e5217f1436bfadd54664">character_funcs::can_see_fine_details</a></div><div class="ttdeci">bool can_see_fine_details(const Character &amp;who, const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00177">character_functions.cpp:177</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__functions_8cpp_source.html#l00172">can_see_fine_details()</a>, and <a class="el" href="character_8cpp_source.html#l00587">Character::pos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="game_8cpp_source.html#l08121">butcher_submenu()</a>, <a class="el" href="npc_8cpp_source.html#l00846">npc::can_read()</a>, <a class="el" href="character__functions_8cpp_source.html#l00172">can_see_fine_details()</a>, <a class="el" href="iuse__actor_8cpp_source.html#l03040">repair_item_actor::can_use_tool()</a>, <a class="el" href="veh__interact_8cpp_source.html#l00540">veh_interact::cant_do()</a>, <a class="el" href="activity__item__handling_8cpp_source.html#l02950">generic_multi_activity_handler()</a>, <a class="el" href="activity__item__handling_8cpp_source.html#l02518">generic_multi_activity_locations()</a>, <a class="el" href="avatar_8cpp_source.html#l00255">avatar::get_book_reader()</a>, <a class="el" href="crafting_8cpp_source.html#l00132">lighting_crafting_speed_multiplier()</a>, <a class="el" href="construction_8cpp_source.html#l00944">player_can_see_to_build()</a>, <a class="el" href="activity__handlers_8cpp_source.html#l04813">activity_handlers::study_spell_do_turn()</a>, <a class="el" href="iexamine_8cpp_source.html#l03815">iexamine::trap()</a>, <a class="el" href="iuse__actor_8cpp_source.html#l01348">reveal_map_actor::use()</a>, <a class="el" href="iuse__actor_8cpp_source.html#l04808">sew_advanced_actor::use()</a>, <a class="el" href="iuse__actor_8cpp_source.html#l02483">learn_spell_actor::use()</a>, <a class="el" href="iuse_8cpp_source.html#l09438">iuse::wash_all_items()</a>, <a class="el" href="iuse_8cpp_source.html#l09417">iuse::wash_hard_items()</a>, and <a class="el" href="iuse_8cpp_source.html#l09396">iuse::wash_soft_items()</a>.</p>

</div>
</div>
<a id="a68c0c236c653e5217f1436bfadd54664" name="a68c0c236c653e5217f1436bfadd54664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68c0c236c653e5217f1436bfadd54664">&#9670;&nbsp;</a></span>can_see_fine_details() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::can_see_fine_details </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtripoint.html">tripoint</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00177">177</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>{</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecharacter__funcs.html#a03ea116da570af10c630e0fe3a7ea6fc">fine_detail_vision_mod</a>( who, p ) &lt;= <a class="code hl_variable" href="namespacecharacter__funcs.html#ac767ac632c0c783c8615f5e920cc938e">FINE_VISION_THRESHOLD</a>;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>}</div>
<div class="ttc" id="anamespacecharacter__funcs_html_a03ea116da570af10c630e0fe3a7ea6fc"><div class="ttname"><a href="namespacecharacter__funcs.html#a03ea116da570af10c630e0fe3a7ea6fc">character_funcs::fine_detail_vision_mod</a></div><div class="ttdeci">float fine_detail_vision_mod(const Character &amp;who, const tripoint &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00151">character_functions.cpp:151</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_ac767ac632c0c783c8615f5e920cc938e"><div class="ttname"><a href="namespacecharacter__funcs.html#ac767ac632c0c783c8615f5e920cc938e">character_funcs::FINE_VISION_THRESHOLD</a></div><div class="ttdeci">constexpr float FINE_VISION_THRESHOLD</div><div class="ttdoc">Threshold for fine detail vision mod.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8h_source.html#l00042">character_functions.h:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__functions_8cpp_source.html#l00146">fine_detail_vision_mod()</a>, and <a class="el" href="character__functions_8h_source.html#l00042">FINE_VISION_THRESHOLD</a>.</p>

</div>
</div>
<a id="a8b6391933c53c0461e4e64fa9930d472" name="a8b6391933c53c0461e4e64fa9930d472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b6391933c53c0461e4e64fa9930d472">&#9670;&nbsp;</a></span>do_pause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::do_pause </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do pause action ('. </p>
<p >' key). </p>

<p class="definition">Definition at line <a class="el" href="character__turn_8cpp_source.html#l00962">962</a> of file <a class="el" href="character__turn_8cpp_source.html">character_turn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>{</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>    <a class="code hl_class" href="classmap.html">map</a> &amp;here = <a class="code hl_function" href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a>();</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span> </div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    who.<a class="code hl_variable" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> = 0;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>    who.<a class="code hl_variable" href="classCharacter.html#a057d68671b298012a18f4e289b39935d">recoil</a> = <a class="code hl_variable" href="game__constants_8h.html#a8226e8a134603e5bc06df05efd13d8d1">MAX_RECOIL</a>;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span> </div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    <span class="comment">// Train swimming if underwater</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>    <span class="keywordflow">if</span>( !who.<a class="code hl_variable" href="classCharacter.html#a61bc9422c35b63128532af268e52cb71">in_vehicle</a> ) {</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCreature.html#a5a2346f549de9c87e8f2afeec1e71366">is_underwater</a>() ) {</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>            who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>()-&gt;<a class="code hl_function" href="classCharacter.html#a3d70ebd707bada8879208e98f07f7223">practice</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a1d815a8053cfecc8a05374bf92924ba2">skill_swimming</a>, 1 );</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>            who.<a class="code hl_function" href="classCharacter.html#a44dbe53874421147bfc4491d8753cccc">drench</a>( 100, { {</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>                    <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a44506e97ae9648354f97d530a3be61b8">bp_leg_l</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a202ad82497ebf8867cdcd6ee15085d16">bp_leg_r</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ab4b216482dcc0e468819f023c3aeddd1">bp_torso</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a441080ba1d3930d38f635658d9b28e01">bp_arm_l</a>,</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>                    <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ae5f21c7494ad730a0c6abf6957976cb3">bp_arm_r</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ab1635a97e6cc33a051cd378b60e48698">bp_head</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a2055386ee220ee2ca3e61d13df65e868">bp_eyes</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980abb7b120eb8dc7c137110446fe541baed">bp_mouth</a>,</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>                    <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a184f1b627fd11fb607e76b2d30dadfbb">bp_foot_l</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ac094b1c6f96ebbd604928cfd2fad0ab7">bp_foot_r</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a2806629e65a2c2eb5d8049e29e77910e">bp_hand_l</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a54721306a0e05318b6d0440349c1a0fb">bp_hand_r</a></div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>                }</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>            }, true );</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( here.<a class="code hl_function" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <a class="code hl_enumvalue" href="mapdata_8h.html#aa04d037303ea30193f7cf0cd82304258aeb9fcbd752ad2c632ccc4383c5641b69">TFLAG_DEEP_WATER</a>, who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() ) ) {</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>            who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>()-&gt;<a class="code hl_function" href="classCharacter.html#a3d70ebd707bada8879208e98f07f7223">practice</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a1d815a8053cfecc8a05374bf92924ba2">skill_swimming</a>, 1 );</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>            <span class="comment">// Same as above, except no head/eyes/mouth</span></div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>            who.<a class="code hl_function" href="classCharacter.html#a44dbe53874421147bfc4491d8753cccc">drench</a>( 100, { {</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>                    <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a44506e97ae9648354f97d530a3be61b8">bp_leg_l</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a202ad82497ebf8867cdcd6ee15085d16">bp_leg_r</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ab4b216482dcc0e468819f023c3aeddd1">bp_torso</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a441080ba1d3930d38f635658d9b28e01">bp_arm_l</a>,</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>                    <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ae5f21c7494ad730a0c6abf6957976cb3">bp_arm_r</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a184f1b627fd11fb607e76b2d30dadfbb">bp_foot_l</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ac094b1c6f96ebbd604928cfd2fad0ab7">bp_foot_r</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a2806629e65a2c2eb5d8049e29e77910e">bp_hand_l</a>,</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>                    <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a54721306a0e05318b6d0440349c1a0fb">bp_hand_r</a></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>                }</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>            }, true );</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( here.<a class="code hl_function" href="classmap.html#a27e22f0999ea03eff18babc48643c568">has_flag</a>( <span class="stringliteral">&quot;SWIMMABLE&quot;</span>, who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() ) ) {</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>            who.<a class="code hl_function" href="classCharacter.html#a44dbe53874421147bfc4491d8753cccc">drench</a>( 40, { { <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a184f1b627fd11fb607e76b2d30dadfbb">bp_foot_l</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ac094b1c6f96ebbd604928cfd2fad0ab7">bp_foot_r</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a44506e97ae9648354f97d530a3be61b8">bp_leg_l</a>, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a202ad82497ebf8867cdcd6ee15085d16">bp_leg_r</a> } }, false );</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>        }</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    }</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span> </div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    <span class="comment">// Try to put out clothing/hair fire</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCreature.html#a6fb79df9315dc2bed6f34d9a2e37da90">has_effect</a>( <a class="code hl_variable" href="character__turn_8cpp.html#afcfa82c36c0dc2d76cd19d622c2b6ab4">effect_onfire</a> ) ) {</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>        <a class="code hl_class" href="classtime__duration.html">time_duration</a> total_removed = 0_turns;</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>        <a class="code hl_class" href="classtime__duration.html">time_duration</a> total_left = 0_turns;</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>        <span class="keywordtype">bool</span> on_ground = who.<a class="code hl_function" href="classCreature.html#a6fb79df9315dc2bed6f34d9a2e37da90">has_effect</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a08481f62adb6937636ea44b855311037">effect_downed</a> );</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_enumeration" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980">body_part</a> bp : <a class="code hl_variable" href="bodypart_8h.html#a089a199d69623f528a3883672f0a084e">all_body_parts</a> ) {</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>            <a class="code hl_class" href="classeffect.html">effect</a> &amp;eff = who.<a class="code hl_function" href="classCreature.html#a89f56544cdbf34297b4c0e62f3350817">get_effect</a>( <a class="code hl_variable" href="character__turn_8cpp.html#afcfa82c36c0dc2d76cd19d622c2b6ab4">effect_onfire</a>, bp );</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>            <span class="keywordflow">if</span>( eff.<a class="code hl_function" href="classeffect.html#a39ebd2ec5b2faacde7483e0c07240baa">is_null</a>() ) {</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>            }</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span> </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>            <span class="comment">// TODO: Tools and skills</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>            total_left += eff.<a class="code hl_function" href="classeffect.html#a34c766f51dc0f89ebdab09c344bb506b">get_duration</a>();</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>            <span class="comment">// Being on the ground will smother the fire much faster because you can roll</span></div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>            <span class="keyword">const</span> <a class="code hl_class" href="classtime__duration.html">time_duration</a> dur_removed = on_ground ? eff.<a class="code hl_function" href="classeffect.html#a34c766f51dc0f89ebdab09c344bb506b">get_duration</a>() / 2 + 2_turns : 5_turns;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>            eff.<a class="code hl_function" href="classeffect.html#a118dd88810785bfbb8243af97a37d2ab">mod_duration</a>( -dur_removed );</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>            total_removed += dur_removed;</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>        }</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span> </div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>        <span class="comment">// Don&#39;t drop on the ground when the ground is on fire</span></div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>        <span class="keywordflow">if</span>( total_left &gt; 3_turns &amp;&amp; !who.<a class="code hl_function" href="classCreature.html#a6a4c43d66f5a8b50a879d78682b00976">is_dangerous_fields</a>( here.<a class="code hl_function" href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">field_at</a>( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() ) ) ) {</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>            who.<a class="code hl_function" href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">add_effect</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a08481f62adb6937636ea44b855311037">effect_downed</a>, 2_turns, <a class="code hl_enumvalue" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ac09d37dac773806a42c13041ba254700">num_bp</a>, 0, <span class="keyword">true</span> );</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>            who.<a class="code hl_function" href="classCreature.html#a7cf71d2bd6c350f2ceda3f1d64046e63">add_msg_player_or_npc</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a>,</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>                                       <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;You roll on the ground, trying to smother the fire!&quot;</span> ),</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>                                       <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;&lt;npcname&gt; rolls on the ground!&quot;</span> ) );</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( total_removed &gt; 0_turns ) {</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>            who.<a class="code hl_function" href="classCreature.html#a7cf71d2bd6c350f2ceda3f1d64046e63">add_msg_player_or_npc</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a>,</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>                                       <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;You attempt to put out the fire on you!&quot;</span> ),</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>                                       <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;&lt;npcname&gt; attempts to put out the fire on them!&quot;</span> ) );</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>        }</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    }</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span> </div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <span class="comment">// on-pause effects for martial arts</span></div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>    who.<a class="code hl_variable" href="classCharacter.html#a313797e99525bfd2a5ead68b7672f168">martial_arts_data</a>-&gt;ma_onpause_effects( who );</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span> </div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">is_npc</a>() ) {</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>        <span class="comment">// The stuff below doesn&#39;t apply to NPCs</span></div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        <span class="comment">// search_surroundings should eventually do, though</span></div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>    }</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span> </div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>    <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a61bc9422c35b63128532af268e52cb71">in_vehicle</a> &amp;&amp; <a class="code hl_function" href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a>( 8 ) ) {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>        <a class="code hl_typedef" href="map_8h.html#ae705edb5469cf2668ca5bc3297d75ebb">VehicleList</a> vehs = here.<a class="code hl_function" href="classmap.html#ac1c02ce0648fe07137b86c84fc72f5de">get_vehicles</a>();</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>        <a class="code hl_class" href="classvehicle.html">vehicle</a> *veh = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;v : vehs ) {</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>            veh = v.v;</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>            <span class="keywordflow">if</span>( veh &amp;&amp; veh-&gt;<a class="code hl_function" href="classvehicle.html#aec9a1faa6740b681867d48878e37d7bb">is_moving</a>() &amp;&amp; veh-&gt;<a class="code hl_function" href="classvehicle.html#a341515426011486c265d016c35f84de6">player_in_control</a>( who ) ) {</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>                <span class="keywordtype">double</span> exp_temp = 1 + veh-&gt;<a class="code hl_function" href="classvehicle.html#a5a7d83716bf73d4b58d265b626872d01">total_mass</a>() / 400.0_kilogram +</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>                                  std::abs( veh-&gt;<a class="code hl_variable" href="classvehicle.html#a4d83e86fe57ec6126893a68f68c3c304">velocity</a> / 3200.0 );</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>                <span class="keywordtype">int</span> experience = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( exp_temp );</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>                <span class="keywordflow">if</span>( exp_temp - experience &gt; 0 &amp;&amp; <a class="code hl_function" href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a>( exp_temp - experience, 1.0 ) ) {</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>                    experience++;</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>                }</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>                who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>()-&gt;<a class="code hl_function" href="classCharacter.html#a3d70ebd707bada8879208e98f07f7223">practice</a>( <a class="code hl_typedef" href="type__id_8h.html#a13f6e54f55e89d7c6cd86da6d0a7e785">skill_id</a>( <span class="stringliteral">&quot;driving&quot;</span> ), experience );</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>            }</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>        }</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>    }</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span> </div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>    <a class="code hl_function" href="namespacecharacter__funcs.html#a53b7fa49a536bb361b3a6b2ef669bea4">search_surroundings</a>( who );</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    who.<a class="code hl_function" href="classCharacter.html#aab94093235048027d0afad3f6af4e21c">wait_effects</a>();</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>}</div>
<div class="ttc" id="abodypart_8h_html_a089a199d69623f528a3883672f0a084e"><div class="ttname"><a href="bodypart_8h.html#a089a199d69623f528a3883672f0a084e">all_body_parts</a></div><div class="ttdeci">constexpr std::array&lt; body_part, 12 &gt; all_body_parts</div><div class="ttdoc">Contains all valid body_part values in the order they are defined in.</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00082">bodypart.h:82</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980">body_part</a></div><div class="ttdeci">body_part</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00039">bodypart.h:39</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980a184f1b627fd11fb607e76b2d30dadfbb"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a184f1b627fd11fb607e76b2d30dadfbb">bp_foot_l</a></div><div class="ttdeci">@ bp_foot_l</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00050">bodypart.h:50</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980a202ad82497ebf8867cdcd6ee15085d16"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a202ad82497ebf8867cdcd6ee15085d16">bp_leg_r</a></div><div class="ttdeci">@ bp_leg_r</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00049">bodypart.h:49</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980a2055386ee220ee2ca3e61d13df65e868"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a2055386ee220ee2ca3e61d13df65e868">bp_eyes</a></div><div class="ttdeci">@ bp_eyes</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00042">bodypart.h:42</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980a2806629e65a2c2eb5d8049e29e77910e"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a2806629e65a2c2eb5d8049e29e77910e">bp_hand_l</a></div><div class="ttdeci">@ bp_hand_l</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00046">bodypart.h:46</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980a441080ba1d3930d38f635658d9b28e01"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a441080ba1d3930d38f635658d9b28e01">bp_arm_l</a></div><div class="ttdeci">@ bp_arm_l</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00044">bodypart.h:44</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980a44506e97ae9648354f97d530a3be61b8"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a44506e97ae9648354f97d530a3be61b8">bp_leg_l</a></div><div class="ttdeci">@ bp_leg_l</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00048">bodypart.h:48</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980a54721306a0e05318b6d0440349c1a0fb"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980a54721306a0e05318b6d0440349c1a0fb">bp_hand_r</a></div><div class="ttdeci">@ bp_hand_r</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00047">bodypart.h:47</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980ab1635a97e6cc33a051cd378b60e48698"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ab1635a97e6cc33a051cd378b60e48698">bp_head</a></div><div class="ttdeci">@ bp_head</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00041">bodypart.h:41</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980ab4b216482dcc0e468819f023c3aeddd1"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ab4b216482dcc0e468819f023c3aeddd1">bp_torso</a></div><div class="ttdeci">@ bp_torso</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00040">bodypart.h:40</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980abb7b120eb8dc7c137110446fe541baed"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980abb7b120eb8dc7c137110446fe541baed">bp_mouth</a></div><div class="ttdeci">@ bp_mouth</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00043">bodypart.h:43</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980ac094b1c6f96ebbd604928cfd2fad0ab7"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ac094b1c6f96ebbd604928cfd2fad0ab7">bp_foot_r</a></div><div class="ttdeci">@ bp_foot_r</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00051">bodypart.h:51</a></div></div>
<div class="ttc" id="abodypart_8h_html_af618290c4c2de42aab87977ac7311980ae5f21c7494ad730a0c6abf6957976cb3"><div class="ttname"><a href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980ae5f21c7494ad730a0c6abf6957976cb3">bp_arm_r</a></div><div class="ttdeci">@ bp_arm_r</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8h_source.html#l00045">bodypart.h:45</a></div></div>
<div class="ttc" id="acalendar_8cpp_html_a359120c15f92d54a49fec9de7bcb571f"><div class="ttname"><a href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a></div><div class="ttdeci">bool x_in_y(const time_duration &amp;a, const time_duration &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00521">calendar.cpp:521</a></div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_a08481f62adb6937636ea44b855311037"><div class="ttname"><a href="character__turn_8cpp.html#a08481f62adb6937636ea44b855311037">effect_downed</a></div><div class="ttdeci">static const efftype_id effect_downed(&quot;downed&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_a1d815a8053cfecc8a05374bf92924ba2"><div class="ttname"><a href="character__turn_8cpp.html#a1d815a8053cfecc8a05374bf92924ba2">skill_swimming</a></div><div class="ttdeci">static const skill_id skill_swimming(&quot;swimming&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_afcfa82c36c0dc2d76cd19d622c2b6ab4"><div class="ttname"><a href="character__turn_8cpp.html#afcfa82c36c0dc2d76cd19d622c2b6ab4">effect_onfire</a></div><div class="ttdeci">static const efftype_id effect_onfire(&quot;onfire&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a057d68671b298012a18f4e289b39935d"><div class="ttname"><a href="classCharacter.html#a057d68671b298012a18f4e289b39935d">Character::recoil</a></div><div class="ttdeci">double recoil</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00563">character.h:563</a></div></div>
<div class="ttc" id="aclassCharacter_html_a313797e99525bfd2a5ead68b7672f168"><div class="ttname"><a href="classCharacter.html#a313797e99525bfd2a5ead68b7672f168">Character::martial_arts_data</a></div><div class="ttdeci">pimpl&lt; character_martial_arts &gt; martial_arts_data</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01550">character.h:1550</a></div></div>
<div class="ttc" id="aclassCharacter_html_a3d70ebd707bada8879208e98f07f7223"><div class="ttname"><a href="classCharacter.html#a3d70ebd707bada8879208e98f07f7223">Character::practice</a></div><div class="ttdeci">void practice(const skill_id &amp;id, int amount, int cap=99, bool suppress_warning=false)</div><div class="ttdoc">This handles giving xp for a skill.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03383">character.cpp:3383</a></div></div>
<div class="ttc" id="aclassCharacter_html_a44dbe53874421147bfc4491d8753cccc"><div class="ttname"><a href="classCharacter.html#a44dbe53874421147bfc4491d8753cccc">Character::drench</a></div><div class="ttdeci">void drench(int saturation, const body_part_set &amp;flags, bool ignore_waterproof)</div><div class="ttdoc">Drenches the player with water, saturation is the percent gotten wet.</div><div class="ttdef"><b>Definition:</b> <a href="suffer_8cpp_source.html#l01759">suffer.cpp:1759</a></div></div>
<div class="ttc" id="aclassCharacter_html_a61bc9422c35b63128532af268e52cb71"><div class="ttname"><a href="classCharacter.html#a61bc9422c35b63128532af268e52cb71">Character::in_vehicle</a></div><div class="ttdeci">bool in_vehicle</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01536">character.h:1536</a></div></div>
<div class="ttc" id="aclassCharacter_html_aab94093235048027d0afad3f6af4e21c"><div class="ttname"><a href="classCharacter.html#aab94093235048027d0afad3f6af4e21c">Character::wait_effects</a></div><div class="ttdeci">void wait_effects()</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l01507">character.cpp:1507</a></div></div>
<div class="ttc" id="aclassCreature_html_a5a2346f549de9c87e8f2afeec1e71366"><div class="ttname"><a href="classCreature.html#a5a2346f549de9c87e8f2afeec1e71366">Creature::is_underwater</a></div><div class="ttdeci">virtual bool is_underwater() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00170">creature.cpp:170</a></div></div>
<div class="ttc" id="aclassCreature_html_a666022fd3ed772fa109d273c20e8de55"><div class="ttname"><a href="classCreature.html#a666022fd3ed772fa109d273c20e8de55">Creature::add_effect</a></div><div class="ttdeci">void add_effect(const effect &amp;eff, bool force=false, bool deferred=false)</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00986">creature.cpp:986</a></div></div>
<div class="ttc" id="aclassCreature_html_a6a4c43d66f5a8b50a879d78682b00976"><div class="ttname"><a href="classCreature.html#a6a4c43d66f5a8b50a879d78682b00976">Creature::is_dangerous_fields</a></div><div class="ttdeci">bool is_dangerous_fields(const field &amp;fld) const</div><div class="ttdoc">Returns true if there is a field in the field set that is dangerous to us.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l00185">creature.cpp:185</a></div></div>
<div class="ttc" id="aclassCreature_html_a6fb79df9315dc2bed6f34d9a2e37da90"><div class="ttname"><a href="classCreature.html#a6fb79df9315dc2bed6f34d9a2e37da90">Creature::has_effect</a></div><div class="ttdeci">bool has_effect(const efftype_id &amp;eff_id, body_part bp=num_bp) const</div><div class="ttdoc">Check if creature has the matching effect.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01185">creature.cpp:1185</a></div></div>
<div class="ttc" id="aclassCreature_html_a7cf71d2bd6c350f2ceda3f1d64046e63"><div class="ttname"><a href="classCreature.html#a7cf71d2bd6c350f2ceda3f1d64046e63">Creature::add_msg_player_or_npc</a></div><div class="ttdeci">virtual void add_msg_player_or_npc(const std::string &amp;, const std::string &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00681">creature.h:681</a></div></div>
<div class="ttc" id="aclassCreature_html_a89f56544cdbf34297b4c0e62f3350817"><div class="ttname"><a href="classCreature.html#a89f56544cdbf34297b4c0e62f3350817">Creature::get_effect</a></div><div class="ttdeci">const effect &amp; get_effect(const efftype_id &amp;eff_id, body_part bp=num_bp) const</div><div class="ttdoc">Return the effect that matches the given arguments exactly.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01225">creature.cpp:1225</a></div></div>
<div class="ttc" id="aclassCreature_html_a8c5a392caa213bee9581b47e9f0e2052"><div class="ttname"><a href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">Creature::moves</a></div><div class="ttdeci">int moves</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00574">creature.h:574</a></div></div>
<div class="ttc" id="aclassCreature_html_acb1d0a1210d3dd4c86350f3ad4c58649"><div class="ttname"><a href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">Creature::as_player</a></div><div class="ttdeci">virtual player * as_player()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00122">creature.h:122</a></div></div>
<div class="ttc" id="aclassCreature_html_aed84fe52e1335d48d53f482f8a278c87"><div class="ttname"><a href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">Creature::is_npc</a></div><div class="ttdeci">virtual bool is_npc() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00098">creature.h:98</a></div></div>
<div class="ttc" id="aclasseffect_html"><div class="ttname"><a href="classeffect.html">effect</a></div><div class="ttdef"><b>Definition:</b> <a href="effect_8h_source.html#l00160">effect.h:161</a></div></div>
<div class="ttc" id="aclasseffect_html_a118dd88810785bfbb8243af97a37d2ab"><div class="ttname"><a href="classeffect.html#a118dd88810785bfbb8243af97a37d2ab">effect::mod_duration</a></div><div class="ttdeci">void mod_duration(const time_duration &amp;dur, bool alert=false)</div><div class="ttdoc">Mods the duration, capping at max_duration if it exists.</div><div class="ttdef"><b>Definition:</b> <a href="effect_8cpp_source.html#l00821">effect.cpp:821</a></div></div>
<div class="ttc" id="aclasseffect_html_a34c766f51dc0f89ebdab09c344bb506b"><div class="ttname"><a href="classeffect.html#a34c766f51dc0f89ebdab09c344bb506b">effect::get_duration</a></div><div class="ttdeci">time_duration get_duration() const</div><div class="ttdoc">Returns the remaining duration of an effect.</div><div class="ttdef"><b>Definition:</b> <a href="effect_8cpp_source.html#l00797">effect.cpp:797</a></div></div>
<div class="ttc" id="aclasseffect_html_a39ebd2ec5b2faacde7483e0c07240baa"><div class="ttname"><a href="classeffect.html#a39ebd2ec5b2faacde7483e0c07240baa">effect::is_null</a></div><div class="ttdeci">bool is_null() const</div><div class="ttdoc">Returns true if the effect is the result of effect(), ie.</div><div class="ttdef"><b>Definition:</b> <a href="effect_8cpp_source.html#l00553">effect.cpp:553</a></div></div>
<div class="ttc" id="aclassmap_html_a27e22f0999ea03eff18babc48643c568"><div class="ttname"><a href="classmap.html#a27e22f0999ea03eff18babc48643c568">map::has_flag</a></div><div class="ttdeci">bool has_flag(const std::string &amp;flag, const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l02351">map.cpp:2351</a></div></div>
<div class="ttc" id="aclassmap_html_a395a729a4b954692cf08d13e1d32f73e"><div class="ttname"><a href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">map::field_at</a></div><div class="ttdeci">const field &amp; field_at(const tripoint &amp;p) const</div><div class="ttdoc">Get the fields that are here.</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l05329">map.cpp:5329</a></div></div>
<div class="ttc" id="aclassmap_html_ac1c02ce0648fe07137b86c84fc72f5de"><div class="ttname"><a href="classmap.html#ac1c02ce0648fe07137b86c84fc72f5de">map::get_vehicles</a></div><div class="ttdeci">VehicleList get_vehicles()</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l00295">map.cpp:295</a></div></div>
<div class="ttc" id="aclasstime__duration_html"><div class="ttname"><a href="classtime__duration.html">time_duration</a></div><div class="ttdoc">A duration defined as a number of specific time units.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00179">calendar.h:180</a></div></div>
<div class="ttc" id="aclassvehicle_html"><div class="ttname"><a href="classvehicle.html">vehicle</a></div><div class="ttdoc">A vehicle as a whole with all its components.</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l00675">vehicle.h:676</a></div></div>
<div class="ttc" id="aclassvehicle_html_a341515426011486c265d016c35f84de6"><div class="ttname"><a href="classvehicle.html#a341515426011486c265d016c35f84de6">vehicle::player_in_control</a></div><div class="ttdeci">bool player_in_control(const Character &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l00278">vehicle.cpp:278</a></div></div>
<div class="ttc" id="aclassvehicle_html_a4d83e86fe57ec6126893a68f68c3c304"><div class="ttname"><a href="classvehicle.html#a4d83e86fe57ec6126893a68f68c3c304">vehicle::velocity</a></div><div class="ttdeci">int velocity</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8h_source.html#l01943">vehicle.h:1943</a></div></div>
<div class="ttc" id="aclassvehicle_html_a5a7d83716bf73d4b58d265b626872d01"><div class="ttname"><a href="classvehicle.html#a5a7d83716bf73d4b58d265b626872d01">vehicle::total_mass</a></div><div class="ttdeci">units::mass total_mass() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03307">vehicle.cpp:3307</a></div></div>
<div class="ttc" id="aclassvehicle_html_aec9a1faa6740b681867d48878e37d7bb"><div class="ttname"><a href="classvehicle.html#aec9a1faa6740b681867d48878e37d7bb">vehicle::is_moving</a></div><div class="ttdeci">bool is_moving() const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03545">vehicle.cpp:3545</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a></div><div class="ttdeci">@ m_warning</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00264">enums.h:264</a></div></div>
<div class="ttc" id="agame__constants_8h_html_a8226e8a134603e5bc06df05efd13d8d1"><div class="ttname"><a href="game__constants_8h.html#a8226e8a134603e5bc06df05efd13d8d1">MAX_RECOIL</a></div><div class="ttdeci">constexpr double MAX_RECOIL</div><div class="ttdef"><b>Definition:</b> <a href="game__constants_8h_source.html#l00131">game_constants.h:131</a></div></div>
<div class="ttc" id="amap_8h_html_ae705edb5469cf2668ca5bc3297d75ebb"><div class="ttname"><a href="map_8h.html#ae705edb5469cf2668ca5bc3297d75ebb">VehicleList</a></div><div class="ttdeci">std::vector&lt; wrapped_vehicle &gt; VehicleList</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00085">map.h:85</a></div></div>
<div class="ttc" id="amapdata_8h_html_aa04d037303ea30193f7cf0cd82304258aeb9fcbd752ad2c632ccc4383c5641b69"><div class="ttname"><a href="mapdata_8h.html#aa04d037303ea30193f7cf0cd82304258aeb9fcbd752ad2c632ccc4383c5641b69">TFLAG_DEEP_WATER</a></div><div class="ttdeci">@ TFLAG_DEEP_WATER</div><div class="ttdef"><b>Definition:</b> <a href="mapdata_8h_source.html#l00301">mapdata.h:301</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a53b7fa49a536bb361b3a6b2ef669bea4"><div class="ttname"><a href="namespacecharacter__funcs.html#a53b7fa49a536bb361b3a6b2ef669bea4">character_funcs::search_surroundings</a></div><div class="ttdeci">void search_surroundings(Character &amp;who)</div><div class="ttdoc">Search surrounding squares for traps (and maybe other things in the future).</div><div class="ttdef"><b>Definition:</b> <a href="character__turn_8cpp_source.html#l01056">character_turn.cpp:1056</a></div></div>
<div class="ttc" id="arng_8cpp_html_aad28bdad07401a34ecf9912708f8b750"><div class="ttname"><a href="rng_8cpp.html#aad28bdad07401a34ecf9912708f8b750">one_in</a></div><div class="ttdeci">bool one_in(int chance)</div><div class="ttdef"><b>Definition:</b> <a href="rng_8cpp_source.html#l00065">rng.cpp:65</a></div></div>
<div class="ttc" id="atype__id_8h_html_a13f6e54f55e89d7c6cd86da6d0a7e785"><div class="ttname"><a href="type__id_8h.html#a13f6e54f55e89d7c6cd86da6d0a7e785">skill_id</a></div><div class="ttdeci">string_id&lt; Skill &gt; skill_id</div><div class="ttdef"><b>Definition:</b> <a href="type__id_8h_source.html#l00149">type_id.h:149</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="creature_8cpp_source.html#l00986">Creature::add_effect()</a>, <a class="el" href="creature_8h_source.html#l00681">Creature::add_msg_player_or_npc()</a>, <a class="el" href="bodypart_8h_source.html#l00082">all_body_parts</a>, <a class="el" href="creature_8h_source.html#l00122">Creature::as_player()</a>, <a class="el" href="bodypart_8h_source.html#l00044">bp_arm_l</a>, <a class="el" href="bodypart_8h_source.html#l00045">bp_arm_r</a>, <a class="el" href="bodypart_8h_source.html#l00042">bp_eyes</a>, <a class="el" href="bodypart_8h_source.html#l00050">bp_foot_l</a>, <a class="el" href="bodypart_8h_source.html#l00051">bp_foot_r</a>, <a class="el" href="bodypart_8h_source.html#l00046">bp_hand_l</a>, <a class="el" href="bodypart_8h_source.html#l00047">bp_hand_r</a>, <a class="el" href="bodypart_8h_source.html#l00041">bp_head</a>, <a class="el" href="bodypart_8h_source.html#l00048">bp_leg_l</a>, <a class="el" href="bodypart_8h_source.html#l00049">bp_leg_r</a>, <a class="el" href="bodypart_8h_source.html#l00043">bp_mouth</a>, <a class="el" href="bodypart_8h_source.html#l00040">bp_torso</a>, <a class="el" href="suffer_8cpp_source.html#l01759">Character::drench()</a>, <a class="el" href="character__turn_8cpp.html#a08481f62adb6937636ea44b855311037">effect_downed</a>, <a class="el" href="character__turn_8cpp.html#afcfa82c36c0dc2d76cd19d622c2b6ab4">effect_onfire</a>, <a class="el" href="map_8cpp_source.html#l05329">map::field_at()</a>, <a class="el" href="effect_8cpp_source.html#l00797">effect::get_duration()</a>, <a class="el" href="creature_8cpp_source.html#l01225">Creature::get_effect()</a>, <a class="el" href="map_8cpp_source.html#l00146">get_map()</a>, <a class="el" href="map_8cpp_source.html#l00295">map::get_vehicles()</a>, <a class="el" href="creature_8cpp_source.html#l01185">Creature::has_effect()</a>, <a class="el" href="map_8cpp_source.html#l02351">map::has_flag()</a>, <a class="el" href="character_8h_source.html#l01536">Character::in_vehicle</a>, <a class="el" href="creature_8cpp_source.html#l00185">Creature::is_dangerous_fields()</a>, <a class="el" href="vehicle_8cpp_source.html#l03545">vehicle::is_moving()</a>, <a class="el" href="creature_8h_source.html#l00098">Creature::is_npc()</a>, <a class="el" href="effect_8cpp_source.html#l00553">effect::is_null()</a>, <a class="el" href="creature_8cpp_source.html#l00170">Creature::is_underwater()</a>, <a class="el" href="enums_8h_source.html#l00264">m_warning</a>, <a class="el" href="character_8h_source.html#l01550">Character::martial_arts_data</a>, <a class="el" href="game__constants_8h_source.html#l00131">MAX_RECOIL</a>, <a class="el" href="effect_8cpp_source.html#l00821">effect::mod_duration()</a>, <a class="el" href="creature_8h_source.html#l00574">Creature::moves</a>, <a class="el" href="bodypart_8h_source.html#l00052">num_bp</a>, <a class="el" href="rng_8cpp_source.html#l00065">one_in()</a>, <a class="el" href="vehicle_8cpp_source.html#l00278">vehicle::player_in_control()</a>, <a class="el" href="character_8cpp_source.html#l00587">Character::pos()</a>, <a class="el" href="character_8cpp_source.html#l03383">Character::practice()</a>, <a class="el" href="character_8h_source.html#l00563">Character::recoil</a>, <a class="el" href="character__turn_8cpp_source.html#l01056">search_surroundings()</a>, <a class="el" href="character__turn_8cpp.html#a1d815a8053cfecc8a05374bf92924ba2">skill_swimming</a>, <a class="el" href="mapdata_8h_source.html#l00301">TFLAG_DEEP_WATER</a>, <a class="el" href="vehicle_8cpp_source.html#l03307">vehicle::total_mass()</a>, <a class="el" href="vehicle_8h_source.html#l01943">vehicle::velocity</a>, <a class="el" href="character_8cpp_source.html#l01507">Character::wait_effects()</a>, and <a class="el" href="calendar_8cpp_source.html#l00521">x_in_y()</a>.</p>

<p class="reference">Referenced by <a class="el" href="player__activity_8cpp_source.html#l00273">player_activity::do_turn()</a>, <a class="el" href="handle__action_8cpp_source.html#l01520">game::handle_action()</a>, and <a class="el" href="npcmove_8cpp_source.html#l02658">npc::move_pause()</a>.</p>

</div>
</div>
<a id="a470b862a6936cbfbd1e80a46b78f1914" name="a470b862a6936cbfbd1e80a46b78f1914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a470b862a6936cbfbd1e80a46b78f1914">&#9670;&nbsp;</a></span>estimate_effect_dur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtime__duration.html">time_duration</a> character_funcs::estimate_effect_dur </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>skill_lvl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#acc8305d21e9a186d196c8ff88ba2cf19">efftype_id</a> &amp;&#160;</td>
          <td class="paramname"><em>target_effect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classtime__duration.html">time_duration</a> &amp;&#160;</td>
          <td class="paramname"><em>error_magnitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCreature.html">Creature</a> &amp;&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimate effect duration based on relevant skill. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00072">72</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>{</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="keyword">const</span> <a class="code hl_class" href="classtime__duration.html">time_duration</a> zero_duration = 0_turns;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    <a class="code hl_class" href="classtime__duration.html">time_duration</a> estimate = std::max( zero_duration, target.<a class="code hl_function" href="classCreature.html#a2bb3543ca955d69805e57e4e09d878ef">get_effect_dur</a>( target_effect ) +</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>                                       <a class="code hl_function" href="artifact_8cpp.html#a70800e95389f34dd34186fafaea2a840">rng</a>( -1, 1 ) * error_magnitude *</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>                                       <a class="code hl_function" href="artifact_8cpp.html#a70800e95389f34dd34186fafaea2a840">rng</a>( 0, std::max( 0, threshold - skill_lvl ) ) );</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="keywordflow">return</span> estimate;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>}</div>
<div class="ttc" id="aartifact_8cpp_html_a70800e95389f34dd34186fafaea2a840"><div class="ttname"><a href="artifact_8cpp.html#a70800e95389f34dd34186fafaea2a840">rng</a></div><div class="ttdeci">units::quantity&lt; V, B &gt; rng(const units::quantity&lt; V, B &gt; &amp;min, const units::quantity&lt; V, B &gt; &amp;max)</div><div class="ttdef"><b>Definition:</b> <a href="artifact_8cpp_source.html#l00032">artifact.cpp:32</a></div></div>
<div class="ttc" id="aclassCreature_html_a2bb3543ca955d69805e57e4e09d878ef"><div class="ttname"><a href="classCreature.html#a2bb3543ca955d69805e57e4e09d878ef">Creature::get_effect_dur</a></div><div class="ttdeci">time_duration get_effect_dur(const efftype_id &amp;eff_id, body_part bp=num_bp) const</div><div class="ttdoc">Returns the duration of the matching effect.</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01247">creature.cpp:1247</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="creature_8cpp_source.html#l01247">Creature::get_effect_dur()</a>, and <a class="el" href="artifact_8cpp_source.html#l00032">rng()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npctalk_8cpp_source.html#l00898">dialogue::dynamic_line()</a>.</p>

</div>
</div>
<a id="a5f96350c8609af351eb0c0b83d899748" name="a5f96350c8609af351eb0c0b83d899748"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f96350c8609af351eb0c0b83d899748">&#9670;&nbsp;</a></span>find_ammo_helper()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename Output &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::find_ammo_helper </td>
          <td>(</td>
          <td class="paramtype">T &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>empty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Output&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>nested</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l01051">1051</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>{</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    <span class="keywordflow">if</span>( <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>.is_watertight_container() ) {</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>        <span class="keywordflow">if</span>( !<a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>.is_container_empty() ) {</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>            <span class="keyword">auto</span> contents_id = <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>.contents.front().typeId();</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span> </div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>            <span class="comment">// Look for containers with the same type of liquid as that already in our container</span></div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>            src.visit_items( [&amp;src, &amp;nested, &amp;out, &amp;contents_id, &amp;<a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>]( <a class="code hl_class" href="classitem.html">item</a> * node ) {</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>                <span class="keywordflow">if</span>( node == &amp;<a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a> ) {</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>                    <span class="comment">// This stops containers and magazines counting *themselves* as ammo sources.</span></div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>                    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a>;</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>                }</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span> </div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>                <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#a723753bab4cc789e3ec186846c9916a3">is_container</a>() &amp;&amp; !node-&gt;<a class="code hl_function" href="classitem.html#a5996f63ca1797fc01482678b51a87680">is_container_empty</a>() &amp;&amp;</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>                    node-&gt;<a class="code hl_variable" href="classitem.html#a4afe851abb42cbff0857065860f96e0e">contents</a>.<a class="code hl_function" href="classitem__contents.html#a14299e40ca1440af11623c86e0b84072">front</a>().<a class="code hl_function" href="classitem.html#aa79dad64e1ef6347219be2f8666e2752">typeId</a>() == contents_id ) {</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>                    out = item_location( src, node );</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>                }</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>                <span class="keywordflow">return</span> nested ? <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613da47559fb833ff58321570e5e877b467f6">VisitResponse::NEXT</a> : <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a>;</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>            } );</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>            <span class="comment">// Look for containers with any liquid</span></div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>            src.visit_items( [&amp;src, &amp;nested, &amp;out]( <a class="code hl_class" href="classitem.html">item</a> * node ) {</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>                <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#a723753bab4cc789e3ec186846c9916a3">is_container</a>() &amp;&amp; node-&gt;<a class="code hl_function" href="classitem.html#ac2165c43ba47bfecf5e3cff16a3c3f03">contents_made_of</a>( <a class="code hl_enumvalue" href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5aa87f9501ff2b390be1ea7d261b0d7cce">LIQUID</a> ) ) {</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>                    out = item_location( src, node );</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>                }</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>                <span class="keywordflow">return</span> nested ? <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613da47559fb833ff58321570e5e877b467f6">VisitResponse::NEXT</a> : <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a>;</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>            } );</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>        }</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>    }</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>    <span class="keywordflow">if</span>( <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>.magazine_integral() ) {</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>        <span class="comment">// find suitable ammo excluding that already loaded in magazines</span></div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>        <span class="keyword">const</span> std::set&lt;ammotype&gt; &amp;ammo = <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>.ammo_types();</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>        <span class="keyword">const</span> <span class="keyword">auto</span> mags = <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>.magazine_compatible();</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span> </div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>        src.visit_items( [&amp;src, &amp;nested, &amp;out, &amp;mags, ammo]( <a class="code hl_class" href="classitem.html">item</a> * node ) {</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>            <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">is_gun</a>() || node-&gt;<a class="code hl_function" href="classitem.html#a59a03649a0636c70e776054db688564a">is_tool</a>() ) {</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>                <span class="comment">// guns/tools never contain usable ammo so most efficient to skip them now</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>                return VisitResponse::SKIP;</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>            }</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>            <span class="keywordflow">if</span>( !node-&gt;<a class="code hl_function" href="classitem.html#a4326944ae95f4d265c8ca1c76ed89a03">made_of</a>( <a class="code hl_enumvalue" href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5a1b45f84e1f6603b52e5ef442836df9af">SOLID</a> ) ) {</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>                <span class="comment">// some liquids are ammo but we can&#39;t reload with them unless within a container or frozen</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>                return VisitResponse::SKIP;</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>            }</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>            <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#a187a2679361c6546be613657dbad3b3f">is_ammo_container</a>() &amp;&amp; !node-&gt;<a class="code hl_variable" href="classitem.html#a4afe851abb42cbff0857065860f96e0e">contents</a>.<a class="code hl_function" href="classitem__contents.html#ad5b1250d9699aa489bbfcf3e5689581b">empty</a>() &amp;&amp;</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>                !node-&gt;<a class="code hl_function" href="classitem.html#ac2165c43ba47bfecf5e3cff16a3c3f03">contents_made_of</a>( <a class="code hl_enumvalue" href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5a1b45f84e1f6603b52e5ef442836df9af">SOLID</a> ) ) {</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>                for( const ammotype &amp;at : ammo ) {</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>                    if( node-&gt;contents.front().ammo_type() == at ) {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>                        out = item_location( src, node );</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>                    }</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>                }</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a>;</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>            }</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span> </div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>            <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_class" href="classstring__id.html">ammotype</a> &amp;at : ammo ) {</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>                <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#aab4f4feeb64f169f408c24d03e0ce61f">ammo_type</a>() == at ) {</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>                    out = item_location( src, node );</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>                }</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>            }</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>            <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#adce43f2490a85e2dc212a26ce5ded4fc">is_magazine</a>() &amp;&amp; node-&gt;<a class="code hl_function" href="classitem.html#aaa5aeb6f838927babb10ede535cf2a73">has_flag</a>( <a class="code hl_function" href="character__functions_8cpp.html#aa068f30eefcfd296c51572f604c37013">flag_SPEEDLOADER</a> ) ) {</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>                if( mags.count( node-&gt;typeId() ) &amp;&amp; node-&gt;ammo_remaining() ) {</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>                    out = item_location( src, node );</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>                }</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>            }</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>            <span class="keywordflow">return</span> nested ? <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613da47559fb833ff58321570e5e877b467f6">VisitResponse::NEXT</a> : <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a>;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>        } );</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>        <span class="comment">// find compatible magazines excluding those already loaded in tools/guns</span></div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>        <span class="keyword">const</span> <span class="keyword">auto</span> mags = <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>.magazine_compatible();</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span> </div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>        src.visit_items( [&amp;src, &amp;nested, &amp;out, mags, empty]( <a class="code hl_class" href="classitem.html">item</a> * node ) {</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>            <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">is_gun</a>() || node-&gt;<a class="code hl_function" href="classitem.html#a59a03649a0636c70e776054db688564a">is_tool</a>() ) {</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>                return VisitResponse::SKIP;</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>            }</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>            <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#adce43f2490a85e2dc212a26ce5ded4fc">is_magazine</a>() ) {</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>                if( mags.count( node-&gt;typeId() ) &amp;&amp; ( node-&gt;ammo_remaining() || empty ) ) {</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>                    out = item_location( src, node );</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>                }</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>                <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a>;</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>            }</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>            <span class="keywordflow">return</span> nested ? <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613da47559fb833ff58321570e5e877b467f6">VisitResponse::NEXT</a> : <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a>;</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>        } );</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>    }</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>}</div>
<div class="ttc" id="acharacter__functions_8cpp_html_aa068f30eefcfd296c51572f604c37013"><div class="ttname"><a href="character__functions_8cpp.html#aa068f30eefcfd296c51572f604c37013">flag_SPEEDLOADER</a></div><div class="ttdeci">static const std::string flag_SPEEDLOADER(&quot;SPEEDLOADER&quot;)</div></div>
<div class="ttc" id="aclassint__id_html_a315169d32cce4267b7c8dceff4b0d1d7"><div class="ttname"><a href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">int_id::obj</a></div><div class="ttdeci">const ammo_effect &amp; obj() const</div><div class="ttdef"><b>Definition:</b> <a href="ammo__effect_8cpp_source.html#l00026">ammo_effect.cpp:26</a></div></div>
<div class="ttc" id="aclassitem__contents_html_a14299e40ca1440af11623c86e0b84072"><div class="ttname"><a href="classitem__contents.html#a14299e40ca1440af11623c86e0b84072">item_contents::front</a></div><div class="ttdeci">item &amp; front()</div><div class="ttdoc">this is an artifact of the previous code using front() everywhere for contents.</div><div class="ttdef"><b>Definition:</b> <a href="item__contents_8cpp_source.html#l00190">item_contents.cpp:190</a></div></div>
<div class="ttc" id="aclassitem__contents_html_ad5b1250d9699aa489bbfcf3e5689581b"><div class="ttname"><a href="classitem__contents.html#ad5b1250d9699aa489bbfcf3e5689581b">item_contents::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdef"><b>Definition:</b> <a href="item__contents_8cpp_source.html#l00016">item_contents.cpp:16</a></div></div>
<div class="ttc" id="aclassitem_html_a187a2679361c6546be613657dbad3b3f"><div class="ttname"><a href="classitem.html#a187a2679361c6546be613657dbad3b3f">item::is_ammo_container</a></div><div class="ttdeci">bool is_ammo_container() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06662">item.cpp:6662</a></div></div>
<div class="ttc" id="aclassitem_html_a4326944ae95f4d265c8ca1c76ed89a03"><div class="ttname"><a href="classitem.html#a4326944ae95f4d265c8ca1c76ed89a03">item::made_of</a></div><div class="ttdeci">const std::vector&lt; material_id &gt; &amp; made_of() const</div><div class="ttdoc">The ids of all the materials this is made of.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06413">item.cpp:6413</a></div></div>
<div class="ttc" id="aclassitem_html_a4afe851abb42cbff0857065860f96e0e"><div class="ttname"><a href="classitem.html#a4afe851abb42cbff0857065860f96e0e">item::contents</a></div><div class="ttdeci">item_contents contents</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l02158">item.h:2158</a></div></div>
<div class="ttc" id="aclassitem_html_a5996f63ca1797fc01482678b51a87680"><div class="ttname"><a href="classitem.html#a5996f63ca1797fc01482678b51a87680">item::is_container_empty</a></div><div class="ttdeci">bool is_container_empty() const</div><div class="ttdoc">Whether this item has no contents at all.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06837">item.cpp:6837</a></div></div>
<div class="ttc" id="aclassitem_html_a59a03649a0636c70e776054db688564a"><div class="ttname"><a href="classitem.html#a59a03649a0636c70e776054db688564a">item::is_tool</a></div><div class="ttdeci">bool is_tool() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06953">item.cpp:6953</a></div></div>
<div class="ttc" id="aclassitem_html_a723753bab4cc789e3ec186846c9916a3"><div class="ttname"><a href="classitem.html#a723753bab4cc789e3ec186846c9916a3">item::is_container</a></div><div class="ttdeci">bool is_container() const</div><div class="ttdoc">Whether this is container.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06719">item.cpp:6719</a></div></div>
<div class="ttc" id="aclassitem_html_aa79dad64e1ef6347219be2f8666e2752"><div class="ttname"><a href="classitem.html#aa79dad64e1ef6347219be2f8666e2752">item::typeId</a></div><div class="ttdeci">const itype_id &amp; typeId() const</div><div class="ttdoc">return the unique identifier of the items underlying type</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l08353">item.cpp:8353</a></div></div>
<div class="ttc" id="aclassitem_html_aaa5aeb6f838927babb10ede535cf2a73"><div class="ttname"><a href="classitem.html#aaa5aeb6f838927babb10ede535cf2a73">item::has_flag</a></div><div class="ttdeci">bool has_flag(const std::string &amp;flag) const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l05303">item.cpp:5303</a></div></div>
<div class="ttc" id="aclassitem_html_aab4f4feeb64f169f408c24d03e0ce61f"><div class="ttname"><a href="classitem.html#aab4f4feeb64f169f408c24d03e0ce61f">item::ammo_type</a></div><div class="ttdeci">ammotype ammo_type() const</div><div class="ttdoc">Ammo type of an ammo item.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07588">item.cpp:7588</a></div></div>
<div class="ttc" id="aclassitem_html_ac2165c43ba47bfecf5e3cff16a3c3f03"><div class="ttname"><a href="classitem.html#ac2165c43ba47bfecf5e3cff16a3c3f03">item::contents_made_of</a></div><div class="ttdeci">bool contents_made_of(phase_id phase) const</div><div class="ttdoc">If contents nonempty, return true if item phase is same, else false.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06465">item.cpp:6465</a></div></div>
<div class="ttc" id="aclassitem_html_adce43f2490a85e2dc212a26ce5ded4fc"><div class="ttname"><a href="classitem.html#adce43f2490a85e2dc212a26ce5ded4fc">item::is_magazine</a></div><div class="ttdeci">bool is_magazine() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06557">item.cpp:6557</a></div></div>
<div class="ttc" id="aclassstring__id_html"><div class="ttname"><a href="classstring__id.html">string_id&lt; ammunition_type &gt;</a></div></div>
<div class="ttc" id="aenums_8h_html_ade8f325e8cc8463cef8f944f3209d0e5a1b45f84e1f6603b52e5ef442836df9af"><div class="ttname"><a href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5a1b45f84e1f6603b52e5ef442836df9af">SOLID</a></div><div class="ttdeci">@ SOLID</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00175">enums.h:175</a></div></div>
<div class="ttc" id="aenums_8h_html_ade8f325e8cc8463cef8f944f3209d0e5aa87f9501ff2b390be1ea7d261b0d7cce"><div class="ttname"><a href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5aa87f9501ff2b390be1ea7d261b0d7cce">LIQUID</a></div><div class="ttdeci">@ LIQUID</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00175">enums.h:175</a></div></div>
<div class="ttc" id="avisitable_8h_html_aa872f25fbac30cbf9e03c0153587613da47559fb833ff58321570e5e877b467f6"><div class="ttname"><a href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613da47559fb833ff58321570e5e877b467f6">VisitResponse::NEXT</a></div><div class="ttdeci">@ NEXT</div></div>
<div class="ttc" id="avisitable_8h_html_aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef"><div class="ttname"><a href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a></div><div class="ttdeci">@ SKIP</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="item_8cpp_source.html#l07588">item::ammo_type()</a>, <a class="el" href="item_8h_source.html#l02158">item::contents</a>, <a class="el" href="item_8cpp_source.html#l06465">item::contents_made_of()</a>, <a class="el" href="item__contents_8cpp_source.html#l00016">item_contents::empty()</a>, <a class="el" href="character__functions_8cpp.html#aa068f30eefcfd296c51572f604c37013">flag_SPEEDLOADER()</a>, <a class="el" href="item__contents_8cpp_source.html#l00190">item_contents::front()</a>, <a class="el" href="item_8cpp_source.html#l05303">item::has_flag()</a>, <a class="el" href="item_8cpp_source.html#l06662">item::is_ammo_container()</a>, <a class="el" href="item_8cpp_source.html#l06719">item::is_container()</a>, <a class="el" href="item_8cpp_source.html#l06837">item::is_container_empty()</a>, <a class="el" href="item_8cpp_source.html#l06517">item::is_gun()</a>, <a class="el" href="item_8cpp_source.html#l06557">item::is_magazine()</a>, <a class="el" href="item_8cpp_source.html#l06953">item::is_tool()</a>, <a class="el" href="enums_8h_source.html#l00175">LIQUID</a>, <a class="el" href="item_8cpp_source.html#l06413">item::made_of()</a>, <a class="el" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613da47559fb833ff58321570e5e877b467f6">NEXT</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00026">int_id&lt; T &gt;::obj()</a>, <a class="el" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">SKIP</a>, <a class="el" href="enums_8h_source.html#l00175">SOLID</a>, and <a class="el" href="item_8cpp_source.html#l08353">item::typeId()</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l01135">find_ammo_items_or_mags()</a>.</p>

</div>
</div>
<a id="af0d4f519cd76c1891183b3c557bdf007" name="af0d4f519cd76c1891183b3c557bdf007"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0d4f519cd76c1891183b3c557bdf007">&#9670;&nbsp;</a></span>find_ammo_items_or_mags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classitem__location.html">item_location</a> &gt; character_funcs::find_ammo_items_or_mags </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>empty</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>radius</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches for ammo or magazines that can be used to reload given item. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> looking for ammo </td></tr>
    <tr><td class="paramname">obj</td><td>item to be reloaded. By design any currently loaded ammunition or magazine is ignored </td></tr>
    <tr><td class="paramname">empty</td><td>whether empty magazines should be considered as possible ammo </td></tr>
    <tr><td class="paramname">radius</td><td>adjacent map/vehicle tiles to search. 0 for only character tile, -1 for only inventory </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l01135">1135</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>{</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    std::vector&lt;item_location&gt; res;</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span> </div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>    <a class="code hl_function" href="namespacecharacter__funcs.html#a5f96350c8609af351eb0c0b83d899748">find_ammo_helper</a>( <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classCharacter.html">Character</a> &amp;<span class="keyword">&gt;</span>( who ), <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>, empty, std::back_inserter( res ), <span class="keyword">true</span> );</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span> </div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>    <span class="keywordflow">if</span>( radius &gt;= 0 ) {</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>        <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;cursor : <a class="code hl_class" href="classmap__selector.html">map_selector</a>( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), radius ) ) {</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>            <a class="code hl_function" href="namespacecharacter__funcs.html#a5f96350c8609af351eb0c0b83d899748">find_ammo_helper</a>( cursor, <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>, empty, std::back_inserter( res ), <span class="keyword">false</span> );</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>        }</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>        <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;cursor : <a class="code hl_class" href="classvehicle__selector.html">vehicle_selector</a>( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), radius ) ) {</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>            <a class="code hl_function" href="namespacecharacter__funcs.html#a5f96350c8609af351eb0c0b83d899748">find_ammo_helper</a>( cursor, <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>, empty, std::back_inserter( res ), <span class="keyword">false</span> );</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>        }</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>    }</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span> </div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>}</div>
<div class="ttc" id="aclassCharacter_html"><div class="ttname"><a href="classCharacter.html">Character</a></div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00217">character.h:218</a></div></div>
<div class="ttc" id="aclassmap__selector_html"><div class="ttname"><a href="classmap__selector.html">map_selector</a></div><div class="ttdef"><b>Definition:</b> <a href="map__selector_8h_source.html#l00020">map_selector.h:21</a></div></div>
<div class="ttc" id="aclassvehicle__selector_html"><div class="ttname"><a href="classvehicle__selector.html">vehicle_selector</a></div><div class="ttdef"><b>Definition:</b> <a href="vehicle__selector_8h_source.html#l00021">vehicle_selector.h:22</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a5f96350c8609af351eb0c0b83d899748"><div class="ttname"><a href="namespacecharacter__funcs.html#a5f96350c8609af351eb0c0b83d899748">character_funcs::find_ammo_helper</a></div><div class="ttdeci">void find_ammo_helper(T &amp;src, const item &amp;obj, bool empty, Output out, bool nested)</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l01051">character_functions.cpp:1051</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__functions_8cpp_source.html#l01051">find_ammo_helper()</a>, <a class="el" href="ammo__effect_8cpp_source.html#l00026">int_id&lt; T &gt;::obj()</a>, and <a class="el" href="character_8cpp_source.html#l00587">Character::pos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l01180">ammo_count_for()</a>, <a class="el" href="item_8cpp_source.html#l04132">item::color_in_inventory()</a>, and <a class="el" href="character__functions_8cpp_source.html#l00706">list_ammo()</a>.</p>

</div>
</div>
<a id="a23064b8a06c8495a2faca7aff01b1c05" name="a23064b8a06c8495a2faca7aff01b1c05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23064b8a06c8495a2faca7aff01b1c05">&#9670;&nbsp;</a></span>find_reloadables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classitem__location.html">item_location</a> &gt; character_funcs::find_reloadables </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches for weapons and magazines that can be reloaded. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l01154">1154</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>{</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>    std::vector&lt;item_location&gt; reloadables;</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span> </div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>    who.<a class="code hl_function" href="classvisitable.html#a0a76a71d6a905414cc81236e86a7e649">visit_items</a>( [&amp;]( <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> * node ) {</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>        <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#a6de81eeb1c4666a84e1d774582b945ae">is_holster</a>() ) {</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>            return VisitResponse::NEXT;</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>        }</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>        <span class="keywordtype">bool</span> reloadable = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>        <span class="keywordflow">if</span>( node-&gt;<a class="code hl_function" href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">is_gun</a>() &amp;&amp; !node-&gt;<a class="code hl_function" href="classitem.html#a3ebcbfa7afc85cc501d72f52d09e9984">magazine_compatible</a>().empty() ) {</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>            reloadable = node-&gt;magazine_current() == nullptr ||</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>                         node-&gt;ammo_remaining() &lt; node-&gt;ammo_capacity();</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>            reloadable = ( node-&gt;is_magazine() || node-&gt;is_bandolier() ||</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>                           ( node-&gt;is_gun() &amp;&amp; node-&gt;magazine_integral() ) ) &amp;&amp;</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>                         node-&gt;ammo_remaining() &lt; node-&gt;ammo_capacity();</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>        }</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>        <span class="keywordflow">if</span>( reloadable ) {</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>            reloadables.push_back( item_location( const_cast&lt;Character &amp;&gt;( who ),</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>                                                  const_cast&lt;item *&gt;( node ) ) );</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>        }</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">VisitResponse::SKIP</a>;</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    } );</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>    <span class="keywordflow">return</span> reloadables;</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>}</div>
<div class="ttc" id="aclassitem_html_a3ebcbfa7afc85cc501d72f52d09e9984"><div class="ttname"><a href="classitem.html#a3ebcbfa7afc85cc501d72f52d09e9984">item::magazine_compatible</a></div><div class="ttdeci">std::set&lt; itype_id &gt; magazine_compatible(bool conversion=true) const</div><div class="ttdoc">Get compatible magazines (if any) for this item.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07696">item.cpp:7696</a></div></div>
<div class="ttc" id="aclassitem_html_a6de81eeb1c4666a84e1d774582b945ae"><div class="ttname"><a href="classitem.html#a6de81eeb1c4666a84e1d774582b945ae">item::is_holster</a></div><div class="ttdeci">bool is_holster() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06577">item.cpp:6577</a></div></div>
<div class="ttc" id="aclassvisitable_html_a0a76a71d6a905414cc81236e86a7e649"><div class="ttname"><a href="classvisitable.html#a0a76a71d6a905414cc81236e86a7e649">visitable::visit_items</a></div><div class="ttdeci">VisitResponse visit_items(const std::function&lt; VisitResponse(item *, item *)&gt; &amp;func)</div><div class="ttdoc">Traverses this object and any child items contained using a visitor pattern.</div><div class="ttdef"><b>Definition:</b> <a href="visitable_8cpp_source.html#l00422">visitable.cpp:422</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="item_8cpp_source.html#l06517">item::is_gun()</a>, <a class="el" href="item_8cpp_source.html#l06577">item::is_holster()</a>, <a class="el" href="item_8cpp_source.html#l07696">item::magazine_compatible()</a>, <a class="el" href="visitable_8h.html#aa872f25fbac30cbf9e03c0153587613dab85df04e922fe1dd3c1f0692faeaacef">SKIP</a>, and <a class="el" href="visitable_8cpp_source.html#l00422">visitable&lt; T &gt;::visit_items()</a>.</p>

<p class="reference">Referenced by <a class="el" href="avatar__action_8cpp_source.html#l01244">avatar_action::reload_weapon()</a>.</p>

</div>
</div>
<a id="adda4d5fd10b7216c49a0f9b6010de579" name="adda4d5fd10b7216c49a0f9b6010de579"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda4d5fd10b7216c49a0f9b6010de579">&#9670;&nbsp;</a></span>fine_detail_vision_mod() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float character_funcs::fine_detail_vision_mod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates multiplier for the time taken to perform tasks that require detail vision (reading, crafting, etc.). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> to check for </td></tr>
    <tr><td class="paramname">pos</td><td>Check remote spot as if the character were standing there</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A value from 1.0 (unimpeded vision) to 11.0 (totally blind).</dd></dl>
<p>Examples of produced values: 1.0 is LIGHT_AMBIENT_LIT or brighter 4.0 is a dark clear night, barely bright enough for reading and crafting 6.0 is LIGHT_AMBIENT_DIM 7.3 is LIGHT_AMBIENT_MINIMAL, a dark cloudy night, unlit indoors 11.0 is zero light or blindness </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00146">146</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>{</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecharacter__funcs.html#a03ea116da570af10c630e0fe3a7ea6fc">fine_detail_vision_mod</a>( who, who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() );</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__functions_8cpp_source.html#l00146">fine_detail_vision_mod()</a>, and <a class="el" href="character_8cpp_source.html#l00587">Character::pos()</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l00177">can_see_fine_details()</a>, <a class="el" href="panels_8cpp_source.html#l01497">draw_env_compact()</a>, <a class="el" href="panels_8cpp_source.html#l01864">draw_lighting_classic()</a>, <a class="el" href="panels_8cpp_source.html#l01303">draw_loc_labels()</a>, <a class="el" href="character__functions_8cpp_source.html#l00146">fine_detail_vision_mod()</a>, <a class="el" href="avatar_8cpp_source.html#l00255">avatar::get_book_reader()</a>, <a class="el" href="iuse_8cpp_source.html#l05840">iuse::gun_repair()</a>, <a class="el" href="crafting_8cpp_source.html#l00132">lighting_crafting_speed_multiplier()</a>, <a class="el" href="avatar_8cpp_source.html#l00387">avatar::read()</a>, <a class="el" href="activity__handlers_8cpp_source.html#l03327">activity_handlers::repair_item_do_turn()</a>, <a class="el" href="npc_8cpp_source.html#l00883">npc::time_to_read()</a>, <a class="el" href="avatar_8cpp_source.html#l00345">avatar::time_to_read()</a>, and <a class="el" href="iuse__actor_8cpp_source.html#l04808">sew_advanced_actor::use()</a>.</p>

</div>
</div>
<a id="a03ea116da570af10c630e0fe3a7ea6fc" name="a03ea116da570af10c630e0fe3a7ea6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03ea116da570af10c630e0fe3a7ea6fc">&#9670;&nbsp;</a></span>fine_detail_vision_mod() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float character_funcs::fine_detail_vision_mod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtripoint.html">tripoint</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00151">151</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>{</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <span class="comment">// PER_SLIME_OK implies you can get enough eyes around the bile</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <span class="comment">// that you can generally see.  There still will be the haze, but</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <span class="comment">// it&#39;s annoying rather than limiting.</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#a4a9671b1264d53cb74469e78000e2544">is_blind</a>() ||</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        ( ( who.<a class="code hl_function" href="classCreature.html#a6fb79df9315dc2bed6f34d9a2e37da90">has_effect</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a468a4ea99d05230e46c7e014a68270a7">effect_boomered</a> ) || who.<a class="code hl_function" href="classCreature.html#a6fb79df9315dc2bed6f34d9a2e37da90">has_effect</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a84bed2f340b7b3bf9a0ae0c95eabc6dc">effect_darkness</a> ) ) &amp;&amp;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>          !who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#ac54117dbd505336cc0e980684cf77774">trait_PER_SLIME_OK</a> ) ) ) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <span class="keywordflow">return</span> 11.0;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    }</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="comment">// Scale linearly as light level approaches LIGHT_AMBIENT_LIT.</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="comment">// If we&#39;re actually a source of light, assume we can direct it where we need it.</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="comment">// Therefore give a hefty bonus relative to ambient light.</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <span class="keywordtype">float</span> own_light = std::max( 1.0f, <a class="code hl_variable" href="lightmap_8h.html#aee8c4bc593d2863e405cd21438a01f44">LIGHT_AMBIENT_LIT</a> - who.<a class="code hl_function" href="classCharacter.html#a4db8f0b7490ded5bd598b640fdbed978">active_light</a>() - 2.0f );</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="comment">// Same calculation as above, but with a result 3 lower.</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="keywordtype">float</span> ambient_light = std::max( 1.0f, <a class="code hl_variable" href="lightmap_8h.html#aee8c4bc593d2863e405cd21438a01f44">LIGHT_AMBIENT_LIT</a> - <a class="code hl_function" href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a>().ambient_light_at( p ) + 1.0f );</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    <span class="keywordflow">return</span> std::min( own_light, ambient_light );</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>}</div>
<div class="ttc" id="acharacter__functions_8cpp_html_a468a4ea99d05230e46c7e014a68270a7"><div class="ttname"><a href="character__functions_8cpp.html#a468a4ea99d05230e46c7e014a68270a7">effect_boomered</a></div><div class="ttdeci">static const efftype_id effect_boomered(&quot;boomered&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a84bed2f340b7b3bf9a0ae0c95eabc6dc"><div class="ttname"><a href="character__functions_8cpp.html#a84bed2f340b7b3bf9a0ae0c95eabc6dc">effect_darkness</a></div><div class="ttdeci">static const efftype_id effect_darkness(&quot;darkness&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_ac54117dbd505336cc0e980684cf77774"><div class="ttname"><a href="character__functions_8cpp.html#ac54117dbd505336cc0e980684cf77774">trait_PER_SLIME_OK</a></div><div class="ttdeci">static const trait_id trait_PER_SLIME_OK(&quot;PER_SLIME_OK&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a4a9671b1264d53cb74469e78000e2544"><div class="ttname"><a href="classCharacter.html#a4a9671b1264d53cb74469e78000e2544">Character::is_blind</a></div><div class="ttdeci">bool is_blind() const</div><div class="ttdoc">Returns true if the player isn't able to see.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l06237">character.cpp:6237</a></div></div>
<div class="ttc" id="aclassCharacter_html_a4db8f0b7490ded5bd598b640fdbed978"><div class="ttname"><a href="classCharacter.html#a4db8f0b7490ded5bd598b640fdbed978">Character::active_light</a></div><div class="ttdeci">float active_light() const</div><div class="ttdoc">Returns character luminosity based on the brightest active item they are carrying.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l06272">character.cpp:6272</a></div></div>
<div class="ttc" id="alightmap_8h_html_aee8c4bc593d2863e405cd21438a01f44"><div class="ttname"><a href="lightmap_8h.html#aee8c4bc593d2863e405cd21438a01f44">LIGHT_AMBIENT_LIT</a></div><div class="ttdeci">static constexpr float LIGHT_AMBIENT_LIT</div><div class="ttdef"><b>Definition:</b> <a href="lightmap_8h_source.html#l00018">lightmap.h:18</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character_8cpp_source.html#l06272">Character::active_light()</a>, <a class="el" href="character__functions_8cpp.html#a468a4ea99d05230e46c7e014a68270a7">effect_boomered</a>, <a class="el" href="character__functions_8cpp.html#a84bed2f340b7b3bf9a0ae0c95eabc6dc">effect_darkness</a>, <a class="el" href="map_8cpp_source.html#l00146">get_map()</a>, <a class="el" href="creature_8cpp_source.html#l01185">Creature::has_effect()</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="character_8cpp_source.html#l06237">Character::is_blind()</a>, <a class="el" href="lightmap_8h_source.html#l00018">LIGHT_AMBIENT_LIT</a>, and <a class="el" href="character__functions_8cpp.html#ac54117dbd505336cc0e980684cf77774">trait_PER_SLIME_OK</a>.</p>

</div>
</div>
<a id="a6c63f47142d40af0092a1be132a53efa" name="a6c63f47142d40af0092a1be132a53efa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c63f47142d40af0092a1be132a53efa">&#9670;&nbsp;</a></span>fmt_wielded_weapon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string character_funcs::fmt_wielded_weapon </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the formatted name of the currently wielded item (if any) with current gun mode (if gun) </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00410">410</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>{</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    <span class="keywordflow">if</span>( !who.<a class="code hl_function" href="classCharacter.html#ad79464264cb8a2061f5888d092f5cd86">is_armed</a>() ) {</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;fists&quot;</span> );</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    }</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> &amp;weapon = who.<a class="code hl_variable" href="classCharacter.html#ae68b7a6565646ba662e448bded8b6599">weapon</a>;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <span class="keywordflow">if</span>( weapon.<a class="code hl_function" href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">is_gun</a>() ) {</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        std::string str = <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;(%d) [%s] %s&quot;</span>, weapon.<a class="code hl_function" href="classitem.html#a26c025fd4909bd31c8e91ed87905507b">ammo_remaining</a>(),</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                                         weapon.<a class="code hl_function" href="classitem.html#a1a94ea108d695febf7f2bcf090f097fa">gun_current_mode</a>().<a class="code hl_function" href="classgun__mode.html#a583a586a605731dbd36af20553c0e51d">tname</a>(), weapon.<a class="code hl_function" href="classitem.html#a70359b9e831ed97023891631058595b6">type_name</a>() );</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>        <span class="comment">// Is either the base item or at least one auxiliary gunmod loaded (includes empty magazines)</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>        <span class="keywordtype">bool</span> base = weapon.<a class="code hl_function" href="classitem.html#a5d89f04a2a08245ec865db0865e8a6c1">ammo_capacity</a>() &gt; 0 &amp;&amp; !weapon.<a class="code hl_function" href="classitem.html#aaa5aeb6f838927babb10ede535cf2a73">has_flag</a>( <span class="stringliteral">&quot;RELOAD_AND_SHOOT&quot;</span> );</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span> </div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        <span class="keyword">const</span> <span class="keyword">auto</span> mods = weapon.<a class="code hl_function" href="classitem.html#acd78321ba4d5c09d39f1d58d20b68484">gunmods</a>();</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <span class="keywordtype">bool</span> aux = std::any_of( mods.begin(), mods.end(), [&amp;]( <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> * e ) {</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>            return e-&gt;is_gun() &amp;&amp; e-&gt;ammo_capacity() &gt; 0 &amp;&amp; !e-&gt;has_flag( <span class="stringliteral">&quot;RELOAD_AND_SHOOT&quot;</span> );</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        } );</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        <span class="keywordflow">if</span>( base || aux ) {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>            <span class="keywordflow">for</span>( <span class="keyword">auto</span> e : mods ) {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                <span class="keywordflow">if</span>( e-&gt;is_gun() &amp;&amp; e-&gt;ammo_capacity() &gt; 0 &amp;&amp; !e-&gt;has_flag( <span class="stringliteral">&quot;RELOAD_AND_SHOOT&quot;</span> ) ) {</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>                    str += <span class="stringliteral">&quot; (&quot;</span> + <a class="code hl_function" href="calendar_8cpp.html#aeb989652ea2bf7fd03b07a74fd30bd7a">std::to_string</a>( e-&gt;ammo_remaining() );</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>                    <span class="keywordflow">if</span>( e-&gt;magazine_integral() ) {</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                        str += <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_function" href="calendar_8cpp.html#aeb989652ea2bf7fd03b07a74fd30bd7a">std::to_string</a>( e-&gt;ammo_capacity() );</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>                    }</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                    str += <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>            }</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        }</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>        <span class="keywordflow">return</span> str;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( weapon.<a class="code hl_function" href="classitem.html#a723753bab4cc789e3ec186846c9916a3">is_container</a>() &amp;&amp; weapon.<a class="code hl_variable" href="classitem.html#a4afe851abb42cbff0857065860f96e0e">contents</a>.<a class="code hl_function" href="classitem__contents.html#aa744f662499b0a03029ea58389cc260a">num_item_stacks</a>() == 1 ) {</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s (%d)&quot;</span>, weapon.<a class="code hl_function" href="classitem.html#a7e78e26dcf9b357cda769c3ca2938eda">tname</a>(),</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>                              weapon.<a class="code hl_variable" href="classitem.html#a4afe851abb42cbff0857065860f96e0e">contents</a>.<a class="code hl_function" href="classitem__contents.html#a14299e40ca1440af11623c86e0b84072">front</a>().<a class="code hl_variable" href="classitem.html#a6bfb92ab5d41e0eb3a1da160fac71b0e">charges</a> );</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span> </div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        <span class="keywordflow">return</span> weapon.<a class="code hl_function" href="classitem.html#a7e78e26dcf9b357cda769c3ca2938eda">tname</a>();</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    }</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>}</div>
<div class="ttc" id="acalendar_8cpp_html_aeb989652ea2bf7fd03b07a74fd30bd7a"><div class="ttname"><a href="calendar_8cpp.html#aeb989652ea2bf7fd03b07a74fd30bd7a">to_string</a></div><div class="ttdeci">std::string to_string(const time_duration &amp;d)</div><div class="ttdoc">Returns a string showing a duration.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00327">calendar.cpp:327</a></div></div>
<div class="ttc" id="aclassCharacter_html_ad79464264cb8a2061f5888d092f5cd86"><div class="ttname"><a href="classCharacter.html#ad79464264cb8a2061f5888d092f5cd86">Character::is_armed</a></div><div class="ttdeci">bool is_armed() const</div><div class="ttdoc">Returns true if the character is wielding something.</div><div class="ttdef"><b>Definition:</b> <a href="melee_8cpp_source.html#l00148">melee.cpp:148</a></div></div>
<div class="ttc" id="aclassCharacter_html_ae68b7a6565646ba662e448bded8b6599"><div class="ttname"><a href="classCharacter.html#ae68b7a6565646ba662e448bded8b6599">Character::weapon</a></div><div class="ttdeci">item weapon</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01546">character.h:1546</a></div></div>
<div class="ttc" id="aclassgun__mode_html_a583a586a605731dbd36af20553c0e51d"><div class="ttname"><a href="classgun__mode.html#a583a586a605731dbd36af20553c0e51d">gun_mode::tname</a></div><div class="ttdeci">std::string tname() const</div><div class="ttdef"><b>Definition:</b> <a href="gun__mode_8h_source.html#l00059">gun_mode.h:59</a></div></div>
<div class="ttc" id="aclassitem__contents_html_aa744f662499b0a03029ea58389cc260a"><div class="ttname"><a href="classitem__contents.html#aa744f662499b0a03029ea58389cc260a">item_contents::num_item_stacks</a></div><div class="ttdeci">size_t num_item_stacks() const</div><div class="ttdoc">returns the number of items stacks in contents each item that is not count_by_charges,...</div><div class="ttdef"><b>Definition:</b> <a href="item__contents_8cpp_source.html#l00027">item_contents.cpp:27</a></div></div>
<div class="ttc" id="aclassitem_html_a1a94ea108d695febf7f2bcf090f097fa"><div class="ttname"><a href="classitem.html#a1a94ea108d695febf7f2bcf090f097fa">item::gun_current_mode</a></div><div class="ttdeci">gun_mode gun_current_mode() const</div><div class="ttdoc">Get the current mode for this gun (or an invalid mode if item is not a gun)</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07893">item.cpp:7893</a></div></div>
<div class="ttc" id="aclassitem_html_a5d89f04a2a08245ec865db0865e8a6c1"><div class="ttname"><a href="classitem.html#a5d89f04a2a08245ec865db0865e8a6c1">item::ammo_capacity</a></div><div class="ttdeci">int ammo_capacity() const</div><div class="ttdoc">Maximum quantity of ammunition loadable for tool, gun or auxiliary gunmod.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07409">item.cpp:7409</a></div></div>
<div class="ttc" id="aclassitem_html_a6bfb92ab5d41e0eb3a1da160fac71b0e"><div class="ttname"><a href="classitem.html#a6bfb92ab5d41e0eb3a1da160fac71b0e">item::charges</a></div><div class="ttdeci">int charges</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l02196">item.h:2196</a></div></div>
<div class="ttc" id="aclassitem_html_a70359b9e831ed97023891631058595b6"><div class="ttname"><a href="classitem.html#a70359b9e831ed97023891631058595b6">item::type_name</a></div><div class="ttdeci">std::string type_name(unsigned int quantity=1) const</div><div class="ttdoc">Name of the item type (not the item), with proper plural.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09846">item.cpp:9846</a></div></div>
<div class="ttc" id="aclassitem_html_a7e78e26dcf9b357cda769c3ca2938eda"><div class="ttname"><a href="classitem.html#a7e78e26dcf9b357cda769c3ca2938eda">item::tname</a></div><div class="ttdeci">std::string tname(unsigned int quantity=1, bool with_prefix=true, unsigned int truncate=0) const</div><div class="ttdoc">Return the (translated) item name.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l04554">item.cpp:4554</a></div></div>
<div class="ttc" id="aclassitem_html_acd78321ba4d5c09d39f1d58d20b68484"><div class="ttname"><a href="classitem.html#acd78321ba4d5c09d39f1d58d20b68484">item::gunmods</a></div><div class="ttdeci">std::vector&lt; item * &gt; gunmods()</div><div class="ttdoc">Returns all gunmods currently attached to this item (always empty if item not a gun)</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07735">item.cpp:7735</a></div></div>
<div class="ttc" id="astring__formatter_8h_html_a8964099387da2f95396c67566bafce3d"><div class="ttname"><a href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a></div><div class="ttdeci">std::string string_format(std::string_view format, Args &amp;&amp;...args)</div><div class="ttdoc">Simple wrapper over string_formatter::parse.</div><div class="ttdef"><b>Definition:</b> <a href="string__formatter_8h_source.html#l00431">string_formatter.h:431</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="item_8cpp_source.html#l07409">item::ammo_capacity()</a>, <a class="el" href="item_8cpp_source.html#l07382">item::ammo_remaining()</a>, <a class="el" href="item_8h_source.html#l02196">item::charges</a>, <a class="el" href="item_8h_source.html#l02158">item::contents</a>, <a class="el" href="item__contents_8cpp_source.html#l00190">item_contents::front()</a>, <a class="el" href="item_8cpp_source.html#l07893">item::gun_current_mode()</a>, <a class="el" href="item_8cpp_source.html#l07735">item::gunmods()</a>, <a class="el" href="item_8cpp_source.html#l05303">item::has_flag()</a>, <a class="el" href="melee_8cpp_source.html#l00148">Character::is_armed()</a>, <a class="el" href="item_8cpp_source.html#l06719">item::is_container()</a>, <a class="el" href="item_8cpp_source.html#l06517">item::is_gun()</a>, <a class="el" href="item_8cpp_source.html#l07660">item::magazine_integral()</a>, <a class="el" href="item__contents_8cpp_source.html#l00027">item_contents::num_item_stacks()</a>, <a class="el" href="string__formatter_8h_source.html#l00431">string_format()</a>, <a class="el" href="gun__mode_8h_source.html#l00059">gun_mode::tname()</a>, <a class="el" href="item_8cpp_source.html#l04554">item::tname()</a>, <a class="el" href="calendar_8cpp_source.html#l00327">to_string()</a>, <a class="el" href="item_8cpp_source.html#l09846">item::type_name()</a>, and <a class="el" href="character_8h_source.html#l01546">Character::weapon</a>.</p>

<p class="reference">Referenced by <a class="el" href="character_8cpp_source.html#l03056">Character::can_wield()</a>, <a class="el" href="panels_8cpp_source.html#l01497">draw_env_compact()</a>, <a class="el" href="panels_8cpp_source.html#l01883">draw_weapon_classic()</a>, <a class="el" href="panels_8cpp_source.html#l01903">draw_weapon_classic_alt()</a>, and <a class="el" href="panels_8cpp_source.html#l01383">draw_weapon_labels()</a>.</p>

</div>
</div>
<a id="a67879d31b9151a69132475569b1de783" name="a67879d31b9151a69132475569b1de783"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67879d31b9151a69132475569b1de783">&#9670;&nbsp;</a></span>get_ammo_items()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; const <a class="el" href="classitem.html">item</a> * &gt; character_funcs::get_ammo_items </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a4a240e1107e45f10d64b78f1b5f58d59">ammotype</a> &amp;&#160;</td>
          <td class="paramname"><em>at</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns character's items that are ammo and have the matching ammo type. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l01043">1043</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>{</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>    <span class="keywordflow">return</span> who.<a class="code hl_function" href="classvisitable.html#a5b3c37fbe8209cab68aa26d3cc7f4300">items_with</a>( [at]( <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> &amp; it ) {</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>        <span class="keywordflow">return</span> it.<a class="code hl_function" href="classitem.html#aab4f4feeb64f169f408c24d03e0ce61f">ammo_type</a>() == at;</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    } );</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>}</div>
<div class="ttc" id="aclassvisitable_html_a5b3c37fbe8209cab68aa26d3cc7f4300"><div class="ttname"><a href="classvisitable.html#a5b3c37fbe8209cab68aa26d3cc7f4300">visitable::items_with</a></div><div class="ttdeci">std::vector&lt; item * &gt; items_with(const std::function&lt; bool(const item &amp;)&gt; &amp;filter)</div><div class="ttdoc">Returns all items (including those within a container) matching the filter.</div><div class="ttdef"><b>Definition:</b> <a href="visitable_8cpp_source.html#l00324">visitable.cpp:324</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="item_8cpp_source.html#l07588">item::ammo_type()</a>, and <a class="el" href="visitable_8cpp_source.html#l00324">visitable&lt; T &gt;::items_with()</a>.</p>

<p class="reference">Referenced by <a class="el" href="item_8cpp_source.html#l04132">item::color_in_inventory()</a>, and <a class="el" href="npc_8cpp_source.html#l01494">npc::decide_needs()</a>.</p>

</div>
</div>
<a id="aaa9f2cc376f03128e0a486a90c7376fa" name="aaa9f2cc376f03128e0a486a90c7376fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa9f2cc376f03128e0a486a90c7376fa">&#9670;&nbsp;</a></span>get_book_fun_for()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int character_funcs::get_book_fun_for </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>book</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns enjoyability value of a book for given character. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00117">117</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>{</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="keywordtype">int</span> fun_bonus = book.<a class="code hl_variable" href="classitem.html#ac1d2c4c33b8a499812f3437cb2fad742">type</a>-&gt;<a class="code hl_variable" href="structitype.html#aec04d23e907e3ea3cd9cfb08369dffcd">book</a>-&gt;fun;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="keywordflow">if</span>( !book.<a class="code hl_function" href="classitem.html#a980b9e48afd103973a201fc487d0af8b">is_book</a>() ) {</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        <a class="code hl_define" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;called avatar::book_fun_for with non-book&quot;</span> );</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    }</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <span class="comment">// If you don&#39;t have a problem with eating humans, To Serve Man becomes rewarding</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="keywordflow">if</span>( ( ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#af1a3e5c07ef96be118895afd086ba143">trait_CANNIBAL</a> ) ||</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>          ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a9bbf692360c0fe96f9fccf41db5756be">trait_PSYCHOPATH</a> ) ||</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>          ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a93f31d20e997d966be8b81d64c31582b">trait_SAPIOVORE</a> ) ) &amp;&amp;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        book.<a class="code hl_function" href="classitem.html#aa79dad64e1ef6347219be2f8666e2752">typeId</a>() == <a class="code hl_variable" href="character__functions_8cpp.html#aba728ba1b648f6ef568b96fbe1cd74fb">itype_cookbook_human</a> ) {</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        fun_bonus = std::abs( fun_bonus );</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#abf47c050c3a01d3496c3eb251fa9c517">trait_SPIRITUAL</a> ) &amp;&amp; book.<a class="code hl_function" href="classitem.html#aaa5aeb6f838927babb10ede535cf2a73">has_flag</a>( <span class="stringliteral">&quot;INSPIRATIONAL&quot;</span> ) ) {</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>        fun_bonus = std::abs( fun_bonus * 3 );</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    }</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="keywordflow">if</span>( ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a8af31c1a565772726aba73e25a4b6df6">trait_LOVES_BOOKS</a> ) ) {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        fun_bonus++;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    }</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keywordflow">if</span>( fun_bonus &gt; 1 &amp;&amp; book.<a class="code hl_function" href="classitem.html#af607ad36c67593022397b437a3a5b5b4">get_chapters</a>() &gt; 0 &amp;&amp; book.<a class="code hl_function" href="classitem.html#aa96ff544e52ece35ed8755c89b7822c7">get_remaining_chapters</a>( ch ) == 0 ) {</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        fun_bonus /= 2;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    }</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    <span class="keywordflow">return</span> fun_bonus;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>}</div>
<div class="ttc" id="acharacter__functions_8cpp_html_a8af31c1a565772726aba73e25a4b6df6"><div class="ttname"><a href="character__functions_8cpp.html#a8af31c1a565772726aba73e25a4b6df6">trait_LOVES_BOOKS</a></div><div class="ttdeci">static const trait_id trait_LOVES_BOOKS(&quot;LOVES_BOOKS&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a93f31d20e997d966be8b81d64c31582b"><div class="ttname"><a href="character__functions_8cpp.html#a93f31d20e997d966be8b81d64c31582b">trait_SAPIOVORE</a></div><div class="ttdeci">static const trait_id trait_SAPIOVORE(&quot;SAPIOVORE&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a9bbf692360c0fe96f9fccf41db5756be"><div class="ttname"><a href="character__functions_8cpp.html#a9bbf692360c0fe96f9fccf41db5756be">trait_PSYCHOPATH</a></div><div class="ttdeci">static const trait_id trait_PSYCHOPATH(&quot;PSYCHOPATH&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_aba728ba1b648f6ef568b96fbe1cd74fb"><div class="ttname"><a href="character__functions_8cpp.html#aba728ba1b648f6ef568b96fbe1cd74fb">itype_cookbook_human</a></div><div class="ttdeci">static const itype_id itype_cookbook_human(&quot;cookbook_human&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_abf47c050c3a01d3496c3eb251fa9c517"><div class="ttname"><a href="character__functions_8cpp.html#abf47c050c3a01d3496c3eb251fa9c517">trait_SPIRITUAL</a></div><div class="ttdeci">static const trait_id trait_SPIRITUAL(&quot;SPIRITUAL&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_af1a3e5c07ef96be118895afd086ba143"><div class="ttname"><a href="character__functions_8cpp.html#af1a3e5c07ef96be118895afd086ba143">trait_CANNIBAL</a></div><div class="ttdeci">static const trait_id trait_CANNIBAL(&quot;CANNIBAL&quot;)</div></div>
<div class="ttc" id="aclassitem_html_a980b9e48afd103973a201fc487d0af8b"><div class="ttname"><a href="classitem.html#a980b9e48afd103973a201fc487d0af8b">item::is_book</a></div><div class="ttdeci">bool is_book() const</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06709">item.cpp:6709</a></div></div>
<div class="ttc" id="aclassitem_html_aa96ff544e52ece35ed8755c89b7822c7"><div class="ttname"><a href="classitem.html#aa96ff544e52ece35ed8755c89b7822c7">item::get_remaining_chapters</a></div><div class="ttdeci">int get_remaining_chapters(const Character &amp;ch) const</div><div class="ttdoc">Get the number of unread chapters.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07092">item.cpp:7092</a></div></div>
<div class="ttc" id="aclassitem_html_ac1d2c4c33b8a499812f3437cb2fad742"><div class="ttname"><a href="classitem.html#ac1d2c4c33b8a499812f3437cb2fad742">item::type</a></div><div class="ttdeci">const itype * type</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l02157">item.h:2157</a></div></div>
<div class="ttc" id="aclassitem_html_af607ad36c67593022397b437a3a5b5b4"><div class="ttname"><a href="classitem.html#af607ad36c67593022397b437a3a5b5b4">item::get_chapters</a></div><div class="ttdeci">int get_chapters() const</div><div class="ttdoc">How many chapters the book has (if any).</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07084">item.cpp:7084</a></div></div>
<div class="ttc" id="adebug_8h_html_a87e509562277a7ada3a75330d00cb445"><div class="ttname"><a href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a></div><div class="ttdeci">#define debugmsg(...)</div><div class="ttdoc">Debug message of level DL::Error and class DC::DebugMsg, also includes the source file name and line,...</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00074">debug.h:74</a></div></div>
<div class="ttc" id="astructitype_html_aec04d23e907e3ea3cd9cfb08369dffcd"><div class="ttname"><a href="structitype.html#aec04d23e907e3ea3cd9cfb08369dffcd">itype::book</a></div><div class="ttdeci">cata::value_ptr&lt; islot_book &gt; book</div><div class="ttdef"><b>Definition:</b> <a href="itype_8h_source.html#l00854">itype.h:854</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="itype_8h_source.html#l00854">itype::book</a>, <a class="el" href="debug_8h_source.html#l00074">debugmsg</a>, <a class="el" href="item_8cpp_source.html#l07084">item::get_chapters()</a>, <a class="el" href="item_8cpp_source.html#l07092">item::get_remaining_chapters()</a>, <a class="el" href="item_8cpp_source.html#l05303">item::has_flag()</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="item_8cpp_source.html#l06709">item::is_book()</a>, <a class="el" href="character__functions_8cpp.html#aba728ba1b648f6ef568b96fbe1cd74fb">itype_cookbook_human</a>, <a class="el" href="character__functions_8cpp.html#af1a3e5c07ef96be118895afd086ba143">trait_CANNIBAL</a>, <a class="el" href="character__functions_8cpp.html#a8af31c1a565772726aba73e25a4b6df6">trait_LOVES_BOOKS</a>, <a class="el" href="character__functions_8cpp.html#a9bbf692360c0fe96f9fccf41db5756be">trait_PSYCHOPATH</a>, <a class="el" href="character__functions_8cpp.html#a93f31d20e997d966be8b81d64c31582b">trait_SAPIOVORE</a>, <a class="el" href="character__functions_8cpp.html#abf47c050c3a01d3496c3eb251fa9c517">trait_SPIRITUAL</a>, <a class="el" href="item_8h_source.html#l02157">item::type</a>, and <a class="el" href="item_8cpp_source.html#l08353">item::typeId()</a>.</p>

<p class="reference">Referenced by <a class="el" href="item_8cpp_source.html#l02897">item::book_info()</a>, <a class="el" href="avatar_8cpp_source.html#l00742">avatar::do_read()</a>, <a class="el" href="npc_8cpp_source.html#l00905">npc::finish_read()</a>, <a class="el" href="character__functions_8cpp_source.html#l00103">is_fun_to_read()</a>, <a class="el" href="avatar_8cpp_source.html#l00387">avatar::read()</a>, <a class="el" href="game__inventory_8cpp_source.html#l00979">read_inventory_preset::read_inventory_preset()</a>, and <a class="el" href="avatar_8cpp_source.html#l00677">skim_book_msg()</a>.</p>

</div>
</div>
<a id="a1841dddaff2b8469caeb0fb5a2e161e8" name="a1841dddaff2b8469caeb0fb5a2e161e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1841dddaff2b8469caeb0fb5a2e161e8">&#9670;&nbsp;</a></span>get_crafting_helpers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classnpc.html">npc</a> * &gt; character_funcs::get_crafting_helpers </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns nearby NPCs ready and willing to help with crafting or some other manual task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> to be assited </td></tr>
    <tr><td class="paramname">max</td><td>If set, limits number of helpers to that value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00654">654</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>{</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>    <span class="keywordflow">if</span>( max == 0 || !who.<a class="code hl_function" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>        <span class="comment">// TODO: NPCs assisting other NPCs</span></div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>        <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>    }</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>    <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;get_npcs_if( [&amp;]( <span class="keyword">const</span> <a class="code hl_class" href="classnpc.html">npc</a> &amp; guy ) {</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        <span class="comment">// NPCs can help craft if awake, taking orders, within pickup range and have clear path</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        <span class="keywordflow">if</span>( max &gt; 0 &amp;&amp; n &gt;= max ) {</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>        }</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        <span class="keywordtype">bool</span> <a class="code hl_enumvalue" href="vehicle_8h.html#a120e32a2f241b5f666c5189a2f405eeaa444bcb3a3fcf8389296c49467f27e1d6">ok</a> = !guy.<a class="code hl_function" href="classCharacter.html#a4f0bdbd929787a486a0dd5748ef10c65">in_sleep_state</a>() &amp;&amp; guy.<a class="code hl_function" href="classnpc.html#a1a34cf48d162fbed83aab3370d55d114">is_obeying</a>( who ) &amp;&amp;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>                  <a class="code hl_function" href="coordinates_8h.html#a47953b33a873caa0861b12222842a5ec">rl_dist</a>( guy.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() ) &lt; <a class="code hl_variable" href="cached__options_8cpp.html#a1467e25ae6a1c8f9d4489be4a8e014a3">PICKUP_RANGE</a> &amp;&amp;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>                  <a class="code hl_function" href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a>().clear_path( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), guy.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), <a class="code hl_variable" href="cached__options_8cpp.html#a1467e25ae6a1c8f9d4489be4a8e014a3">PICKUP_RANGE</a>, 1, 100 );</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>        <span class="keywordflow">if</span>( ok ) {</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>            n += 1;</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>        }</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        <span class="keywordflow">return</span> ok;</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    } );</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>}</div>
<div class="ttc" id="acached__options_8cpp_html_a1467e25ae6a1c8f9d4489be4a8e014a3"><div class="ttname"><a href="cached__options_8cpp.html#a1467e25ae6a1c8f9d4489be4a8e014a3">PICKUP_RANGE</a></div><div class="ttdeci">int PICKUP_RANGE</div><div class="ttdoc">Items on the map with at most this distance to the player are considered available for crafting,...</div><div class="ttdef"><b>Definition:</b> <a href="cached__options_8cpp_source.html#l00019">cached_options.cpp:19</a></div></div>
<div class="ttc" id="aclassCharacter_html_a4f0bdbd929787a486a0dd5748ef10c65"><div class="ttname"><a href="classCharacter.html#a4f0bdbd929787a486a0dd5748ef10c65">Character::in_sleep_state</a></div><div class="ttdeci">bool in_sleep_state() const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l09276">character.cpp:9276</a></div></div>
<div class="ttc" id="aclassCreature_html_ac209d32cbfd3774af3d5c0500e2fae52"><div class="ttname"><a href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">Creature::is_avatar</a></div><div class="ttdeci">virtual bool is_avatar() const</div><div class="ttdef"><b>Definition:</b> <a href="creature_8h_source.html#l00095">creature.h:95</a></div></div>
<div class="ttc" id="aclassnpc_html"><div class="ttname"><a href="classnpc.html">npc</a></div><div class="ttdef"><b>Definition:</b> <a href="npc_8h_source.html#l00743">npc.h:744</a></div></div>
<div class="ttc" id="aclassnpc_html_a1a34cf48d162fbed83aab3370d55d114"><div class="ttname"><a href="classnpc.html#a1a34cf48d162fbed83aab3370d55d114">npc::is_obeying</a></div><div class="ttdeci">bool is_obeying(const Character &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="npc_8cpp_source.html#l02028">npc.cpp:2028</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a47953b33a873caa0861b12222842a5ec"><div class="ttname"><a href="coordinates_8h.html#a47953b33a873caa0861b12222842a5ec">rl_dist</a></div><div class="ttdeci">int rl_dist(const coords::coord_point&lt; Point, Origin, Scale &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00519">coordinates.h:519</a></div></div>
<div class="ttc" id="agame_8cpp_html_abeb98e93502d73818b4a73fabe191bc1"><div class="ttname"><a href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a></div><div class="ttdeci">std::unique_ptr&lt; game &gt; g</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l00281">game.cpp:281</a></div></div>
<div class="ttc" id="avehicle_8h_html_a120e32a2f241b5f666c5189a2f405eeaa444bcb3a3fcf8389296c49467f27e1d6"><div class="ttname"><a href="vehicle_8h.html#a120e32a2f241b5f666c5189a2f405eeaa444bcb3a3fcf8389296c49467f27e1d6">autodrive_result::ok</a></div><div class="ttdeci">@ ok</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="game_8cpp_source.html#l00281">g</a>, <a class="el" href="map_8cpp_source.html#l00146">get_map()</a>, <a class="el" href="character_8cpp_source.html#l09276">Character::in_sleep_state()</a>, <a class="el" href="creature_8h_source.html#l00095">Creature::is_avatar()</a>, <a class="el" href="npc_8cpp_source.html#l02028">npc::is_obeying()</a>, <a class="el" href="vehicle_8h.html#a120e32a2f241b5f666c5189a2f405eeaa444bcb3a3fcf8389296c49467f27e1d6">ok</a>, <a class="el" href="cached__options_8cpp_source.html#l00019">PICKUP_RANGE</a>, <a class="el" href="character_8cpp_source.html#l00587">Character::pos()</a>, and <a class="el" href="coordinates_8h_source.html#l00519">rl_dist()</a>.</p>

<p class="reference">Referenced by <a class="el" href="construction_8cpp_source.html#l01816">construction::adjusted_time()</a>, <a class="el" href="crafting_8cpp_source.html#l00390">player::available_assistant_count()</a>, <a class="el" href="game_8cpp_source.html#l08271">game::butcher()</a>, <a class="el" href="activity__handlers_8cpp_source.html#l00765">butcher_time_to_cut()</a>, <a class="el" href="crafting_8cpp_source.html#l00531">player::can_make()</a>, <a class="el" href="veh__interact_8cpp_source.html#l01761">veh_interact::can_remove_part()</a>, <a class="el" href="iuse_8cpp_source.html#l04817">iuse::chop_logs()</a>, <a class="el" href="iuse_8cpp_source.html#l04773">iuse::chop_tree()</a>, <a class="el" href="iuse_8cpp_source.html#l02948">iuse::clear_rubble()</a>, <a class="el" href="construction_8cpp_source.html#l01071">complete_construction()</a>, <a class="el" href="crafting_8cpp_source.html#l01017">complete_craft()</a>, <a class="el" href="iuse_8cpp_source.html#l09544">iuse::craft()</a>, <a class="el" href="crafting_8cpp_source.html#l00772">player::craft_skill_gain()</a>, <a class="el" href="crafting_8cpp_source.html#l00818">player::crafting_success_roll()</a>, <a class="el" href="iuse_8cpp_source.html#l02713">iuse::dig()</a>, <a class="el" href="iuse_8cpp_source.html#l02809">iuse::dig_channel()</a>, <a class="el" href="veh__interact_8cpp_source.html#l01850">veh_interact::do_remove()</a>, <a class="el" href="veh__interact_8cpp_source.html#l01178">veh_interact::do_repair()</a>, <a class="el" href="iuse_8cpp_source.html#l02875">iuse::fill_pit()</a>, <a class="el" href="activity__handlers_8cpp_source.html#l04360">activity_handlers::fill_pit_finish()</a>, <a class="el" href="activity__actor_8cpp_source.html#l00415">dig_activity_actor::finish()</a>, <a class="el" href="avatar_8cpp_source.html#l00255">avatar::get_book_reader()</a>, <a class="el" href="character__functions_8cpp_source.html#l00691">get_lift_strength_with_helpers()</a>, <a class="el" href="iuse_8cpp_source.html#l03240">iuse::jackhammer()</a>, <a class="el" href="activity__handlers_8cpp_source.html#l04321">activity_handlers::jackhammer_finish()</a>, <a class="el" href="iuse_8cpp_source.html#l03295">iuse::pickaxe()</a>, <a class="el" href="activity__handlers_8cpp_source.html#l01937">activity_handlers::pickaxe_finish()</a>, <a class="el" href="avatar_8cpp_source.html#l00387">avatar::read()</a>, <a class="el" href="veh__type_8cpp_source.html#l00807">scale_time()</a>, <a class="el" href="crafting__gui_8cpp_source.html#l00163">select_crafting_recipe()</a>, <a class="el" href="veh__interact_8cpp_source.html#l00708">veh_interact::update_part_requirements()</a>, and <a class="el" href="iuse_8cpp_source.html#l09456">wash_items()</a>.</p>

</div>
</div>
<a id="abb9c092872bd448a887024fe5379816d" name="abb9c092872bd448a887024fe5379816d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb9c092872bd448a887024fe5379816d">&#9670;&nbsp;</a></span>get_lift_strength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int character_funcs::get_lift_strength </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns <a class="el" href="classCharacter.html">Character</a> lift strength unassisted by helpers or equipment. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00676">676</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>{</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>    <span class="keywordtype">int</span> str = who.<a class="code hl_function" href="classCharacter.html#a5aba683ccf77cb560a0a932308289bd9">get_str</a>();</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>    <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#ac3d46549b7cdaac1f98991167ad5f1b3">mounted_creature</a> ) {</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        <span class="keyword">auto</span> mons = who.<a class="code hl_variable" href="classCharacter.html#ac3d46549b7cdaac1f98991167ad5f1b3">mounted_creature</a>.get();</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        str = mons-&gt;mech_str_addition() == 0 ? str : mons-&gt;mech_str_addition();</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    }</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a43d0000ecfea04c5ba1a7f8f0ce3a9c7">trait_STRONGBACK</a> ) ) {</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        str *= 1.35;</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#aac9d4371c01814dd00f362496829a7f9">trait_BADBACK</a> ) ) {</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        str /= 1.35;</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    }</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <span class="keywordflow">return</span> str;</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>}</div>
<div class="ttc" id="acharacter__functions_8cpp_html_a43d0000ecfea04c5ba1a7f8f0ce3a9c7"><div class="ttname"><a href="character__functions_8cpp.html#a43d0000ecfea04c5ba1a7f8f0ce3a9c7">trait_STRONGBACK</a></div><div class="ttdeci">static const trait_id trait_STRONGBACK(&quot;STRONGBACK&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_aac9d4371c01814dd00f362496829a7f9"><div class="ttname"><a href="character__functions_8cpp.html#aac9d4371c01814dd00f362496829a7f9">trait_BADBACK</a></div><div class="ttdeci">static const trait_id trait_BADBACK(&quot;BADBACK&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a5aba683ccf77cb560a0a932308289bd9"><div class="ttname"><a href="classCharacter.html#a5aba683ccf77cb560a0a932308289bd9">Character::get_str</a></div><div class="ttdeci">virtual int get_str() const</div><div class="ttdoc">Getters for stats exclusive to characters.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l04052">character.cpp:4052</a></div></div>
<div class="ttc" id="aclassCharacter_html_ac3d46549b7cdaac1f98991167ad5f1b3"><div class="ttname"><a href="classCharacter.html#ac3d46549b7cdaac1f98991167ad5f1b3">Character::mounted_creature</a></div><div class="ttdeci">shared_ptr_fast&lt; monster &gt; mounted_creature</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01581">character.h:1581</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character_8cpp_source.html#l04052">Character::get_str()</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="character_8h_source.html#l01581">Character::mounted_creature</a>, <a class="el" href="character__functions_8cpp.html#aac9d4371c01814dd00f362496829a7f9">trait_BADBACK</a>, and <a class="el" href="character__functions_8cpp.html#a43d0000ecfea04c5ba1a7f8f0ce3a9c7">trait_STRONGBACK</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l00691">get_lift_strength_with_helpers()</a>.</p>

</div>
</div>
<a id="afc55ada93348dbdeea0b7f69151956f5" name="afc55ada93348dbdeea0b7f69151956f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc55ada93348dbdeea0b7f69151956f5">&#9670;&nbsp;</a></span>get_lift_strength_with_helpers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int character_funcs::get_lift_strength_with_helpers </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns <a class="el" href="classCharacter.html">Character</a> lift strength without equipment including bonus from nearby helpers. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00691">691</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>{</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    <span class="keywordtype">int</span> <a class="code hl_enumeration" href="namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a> = <a class="code hl_function" href="namespacecharacter__funcs.html#abb9c092872bd448a887024fe5379816d">get_lift_strength</a>( who );</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="keyword">const</span> std::vector&lt;npc *&gt; helpers = <a class="code hl_function" href="namespacecharacter__funcs.html#a1841dddaff2b8469caeb0fb5a2e161e8">get_crafting_helpers</a>( who );</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_class" href="classnpc.html">npc</a> *np : helpers ) {</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>        <a class="code hl_enumeration" href="namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a> += <a class="code hl_function" href="namespacecharacter__funcs.html#abb9c092872bd448a887024fe5379816d">get_lift_strength</a>( *np );</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    }</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <span class="keywordflow">return</span> <a class="code hl_enumeration" href="namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a>;</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>}</div>
<div class="ttc" id="anamespacecharacter__funcs_html_a1841dddaff2b8469caeb0fb5a2e161e8"><div class="ttname"><a href="namespacecharacter__funcs.html#a1841dddaff2b8469caeb0fb5a2e161e8">character_funcs::get_crafting_helpers</a></div><div class="ttdeci">std::vector&lt; npc * &gt; get_crafting_helpers(const Character &amp;who, int max)</div><div class="ttdoc">Returns nearby NPCs ready and willing to help with crafting or some other manual task.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00654">character_functions.cpp:654</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_abb9c092872bd448a887024fe5379816d"><div class="ttname"><a href="namespacecharacter__funcs.html#abb9c092872bd448a887024fe5379816d">character_funcs::get_lift_strength</a></div><div class="ttdeci">int get_lift_strength(const Character &amp;who)</div><div class="ttdoc">Returns Character lift strength unassisted by helpers or equipment.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00676">character_functions.cpp:676</a></div></div>
<div class="ttc" id="anamespacedetail_1_1digits_html_aad69d2373aa047bdd9e81494bf3da5ae"><div class="ttname"><a href="namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">detail::digits::result</a></div><div class="ttdeci">result</div><div class="ttdef"><b>Definition:</b> <a href="fmtlib__format-inl_8h_source.html#l01626">fmtlib_format-inl.h:1626</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__functions_8cpp_source.html#l00654">get_crafting_helpers()</a>, and <a class="el" href="character__functions_8cpp_source.html#l00676">get_lift_strength()</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l00701">can_lift_with_helpers()</a>.</p>

</div>
</div>
<a id="a399c6dcbda8cc41854ac06749ba45d86" name="a399c6dcbda8cc41854ac06749ba45d86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a399c6dcbda8cc41854ac06749ba45d86">&#9670;&nbsp;</a></span>is_bp_immune_to()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::is_bp_immune_to </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980">body_part</a>&#160;</td>
          <td class="paramname"><em>bp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdamage__unit.html">damage_unit</a>&#160;</td>
          <td class="paramname"><em>dam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if character's body part is immune to given damage. </p>
<p >Note that this refers only to reduction of hp on the body part, it does not account for clothing damage, pain, status effects, etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> to check for </td></tr>
    <tr><td class="paramname">bp</td><td>Body part to perform the check on </td></tr>
    <tr><td class="paramname">dam</td><td>Damage unit to check for </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if given damage can not reduce hp of given body part </dd></dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00637">637</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>{</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a2d57f6248b6cc870fd325d9925e7f9bb">trait_DEBUG_NODMG</a> ) || who.<a class="code hl_function" href="classCharacter.html#a5d6fc1ca9e4da196f54cf96d617e70d1">is_immune_damage</a>( dam.<a class="code hl_variable" href="structdamage__unit.html#a6fb9768fbc374c9c24960cdef9bee2f3">type</a> ) ) {</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>    }</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span> </div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    who.<a class="code hl_function" href="classCharacter.html#ab204a367071ffd6cc1d01ec8010222c5">passive_absorb_hit</a>( <a class="code hl_function" href="bodypart_8cpp.html#ae34a481a7c686b233f2d8c48e43b723a">convert_bp</a>( bp ).<span class="keywordtype">id</span>(), dam );</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> &amp;cloth : who.<a class="code hl_variable" href="classCharacter.html#a4c3defc0d53472077cb7577b30b1605f">worn</a> ) {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        <span class="keywordflow">if</span>( cloth.<a class="code hl_function" href="classitem.html#aae86ed52f17bed14dffddbbc618b8afa">get_coverage</a>() == 100 &amp;&amp; cloth.<a class="code hl_function" href="classitem.html#ad5b753d7b46c55de9a5b66bbc2b14b99">covers</a>( bp ) ) {</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>            cloth.<a class="code hl_function" href="classitem.html#aeeea230778b1342bab82a2920a0c7369">mitigate_damage</a>( dam );</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>        }</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    }</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    <span class="keywordflow">return</span> dam.<a class="code hl_variable" href="structdamage__unit.html#a5937d5d78a6db9efaefb0bf9517377d3">amount</a> &lt;= 0;</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>}</div>
<div class="ttc" id="abodypart_8cpp_html_ae34a481a7c686b233f2d8c48e43b723a"><div class="ttname"><a href="bodypart_8cpp.html#ae34a481a7c686b233f2d8c48e43b723a">convert_bp</a></div><div class="ttdeci">const bodypart_str_id &amp; convert_bp(body_part bp)</div><div class="ttdoc">Returns the new id for old token.</div><div class="ttdef"><b>Definition:</b> <a href="bodypart_8cpp_source.html#l00185">bodypart.cpp:185</a></div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a2d57f6248b6cc870fd325d9925e7f9bb"><div class="ttname"><a href="character__functions_8cpp.html#a2d57f6248b6cc870fd325d9925e7f9bb">trait_DEBUG_NODMG</a></div><div class="ttdeci">static const trait_id trait_DEBUG_NODMG(&quot;DEBUG_NODMG&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a4c3defc0d53472077cb7577b30b1605f"><div class="ttname"><a href="classCharacter.html#a4c3defc0d53472077cb7577b30b1605f">Character::worn</a></div><div class="ttdeci">std::list&lt; item &gt; worn</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01532">character.h:1532</a></div></div>
<div class="ttc" id="aclassCharacter_html_a5d6fc1ca9e4da196f54cf96d617e70d1"><div class="ttname"><a href="classCharacter.html#a5d6fc1ca9e4da196f54cf96d617e70d1">Character::is_immune_damage</a></div><div class="ttdeci">bool is_immune_damage(damage_type) const override</div><div class="ttdoc">Returns true if the player is immune to this kind of damage.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l06113">character.cpp:6113</a></div></div>
<div class="ttc" id="aclassCharacter_html_ab204a367071ffd6cc1d01ec8010222c5"><div class="ttname"><a href="classCharacter.html#ab204a367071ffd6cc1d01ec8010222c5">Character::passive_absorb_hit</a></div><div class="ttdeci">void passive_absorb_hit(const bodypart_id &amp;bp, damage_unit &amp;du) const</div><div class="ttdoc">Check for relevant passive, non-clothing that can absorb damage, and reduce by specified damage unit.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07871">character.cpp:7871</a></div></div>
<div class="ttc" id="aclassitem_html_aae86ed52f17bed14dffddbbc618b8afa"><div class="ttname"><a href="classitem.html#aae86ed52f17bed14dffddbbc618b8afa">item::get_coverage</a></div><div class="ttdeci">int get_coverage() const</div><div class="ttdoc">Returns the relative coverage that this item has when worn.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l05900">item.cpp:5900</a></div></div>
<div class="ttc" id="aclassitem_html_ad5b753d7b46c55de9a5b66bbc2b14b99"><div class="ttname"><a href="classitem.html#ad5b753d7b46c55de9a5b66bbc2b14b99">item::covers</a></div><div class="ttdeci">bool covers(body_part bp) const</div><div class="ttdoc">Whether this item (when worn) covers the given body part.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l00743">item.cpp:743</a></div></div>
<div class="ttc" id="aclassitem_html_aeeea230778b1342bab82a2920a0c7369"><div class="ttname"><a href="classitem.html#aeeea230778b1342bab82a2920a0c7369">item::mitigate_damage</a></div><div class="ttdeci">void mitigate_damage(damage_unit &amp;du) const</div><div class="ttdoc">Assuming that specified du hit the armor, reduce du based on the item's resistance to the damage type...</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06363">item.cpp:6363</a></div></div>
<div class="ttc" id="astructdamage__unit_html_a5937d5d78a6db9efaefb0bf9517377d3"><div class="ttname"><a href="structdamage__unit.html#a5937d5d78a6db9efaefb0bf9517377d3">damage_unit::amount</a></div><div class="ttdeci">float amount</div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00037">damage.h:37</a></div></div>
<div class="ttc" id="astructdamage__unit_html_a6fb9768fbc374c9c24960cdef9bee2f3"><div class="ttname"><a href="structdamage__unit.html#a6fb9768fbc374c9c24960cdef9bee2f3">damage_unit::type</a></div><div class="ttdeci">damage_type type</div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00036">damage.h:36</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="damage_8h_source.html#l00037">damage_unit::amount</a>, <a class="el" href="bodypart_8cpp_source.html#l00185">convert_bp()</a>, <a class="el" href="item_8cpp_source.html#l00743">item::covers()</a>, <a class="el" href="item_8cpp_source.html#l05900">item::get_coverage()</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="character_8cpp_source.html#l06113">Character::is_immune_damage()</a>, <a class="el" href="item_8cpp_source.html#l06363">item::mitigate_damage()</a>, <a class="el" href="character_8cpp_source.html#l07871">Character::passive_absorb_hit()</a>, <a class="el" href="character__functions_8cpp.html#a2d57f6248b6cc870fd325d9925e7f9bb">trait_DEBUG_NODMG</a>, <a class="el" href="damage_8h_source.html#l00036">damage_unit::type</a>, and <a class="el" href="character_8h_source.html#l01532">Character::worn</a>.</p>

<p class="reference">Referenced by <a class="el" href="game_8cpp_source.html#l08679">game::get_dangerous_tile()</a>.</p>

</div>
</div>
<a id="a862df11441bba358b82fa47ce88ebe85" name="a862df11441bba358b82fa47ce88ebe85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a862df11441bba358b82fa47ce88ebe85">&#9670;&nbsp;</a></span>is_fun_to_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::is_fun_to_read </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>book</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns whether character considers it fun to read the book. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00103">103</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>{</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="comment">// If you don&#39;t have a problem with eating humans, To Serve Man becomes rewarding</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    <span class="keywordflow">if</span>( ( ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#af1a3e5c07ef96be118895afd086ba143">trait_CANNIBAL</a> ) || ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a9bbf692360c0fe96f9fccf41db5756be">trait_PSYCHOPATH</a> ) ||</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>          ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a93f31d20e997d966be8b81d64c31582b">trait_SAPIOVORE</a> ) ) &amp;&amp;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>        book.<a class="code hl_function" href="classitem.html#aa79dad64e1ef6347219be2f8666e2752">typeId</a>() == <a class="code hl_variable" href="character__functions_8cpp.html#aba728ba1b648f6ef568b96fbe1cd74fb">itype_cookbook_human</a> ) {</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ch.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#abf47c050c3a01d3496c3eb251fa9c517">trait_SPIRITUAL</a> ) &amp;&amp; book.<a class="code hl_function" href="classitem.html#aaa5aeb6f838927babb10ede535cf2a73">has_flag</a>( <span class="stringliteral">&quot;INSPIRATIONAL&quot;</span> ) ) {</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecharacter__funcs.html#aaa9f2cc376f03128e0a486a90c7376fa">get_book_fun_for</a>( ch, book ) &gt; 0;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    }</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>}</div>
<div class="ttc" id="anamespacecharacter__funcs_html_aaa9f2cc376f03128e0a486a90c7376fa"><div class="ttname"><a href="namespacecharacter__funcs.html#aaa9f2cc376f03128e0a486a90c7376fa">character_funcs::get_book_fun_for</a></div><div class="ttdeci">int get_book_fun_for(const Character &amp;ch, const item &amp;book)</div><div class="ttdoc">Returns enjoyability value of a book for given character.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00117">character_functions.cpp:117</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__functions_8cpp_source.html#l00117">get_book_fun_for()</a>, <a class="el" href="item_8cpp_source.html#l05303">item::has_flag()</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="character__functions_8cpp.html#aba728ba1b648f6ef568b96fbe1cd74fb">itype_cookbook_human</a>, <a class="el" href="character__functions_8cpp.html#af1a3e5c07ef96be118895afd086ba143">trait_CANNIBAL</a>, <a class="el" href="character__functions_8cpp.html#a9bbf692360c0fe96f9fccf41db5756be">trait_PSYCHOPATH</a>, <a class="el" href="character__functions_8cpp.html#a93f31d20e997d966be8b81d64c31582b">trait_SAPIOVORE</a>, <a class="el" href="character__functions_8cpp.html#abf47c050c3a01d3496c3eb251fa9c517">trait_SPIRITUAL</a>, and <a class="el" href="item_8cpp_source.html#l08353">item::typeId()</a>.</p>

<p class="reference">Referenced by <a class="el" href="avatar_8cpp_source.html#l00255">avatar::get_book_reader()</a>, <a class="el" href="avatar_8cpp_source.html#l00387">avatar::read()</a>, <a class="el" href="npc_8cpp_source.html#l00883">npc::time_to_read()</a>, and <a class="el" href="avatar_8cpp_source.html#l00345">avatar::time_to_read()</a>.</p>

</div>
</div>
<a id="ae7bfa36ae343bba14f1630cc9350f2d9" name="ae7bfa36ae343bba14f1630cc9350f2d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7bfa36ae343bba14f1630cc9350f2d9">&#9670;&nbsp;</a></span>list_ammo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::list_ammo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classitem__reload__option.html">item_reload_option</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ammo_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>include_empty_mags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>include_potential</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List ammo suitable for given item. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> who looks for ammo </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">base</td><td>Item to select ammo for </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ammo_list</td><td>Output </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">include_empty_mags</td><td>Whether to include empty magazines </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">include_potential</td><td>Include ammo that can potentially be used, but not right now </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00706">706</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>{</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    <span class="keyword">auto</span> opts = base.<a class="code hl_function" href="classitem.html#acd78321ba4d5c09d39f1d58d20b68484">gunmods</a>();</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>    opts.push_back( &amp;base );</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <span class="keywordflow">if</span>( base.<a class="code hl_function" href="classitem.html#ab22fc9a4e0f9c6f5569b93e00deccfac">magazine_current</a>() ) {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        opts.push_back( base.<a class="code hl_function" href="classitem.html#ab22fc9a4e0f9c6f5569b93e00deccfac">magazine_current</a>() );</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    }</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span> </div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_enumeration" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998">mod</a> : base.<a class="code hl_function" href="classitem.html#acd78321ba4d5c09d39f1d58d20b68484">gunmods</a>() ) {</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>        <span class="keywordflow">if</span>( <a class="code hl_enumeration" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998">mod</a>-&gt;magazine_current() ) {</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>            opts.push_back( <a class="code hl_enumeration" href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998">mod</a>-&gt;magazine_current() );</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>        }</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    }</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    <span class="keywordtype">bool</span> ammo_match_found = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>    <span class="keywordtype">int</span> ammo_search_range = who.<a class="code hl_function" href="classCharacter.html#a67b51491c2529df09755e07bc633cc55">is_mounted</a>() ? -1 : 1;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> e : opts ) {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>        <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_class" href="classitem__location.html">item_location</a> &amp;ammo : <a class="code hl_function" href="namespacecharacter__funcs.html#af0d4f519cd76c1891183b3c557bdf007">find_ammo_items_or_mags</a>( who, *e, include_empty_mags,</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>                ammo_search_range ) ) {</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>            <span class="comment">// don&#39;t try to unload frozen liquids</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>            <span class="keywordflow">if</span>( ammo-&gt;is_watertight_container() &amp;&amp; ammo-&gt;contents_made_of( <a class="code hl_enumvalue" href="enums_8h.html#ade8f325e8cc8463cef8f944f3209d0e5a1b45f84e1f6603b52e5ef442836df9af">SOLID</a> ) ) {</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>            }</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>            <span class="keyword">auto</span> <span class="keywordtype">id</span> = ( ammo-&gt;is_ammo_container() || ammo-&gt;is_container() )</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>                      ? ammo-&gt;contents.front().typeId()</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>                      : ammo-&gt;typeId();</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> can_reload_with = e-&gt;can_reload_with( <span class="keywordtype">id</span> );</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>            <span class="keywordflow">if</span>( can_reload_with ) {</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>                <span class="comment">// Speedloaders require an empty target.</span></div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>                <span class="keywordflow">if</span>( include_potential || !ammo-&gt;has_flag( <span class="stringliteral">&quot;SPEEDLOADER&quot;</span> ) || e-&gt;ammo_remaining() &lt; 1 ) {</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>                    ammo_match_found = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>                }</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>            }</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>            <span class="keywordflow">if</span>( ( include_potential &amp;&amp; can_reload_with )</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>                || who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>()-&gt;<a class="code hl_function" href="classCharacter.html#a5fb8820d11de3088b8ebe4157920e3cb">can_reload</a>( *e, <span class="keywordtype">id</span> ) || e-&gt;has_flag( <span class="stringliteral">&quot;RELOAD_AND_SHOOT&quot;</span> ) ) {</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>                ammo_list.emplace_back( who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>(), e, &amp;base, ammo );</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>            }</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>        }</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>    }</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    <span class="keywordflow">return</span> ammo_match_found;</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>}</div>
<div class="ttc" id="aclassCharacter_html_a5fb8820d11de3088b8ebe4157920e3cb"><div class="ttname"><a href="classCharacter.html#a5fb8820d11de3088b8ebe4157920e3cb">Character::can_reload</a></div><div class="ttdeci">bool can_reload(const item &amp;it, const itype_id &amp;ammo=itype_id()) const</div><div class="ttdoc">Whether a tool or gun is potentially reloadable (optionally considering a specific ammo)</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10880">character.cpp:10880</a></div></div>
<div class="ttc" id="aclassCharacter_html_a67b51491c2529df09755e07bc633cc55"><div class="ttname"><a href="classCharacter.html#a67b51491c2529df09755e07bc633cc55">Character::is_mounted</a></div><div class="ttdeci">bool is_mounted() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l01064">character.cpp:1064</a></div></div>
<div class="ttc" id="aclassitem__location_html"><div class="ttname"><a href="classitem__location.html">item_location</a></div><div class="ttdoc">A lightweight handle to an item independent of it's location Unlike a raw pointer can be (de-)seriali...</div><div class="ttdef"><b>Definition:</b> <a href="item__location_8h_source.html#l00022">item_location.h:23</a></div></div>
<div class="ttc" id="aclassitem_html_ab22fc9a4e0f9c6f5569b93e00deccfac"><div class="ttname"><a href="classitem.html#ab22fc9a4e0f9c6f5569b93e00deccfac">item::magazine_current</a></div><div class="ttdeci">item * magazine_current()</div><div class="ttdoc">Currently loaded magazine (if any)</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07722">item.cpp:7722</a></div></div>
<div class="ttc" id="anamespaceenchant__vals_html_acd6a6ebb27f9ecb82b3bce1d3aef2998"><div class="ttname"><a href="namespaceenchant__vals.html#acd6a6ebb27f9ecb82b3bce1d3aef2998">enchant_vals::mod</a></div><div class="ttdeci">mod</div><div class="ttdef"><b>Definition:</b> <a href="magic__enchantment_8h_source.html#l00026">magic_enchantment.h:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="creature_8h_source.html#l00122">Creature::as_player()</a>, <a class="el" href="character_8cpp_source.html#l10880">Character::can_reload()</a>, <a class="el" href="character__functions_8cpp_source.html#l01135">find_ammo_items_or_mags()</a>, <a class="el" href="item_8cpp_source.html#l07735">item::gunmods()</a>, <a class="el" href="character_8cpp_source.html#l01064">Character::is_mounted()</a>, <a class="el" href="item_8cpp_source.html#l07722">item::magazine_current()</a>, and <a class="el" href="enums_8h_source.html#l00175">SOLID</a>.</p>

<p class="reference">Referenced by <a class="el" href="avatar__action_8cpp_source.html#l01111">favorite_ammo_or_select()</a>, and <a class="el" href="character__functions_8cpp_source.html#l00987">select_ammo()</a>.</p>

</div>
</div>
<a id="a84ed0deeee8eeb3cd6d3339fefd86e30" name="a84ed0deeee8eeb3cd6d3339fefd86e30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84ed0deeee8eeb3cd6d3339fefd86e30">&#9670;&nbsp;</a></span>normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::normalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset <a class="el" href="classCharacter.html">Character</a>'s weapon and body state (limb hp, stamina, active martial art) </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00486">486</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>{</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    who.<a class="code hl_variable" href="classCharacter.html#a313797e99525bfd2a5ead68b7672f168">martial_arts_data</a>-&gt;reset_style();</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    who.<a class="code hl_variable" href="classCharacter.html#ae68b7a6565646ba662e448bded8b6599">weapon</a> = <a class="code hl_class" href="classitem.html">item</a>();</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    who.<a class="code hl_function" href="classCreature.html#a08520d85381520ff27dc274d5718a989">set_body</a>();</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    who.<a class="code hl_function" href="classCharacter.html#ae9de69bc0450c41078c9f5c86bcf837c">recalc_hp</a>();</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span> </div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    who.<a class="code hl_variable" href="classCharacter.html#ab8947df053065c19ec265278dcb8ed6c">temp_cur</a>.fill( <a class="code hl_variable" href="weather_8h.html#a126a092834651c253471d4190ea55cd3">BODYTEMP_NORM</a> );</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    who.<a class="code hl_variable" href="classCharacter.html#a450ed42503c02c36c04faa550a5b8f70">temp_conv</a>.fill( <a class="code hl_variable" href="weather_8h.html#a126a092834651c253471d4190ea55cd3">BODYTEMP_NORM</a> );</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    who.<a class="code hl_function" href="classCharacter.html#a65642ccc4e3370f7a594d77e4e1fd374">set_stamina</a>( who.<a class="code hl_function" href="classCharacter.html#aefe5432750eb1c2c65fea628fd9878a7">get_stamina_max</a>() );</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>}</div>
<div class="ttc" id="aclassCharacter_html_a450ed42503c02c36c04faa550a5b8f70"><div class="ttname"><a href="classCharacter.html#a450ed42503c02c36c04faa550a5b8f70">Character::temp_conv</a></div><div class="ttdeci">std::array&lt; int, num_bp &gt; temp_conv</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02258">character.h:2258</a></div></div>
<div class="ttc" id="aclassCharacter_html_a65642ccc4e3370f7a594d77e4e1fd374"><div class="ttname"><a href="classCharacter.html#a65642ccc4e3370f7a594d77e4e1fd374">Character::set_stamina</a></div><div class="ttdeci">void set_stamina(int new_stamina)</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07064">character.cpp:7064</a></div></div>
<div class="ttc" id="aclassCharacter_html_ab8947df053065c19ec265278dcb8ed6c"><div class="ttname"><a href="classCharacter.html#ab8947df053065c19ec265278dcb8ed6c">Character::temp_cur</a></div><div class="ttdeci">std::array&lt; int, num_bp &gt; temp_cur</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02258">character.h:2258</a></div></div>
<div class="ttc" id="aclassCharacter_html_ae9de69bc0450c41078c9f5c86bcf837c"><div class="ttname"><a href="classCharacter.html#ae9de69bc0450c41078c9f5c86bcf837c">Character::recalc_hp</a></div><div class="ttdeci">void recalc_hp()</div><div class="ttdoc">Recalculates HP after a change to max strength.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l01563">character.cpp:1563</a></div></div>
<div class="ttc" id="aclassCharacter_html_aefe5432750eb1c2c65fea628fd9878a7"><div class="ttname"><a href="classCharacter.html#aefe5432750eb1c2c65fea628fd9878a7">Character::get_stamina_max</a></div><div class="ttdeci">int get_stamina_max() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07053">character.cpp:7053</a></div></div>
<div class="ttc" id="aclassCreature_html_a08520d85381520ff27dc274d5718a989"><div class="ttname"><a href="classCreature.html#a08520d85381520ff27dc274d5718a989">Creature::set_body</a></div><div class="ttdeci">void set_body()</div><div class="ttdef"><b>Definition:</b> <a href="creature_8cpp_source.html#l01538">creature.cpp:1538</a></div></div>
<div class="ttc" id="aweather_8h_html_a126a092834651c253471d4190ea55cd3"><div class="ttname"><a href="weather_8h.html#a126a092834651c253471d4190ea55cd3">BODYTEMP_NORM</a></div><div class="ttdeci">static constexpr int BODYTEMP_NORM</div><div class="ttdoc">Level 1 hotness.</div><div class="ttdef"><b>Definition:</b> <a href="weather_8h_source.html#l00036">weather.h:36</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="weather_8h_source.html#l00036">BODYTEMP_NORM</a>, <a class="el" href="character_8cpp_source.html#l07053">Character::get_stamina_max()</a>, <a class="el" href="character_8h_source.html#l01550">Character::martial_arts_data</a>, <a class="el" href="character_8cpp_source.html#l01563">Character::recalc_hp()</a>, <a class="el" href="creature_8cpp_source.html#l01538">Creature::set_body()</a>, <a class="el" href="character_8cpp_source.html#l07064">Character::set_stamina()</a>, <a class="el" href="character_8h_source.html#l02258">Character::temp_conv</a>, <a class="el" href="character_8h_source.html#l02258">Character::temp_cur</a>, and <a class="el" href="character_8h_source.html#l01546">Character::weapon</a>.</p>

<p class="reference">Referenced by <a class="el" href="veh__interact_8cpp_source.html#l03013">veh_interact::complete_vehicle()</a>, <a class="el" href="debug__menu_8cpp_source.html#l01351">debug_menu::debug()</a>, <a class="el" href="vehicle_8cpp_source.html#l00770">vehicle::immediate_path()</a>, <a class="el" href="gamemode__tutorial_8cpp_source.html#l00107">tutorial_game::init()</a>, <a class="el" href="tileray_8cpp_source.html#l00044">tileray::init()</a>, <a class="el" href="vehicle__move_8cpp_source.html#l01949">vehicle_movement::is_on_rails()</a>, <a class="el" href="vehicle_8cpp_source.html#l01655">vehicle::merge_rackable_vehicle()</a>, <a class="el" href="npc_8cpp_source.html#l00131">npc::npc()</a>, <a class="el" href="vehicle__move_8cpp_source.html#l01867">vehicle_movement::process_movement_on_rails()</a>, <a class="el" href="ranged_8cpp_source.html#l02969">target_ui::recalc_aim_turning_penalty()</a>, <a class="el" href="vehicle_8cpp_source.html#l02005">vehicle::remove_carried_vehicle()</a>, and <a class="el" href="vehicle__move_8cpp_source.html#l00325">vehicle::turn()</a>.</p>

</div>
</div>
<a id="a13637305f9b6578e07749ae4ab8e784d" name="a13637305f9b6578e07749ae4ab8e784d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13637305f9b6578e07749ae4ab8e784d">&#9670;&nbsp;</a></span>pick_safe_adjacent_tile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcata_1_1optional.html">cata::optional</a>&lt; <a class="el" href="structtripoint.html">tripoint</a> &gt; character_funcs::pick_safe_adjacent_tile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns an unoccupied, safe adjacent point. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00605">605</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>{</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    std::vector&lt;tripoint&gt; <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    <span class="keywordtype">int</span> dangerous_fields = 0;</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <a class="code hl_class" href="classmap.html">map</a> &amp;here = <a class="code hl_function" href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a>();</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_struct" href="structtripoint.html">tripoint</a> &amp;p : here.<a class="code hl_function" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), 1 ) ) {</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        <span class="keywordflow">if</span>( p == who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() ) {</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>            <span class="comment">// Don&#39;t consider player position</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>        }</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        <span class="keyword">const</span> <a class="code hl_struct" href="structtrap.html">trap</a> &amp;curtrap = here.<a class="code hl_function" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( p );</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>        <span class="keywordflow">if</span>( <a class="code hl_variable" href="game_8cpp.html#abeb98e93502d73818b4a73fabe191bc1">g</a>-&gt;critter_at( p ) == <span class="keyword">nullptr</span> &amp;&amp; here.<a class="code hl_function" href="classmap.html#af563dc2397e71a053569cb45c6bb7e77">passable</a>( p ) &amp;&amp;</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            ( curtrap.<a class="code hl_function" href="structtrap.html#a6a9ac96c5c81eb31093e049ffeac8b4f">is_null</a>() || curtrap.<a class="code hl_function" href="structtrap.html#adc8f59b97597d373f7cb0bbcf061e794">is_benign</a>() ) ) {</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>            <span class="comment">// Only consider tile if unoccupied, passable and has no traps</span></div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>            dangerous_fields = 0;</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>            <span class="keyword">auto</span> &amp;tmpfld = here.<a class="code hl_function" href="classmap.html#a395a729a4b954692cf08d13e1d32f73e">field_at</a>( p );</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>            <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;fld : tmpfld ) {</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                <span class="keyword">const</span> <a class="code hl_class" href="classfield__entry.html">field_entry</a> &amp;cur = fld.second;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>                <span class="keywordflow">if</span>( cur.<a class="code hl_function" href="classfield__entry.html#a40f3c28e4f11b4f4e0eb0414f0fbd73b">is_dangerous</a>() ) {</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                    dangerous_fields++;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>                }</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            }</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span> </div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>            <span class="keywordflow">if</span>( dangerous_fields == 0 &amp;&amp; ! <a class="code hl_function" href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a>().obstructed_by_vehicle_rotation( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), p ) ) {</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.push_back( p );</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>            }</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        }</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    }</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="rng_8h.html#a12244355ee77108f1b08618e9962e4d1">random_entry</a>( <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> );</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>}</div>
<div class="ttc" id="aclassfield__entry_html"><div class="ttname"><a href="classfield__entry.html">field_entry</a></div><div class="ttdoc">An active or passive effect existing on a tile.</div><div class="ttdef"><b>Definition:</b> <a href="field_8h_source.html#l00019">field.h:20</a></div></div>
<div class="ttc" id="aclassfield__entry_html_a40f3c28e4f11b4f4e0eb0414f0fbd73b"><div class="ttname"><a href="classfield__entry.html#a40f3c28e4f11b4f4e0eb0414f0fbd73b">field_entry::is_dangerous</a></div><div class="ttdeci">bool is_dangerous() const</div><div class="ttdef"><b>Definition:</b> <a href="field_8h_source.html#l00078">field.h:78</a></div></div>
<div class="ttc" id="aclassmap_html_a30ccb67ed3651d350f2caf214e0b5176"><div class="ttname"><a href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">map::tr_at</a></div><div class="ttdeci">const trap &amp; tr_at(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l05167">map.cpp:5167</a></div></div>
<div class="ttc" id="aclassmap_html_a4f5f812d7e89a998429958573a4c340f"><div class="ttname"><a href="classmap.html#a4f5f812d7e89a998429958573a4c340f">map::points_in_radius</a></div><div class="ttdeci">tripoint_range&lt; tripoint &gt; points_in_radius(const tripoint &amp;center, size_t radius, size_t radiusz=0) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l08648">map.cpp:8648</a></div></div>
<div class="ttc" id="aclassmap_html_af563dc2397e71a053569cb45c6bb7e77"><div class="ttname"><a href="classmap.html#af563dc2397e71a053569cb45c6bb7e77">map::passable</a></div><div class="ttdeci">bool passable(const tripoint &amp;p) const</div><div class="ttdef"><b>Definition:</b> <a href="map_8cpp_source.html#l01858">map.cpp:1858</a></div></div>
<div class="ttc" id="arng_8h_html_a12244355ee77108f1b08618e9962e4d1"><div class="ttname"><a href="rng_8h.html#a12244355ee77108f1b08618e9962e4d1">random_entry</a></div><div class="ttdeci">V random_entry(const C &amp;container, D default_value)</div><div class="ttdoc">Returns a random entry in the container.</div><div class="ttdef"><b>Definition:</b> <a href="rng_8h_source.html#l00088">rng.h:88</a></div></div>
<div class="ttc" id="astructtrap_html_adc8f59b97597d373f7cb0bbcf061e794"><div class="ttname"><a href="structtrap.html#adc8f59b97597d373f7cb0bbcf061e794">trap::is_benign</a></div><div class="ttdeci">bool is_benign() const</div><div class="ttdoc">If true, this is not really a trap and there won't be any safety queries before stepping onto it (e....</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00159">trap.h:159</a></div></div>
<div class="ttc" id="astructtripoint_html"><div class="ttname"><a href="structtripoint.html">tripoint</a></div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00133">point.h:133</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="map_8cpp_source.html#l05329">map::field_at()</a>, <a class="el" href="game_8cpp_source.html#l00281">g</a>, <a class="el" href="map_8cpp_source.html#l00146">get_map()</a>, <a class="el" href="trap_8h_source.html#l00159">trap::is_benign()</a>, <a class="el" href="field_8h_source.html#l00078">field_entry::is_dangerous()</a>, <a class="el" href="trap_8cpp_source.html#l00245">trap::is_null()</a>, <a class="el" href="map_8cpp_source.html#l01858">map::passable()</a>, <a class="el" href="map_8cpp_source.html#l08648">map::points_in_radius()</a>, <a class="el" href="character_8cpp_source.html#l00587">Character::pos()</a>, <a class="el" href="rng_8h_source.html#l00088">random_entry()</a>, <a class="el" href="hash__utils_8h_source.html#l00097">cata::hash64_detail::ret</a>, and <a class="el" href="map_8cpp_source.html#l05167">map::tr_at()</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l00578">try_uncanny_dodge()</a>, and <a class="el" href="character_8cpp_source.html#l07654">Character::vomit()</a>.</p>

</div>
</div>
<a id="a392d1b99006a4f1f16c773e38762043d" name="a392d1b99006a4f1f16c773e38762043d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a392d1b99006a4f1f16c773e38762043d">&#9670;&nbsp;</a></span>rate_sleep_spot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int character_funcs::rate_sleep_spot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structtripoint.html">tripoint</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rate point's ability to serve as a bed. </p>
<p >Takes all mutations, fatigue and stimulants into account. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00313">313</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>{</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> current_stim = who.<a class="code hl_function" href="classCharacter.html#a7335f053c5874081211552623fa625c5">get_stim</a>();</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structcharacter__funcs_1_1comfort__response__t.html">comfort_response_t</a> comfort_info = <a class="code hl_function" href="namespacecharacter__funcs.html#a1686a89929a324a03d1396cac6ab1a24">base_comfort_value</a>( who, p );</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    <span class="keywordflow">if</span>( comfort_info.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#a884dc3843bf221f63b408da4d979cf23">aid</a> != <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;You use your %s for comfort.&quot;</span> ), comfort_info.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#a884dc3843bf221f63b408da4d979cf23">aid</a>-&gt;<a class="code hl_function" href="classitem.html#a7e78e26dcf9b357cda769c3ca2938eda">tname</a>() );</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    }</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="keywordtype">int</span> sleepy = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( comfort_info.<a class="code hl_variable" href="structcharacter__funcs_1_1comfort__response__t.html#af678f41d1dfcd14b9504c107a946ff14">level</a> );</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="keywordtype">bool</span> watersleep = who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#abf29a0f9f2b03dbf9baa8dd6af688d41">trait_WATERSLEEP</a> );</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span> </div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#afe055a629e5f9afdb201cd9a8749283c">has_addiction</a>( <a class="code hl_enumvalue" href="pldata_8h.html#abffc2f52fa6cfeac2e388c6de0ac295bab32bd403b93dc6deffdab7af55e82596">add_type::SLEEP</a> ) ) {</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        sleepy -= 4;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a01725f3a1c7d4a3c718b4a395b5ae41d">trait_INSOMNIA</a> ) ) {</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        <span class="comment">// 12.5 points is the difference between &quot;tired&quot; and &quot;dead tired&quot;</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        sleepy -= 12;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a5e899e783cee2462a5571083c6abe22f">trait_EASYSLEEPER</a> ) ) {</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        <span class="comment">// Low fatigue (being rested) has a much stronger effect than high fatigue</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        <span class="comment">// so it&#39;s OK for the value to be that much higher</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        sleepy += 40;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    }</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af9c7419575e23d52745c94009929fafb">has_active_bionic</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a978adf30232e0bcf1b9d38a73b8dd30e">bio_soporific</a> ) ) {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        sleepy += 30;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    }</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a21395d70727e0cc20a2417b6aaea56e3">trait_EASYSLEEPER2</a> ) ) {</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <span class="comment">// At this point, the only limit to sleep is tiredness</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        sleepy += 100;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    <span class="keywordflow">if</span>( watersleep &amp;&amp; <a class="code hl_function" href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a>().<a class="code hl_function" href="classmap.html#af0e872a5d0a7bf1e9745aeb18d3b5e44">has_flag_ter</a>( <span class="stringliteral">&quot;SWIMMABLE&quot;</span>, p ) ) {</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        sleepy += 10; <span class="comment">//comfy water!</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    }</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#a31c20b0d370fef88fefe520ff046daf5">get_fatigue</a>() &lt; <a class="code hl_enumvalue" href="character_8h.html#abf088072c9ca5b676f7f7545bac9a137a287f44f35ecb230e8b997abaad077f46">fatigue_levels::tired</a> + 1 ) {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        sleepy -= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( ( <a class="code hl_enumvalue" href="character_8h.html#abf088072c9ca5b676f7f7545bac9a137a287f44f35ecb230e8b997abaad077f46">fatigue_levels::tired</a> + 1 - who.<a class="code hl_function" href="classCharacter.html#a31c20b0d370fef88fefe520ff046daf5">get_fatigue</a>() ) / 4 );</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>        sleepy += <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( ( who.<a class="code hl_function" href="classCharacter.html#a31c20b0d370fef88fefe520ff046daf5">get_fatigue</a>() - <a class="code hl_enumvalue" href="character_8h.html#abf088072c9ca5b676f7f7545bac9a137a287f44f35ecb230e8b997abaad077f46">fatigue_levels::tired</a> + 1 ) / 16 );</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    }</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <span class="keywordflow">if</span>( current_stim &gt; 0 || !who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a01725f3a1c7d4a3c718b4a395b5ae41d">trait_INSOMNIA</a> ) ) {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>        sleepy -= 2 * current_stim;</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        <span class="comment">// Make it harder for insomniac to get around the trait</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        sleepy -= current_stim;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    }</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <span class="keywordflow">return</span> sleepy;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>}</div>
<div class="ttc" id="acharacter_8h_html_abf088072c9ca5b676f7f7545bac9a137a287f44f35ecb230e8b997abaad077f46"><div class="ttname"><a href="character_8h.html#abf088072c9ca5b676f7f7545bac9a137a287f44f35ecb230e8b997abaad077f46">fatigue_levels::tired</a></div><div class="ttdeci">@ tired</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a01725f3a1c7d4a3c718b4a395b5ae41d"><div class="ttname"><a href="character__functions_8cpp.html#a01725f3a1c7d4a3c718b4a395b5ae41d">trait_INSOMNIA</a></div><div class="ttdeci">static const trait_id trait_INSOMNIA(&quot;INSOMNIA&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a21395d70727e0cc20a2417b6aaea56e3"><div class="ttname"><a href="character__functions_8cpp.html#a21395d70727e0cc20a2417b6aaea56e3">trait_EASYSLEEPER2</a></div><div class="ttdeci">static const trait_id trait_EASYSLEEPER2(&quot;EASYSLEEPER2&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a5e899e783cee2462a5571083c6abe22f"><div class="ttname"><a href="character__functions_8cpp.html#a5e899e783cee2462a5571083c6abe22f">trait_EASYSLEEPER</a></div><div class="ttdeci">static const trait_id trait_EASYSLEEPER(&quot;EASYSLEEPER&quot;)</div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a978adf30232e0bcf1b9d38a73b8dd30e"><div class="ttname"><a href="character__functions_8cpp.html#a978adf30232e0bcf1b9d38a73b8dd30e">bio_soporific</a></div><div class="ttdeci">static const bionic_id bio_soporific(&quot;bio_soporific&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a31c20b0d370fef88fefe520ff046daf5"><div class="ttname"><a href="classCharacter.html#a31c20b0d370fef88fefe520ff046daf5">Character::get_fatigue</a></div><div class="ttdeci">int get_fatigue() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l04443">character.cpp:4443</a></div></div>
<div class="ttc" id="aclassCharacter_html_a7335f053c5874081211552623fa625c5"><div class="ttname"><a href="classCharacter.html#a7335f053c5874081211552623fa625c5">Character::get_stim</a></div><div class="ttdeci">int get_stim() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07015">character.cpp:7015</a></div></div>
<div class="ttc" id="aclassCharacter_html_af9c7419575e23d52745c94009929fafb"><div class="ttname"><a href="classCharacter.html#af9c7419575e23d52745c94009929fafb">Character::has_active_bionic</a></div><div class="ttdeci">bool has_active_bionic(const bionic_id &amp;b) const</div><div class="ttdoc">Returns true if the player has the entered bionic id and it is powered on.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l01805">character.cpp:1805</a></div></div>
<div class="ttc" id="aclassCharacter_html_afe055a629e5f9afdb201cd9a8749283c"><div class="ttname"><a href="classCharacter.html#afe055a629e5f9afdb201cd9a8749283c">Character::has_addiction</a></div><div class="ttdeci">bool has_addiction(add_type type) const</div><div class="ttdoc">Returns true if the player has an addiction of the specified type.</div><div class="ttdef"><b>Definition:</b> <a href="suffer_8cpp_source.html#l01942">suffer.cpp:1942</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a></div><div class="ttdeci">@ m_info</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00265">enums.h:265</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a1686a89929a324a03d1396cac6ab1a24"><div class="ttname"><a href="namespacecharacter__funcs.html#a1686a89929a324a03d1396cac6ab1a24">character_funcs::base_comfort_value</a></div><div class="ttdeci">comfort_response_t base_comfort_value(const Character &amp;who, const tripoint &amp;p)</div><div class="ttdoc">Rate point's ability to serve as a bed.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00182">character_functions.cpp:182</a></div></div>
<div class="ttc" id="apldata_8h_html_abffc2f52fa6cfeac2e388c6de0ac295bab32bd403b93dc6deffdab7af55e82596"><div class="ttname"><a href="pldata_8h.html#abffc2f52fa6cfeac2e388c6de0ac295bab32bd403b93dc6deffdab7af55e82596">add_type::SLEEP</a></div><div class="ttdeci">@ SLEEP</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="creature_8h_source.html#l00597">Creature::add_msg_if_player()</a>, <a class="el" href="character__functions_8h_source.html#l00093">character_funcs::comfort_response_t::aid</a>, <a class="el" href="character__functions_8cpp_source.html#l00182">base_comfort_value()</a>, <a class="el" href="character__functions_8cpp.html#a978adf30232e0bcf1b9d38a73b8dd30e">bio_soporific</a>, <a class="el" href="character_8cpp_source.html#l04443">Character::get_fatigue()</a>, <a class="el" href="map_8cpp_source.html#l00146">get_map()</a>, <a class="el" href="character_8cpp_source.html#l07015">Character::get_stim()</a>, <a class="el" href="character_8cpp_source.html#l01805">Character::has_active_bionic()</a>, <a class="el" href="suffer_8cpp_source.html#l01942">Character::has_addiction()</a>, <a class="el" href="map_8cpp_source.html#l02370">map::has_flag_ter()</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="character__functions_8h_source.html#l00092">character_funcs::comfort_response_t::level</a>, <a class="el" href="enums_8h_source.html#l00265">m_info</a>, <a class="el" href="pldata_8h.html#abffc2f52fa6cfeac2e388c6de0ac295bab32bd403b93dc6deffdab7af55e82596">SLEEP</a>, <a class="el" href="character_8h.html#abf088072c9ca5b676f7f7545bac9a137a287f44f35ecb230e8b997abaad077f46">tired</a>, <a class="el" href="item_8cpp_source.html#l04554">item::tname()</a>, <a class="el" href="character__functions_8cpp.html#a5e899e783cee2462a5571083c6abe22f">trait_EASYSLEEPER</a>, <a class="el" href="character__functions_8cpp.html#a21395d70727e0cc20a2417b6aaea56e3">trait_EASYSLEEPER2</a>, <a class="el" href="character__functions_8cpp.html#a01725f3a1c7d4a3c718b4a395b5ae41d">trait_INSOMNIA</a>, and <a class="el" href="character__functions_8cpp.html#abf29a0f9f2b03dbf9baa8dd6af688d41">trait_WATERSLEEP</a>.</p>

<p class="reference">Referenced by <a class="el" href="npcmove_8cpp_source.html#l00960">npc::execute_action()</a>, and <a class="el" href="character__functions_8cpp_source.html#l00363">roll_can_sleep()</a>.</p>

</div>
</div>
<a id="a16d62ac71c344a9b0482777456bb7b74" name="a16d62ac71c344a9b0482777456bb7b74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d62ac71c344a9b0482777456bb7b74">&#9670;&nbsp;</a></span>roll_can_sleep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::roll_can_sleep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checked each turn during "lying_down", returns true if the avatar falls asleep. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00363">363</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>{</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCreature.html#a6fb79df9315dc2bed6f34d9a2e37da90">has_effect</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a5ba3e18250fa524fe8548fa0a1e98535">effect_meth</a> ) ) {</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        <span class="comment">// Sleep ain&#39;t happening until that meth wears off completely.</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    }</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="comment">// Since there&#39;s a bit of randomness to falling asleep, we want to</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <span class="comment">// prevent exploiting this if can_sleep() gets called over and over.</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <span class="comment">// Only actually check if we can fall asleep no more frequently than</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    <span class="comment">// every 30 minutes.  We&#39;re assuming that if we return true, we&#39;ll</span></div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="comment">// immediately be falling asleep after that.</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="comment">// Also if player debug menu&#39;d time backwards this breaks, just do the</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="comment">// check anyway, this will reset the timer if &#39;dur&#39; is negative.</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <span class="keyword">const</span> <a class="code hl_class" href="classtime__point.html">time_point</a> now = <a class="code hl_variable" href="namespacecalendar.html#ae15fcbf1c971589eb49c1a657fb6a580">calendar::turn</a>;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <span class="keyword">const</span> <a class="code hl_class" href="classtime__duration.html">time_duration</a> dur = now - who.<a class="code hl_variable" href="classCharacter.html#a5315b433514914a1e7e08939dde1e58a">last_sleep_check</a>;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    <span class="keywordflow">if</span>( dur &gt;= 0_turns &amp;&amp; dur &lt; 30_minutes ) {</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    }</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    who.<a class="code hl_variable" href="classCharacter.html#a5315b433514914a1e7e08939dde1e58a">last_sleep_check</a> = now;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="keywordtype">int</span> sleepy = <a class="code hl_function" href="namespacecharacter__funcs.html#a392d1b99006a4f1f16c773e38762043d">character_funcs::rate_sleep_spot</a>( who, who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() );</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    sleepy += <a class="code hl_function" href="artifact_8cpp.html#a70800e95389f34dd34186fafaea2a840">rng</a>( -8, 8 );</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="keywordtype">bool</span> <a class="code hl_enumeration" href="namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a> = sleepy &gt; 0;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af9c7419575e23d52745c94009929fafb">has_active_bionic</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a978adf30232e0bcf1b9d38a73b8dd30e">bio_soporific</a> ) ) {</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a65a091d2c8d36f9102c09bc24836bf6e">bio_soporific_powered_at_last_sleep_check</a> &amp;&amp; !who.<a class="code hl_function" href="classCharacter.html#ad33fda9a7f9d4c8529cff2bbaea675ae">has_power</a>() ) {</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your soporific inducer runs out of power!&quot;</span> ) );</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( !who.<a class="code hl_variable" href="classCharacter.html#a65a091d2c8d36f9102c09bc24836bf6e">bio_soporific_powered_at_last_sleep_check</a> &amp;&amp; who.<a class="code hl_function" href="classCharacter.html#ad33fda9a7f9d4c8529cff2bbaea675ae">has_power</a>() ) {</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10">m_good</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your soporific inducer starts back up.&quot;</span> ) );</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        }</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        who.<a class="code hl_variable" href="classCharacter.html#a65a091d2c8d36f9102c09bc24836bf6e">bio_soporific_powered_at_last_sleep_check</a> = who.<a class="code hl_function" href="classCharacter.html#ad33fda9a7f9d4c8529cff2bbaea675ae">has_power</a>();</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    }</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    <span class="keywordflow">return</span> <a class="code hl_enumeration" href="namespacedetail_1_1digits.html#aad69d2373aa047bdd9e81494bf3da5ae">result</a>;</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>}</div>
<div class="ttc" id="acharacter__functions_8cpp_html_a5ba3e18250fa524fe8548fa0a1e98535"><div class="ttname"><a href="character__functions_8cpp.html#a5ba3e18250fa524fe8548fa0a1e98535">effect_meth</a></div><div class="ttdeci">static const efftype_id effect_meth(&quot;meth&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a5315b433514914a1e7e08939dde1e58a"><div class="ttname"><a href="classCharacter.html#a5315b433514914a1e7e08939dde1e58a">Character::last_sleep_check</a></div><div class="ttdeci">time_point last_sleep_check</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02124">character.h:2124</a></div></div>
<div class="ttc" id="aclassCharacter_html_a65a091d2c8d36f9102c09bc24836bf6e"><div class="ttname"><a href="classCharacter.html#a65a091d2c8d36f9102c09bc24836bf6e">Character::bio_soporific_powered_at_last_sleep_check</a></div><div class="ttdeci">bool bio_soporific_powered_at_last_sleep_check</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02125">character.h:2125</a></div></div>
<div class="ttc" id="aclassCharacter_html_ad33fda9a7f9d4c8529cff2bbaea675ae"><div class="ttname"><a href="classCharacter.html#ad33fda9a7f9d4c8529cff2bbaea675ae">Character::has_power</a></div><div class="ttdeci">bool has_power() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l01927">character.cpp:1927</a></div></div>
<div class="ttc" id="aclasstime__point_html"><div class="ttname"><a href="classtime__point.html">time_point</a></div><div class="ttdoc">A point in the game time.</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8h_source.html#l00430">calendar.h:431</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea2f644bab8f796b847285eab073040f10">m_good</a></div><div class="ttdeci">@ m_good</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00260">enums.h:260</a></div></div>
<div class="ttc" id="aenums_8h_html_a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1"><div class="ttname"><a href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a></div><div class="ttdeci">@ m_bad</div><div class="ttdef"><b>Definition:</b> <a href="enums_8h_source.html#l00261">enums.h:261</a></div></div>
<div class="ttc" id="anamespacecalendar_html_ae15fcbf1c971589eb49c1a657fb6a580"><div class="ttname"><a href="namespacecalendar.html#ae15fcbf1c971589eb49c1a657fb6a580">calendar::turn</a></div><div class="ttdeci">time_point turn</div><div class="ttdef"><b>Definition:</b> <a href="calendar_8cpp_source.html#l00036">calendar.cpp:36</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a392d1b99006a4f1f16c773e38762043d"><div class="ttname"><a href="namespacecharacter__funcs.html#a392d1b99006a4f1f16c773e38762043d">character_funcs::rate_sleep_spot</a></div><div class="ttdeci">int rate_sleep_spot(const Character &amp;who, const tripoint &amp;p)</div><div class="ttdoc">Rate point's ability to serve as a bed.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00313">character_functions.cpp:313</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="creature_8h_source.html#l00597">Creature::add_msg_if_player()</a>, <a class="el" href="character__functions_8cpp.html#a978adf30232e0bcf1b9d38a73b8dd30e">bio_soporific</a>, <a class="el" href="character_8h_source.html#l02125">Character::bio_soporific_powered_at_last_sleep_check</a>, <a class="el" href="character__functions_8cpp.html#a5ba3e18250fa524fe8548fa0a1e98535">effect_meth</a>, <a class="el" href="character_8cpp_source.html#l01805">Character::has_active_bionic()</a>, <a class="el" href="creature_8cpp_source.html#l01185">Creature::has_effect()</a>, <a class="el" href="character_8cpp_source.html#l01927">Character::has_power()</a>, <a class="el" href="character_8h_source.html#l02124">Character::last_sleep_check</a>, <a class="el" href="enums_8h_source.html#l00261">m_bad</a>, <a class="el" href="enums_8h_source.html#l00260">m_good</a>, <a class="el" href="character_8cpp_source.html#l00587">Character::pos()</a>, <a class="el" href="character__functions_8cpp_source.html#l00313">rate_sleep_spot()</a>, <a class="el" href="artifact_8cpp_source.html#l00032">rng()</a>, and <a class="el" href="calendar_8cpp_source.html#l00036">calendar::turn</a>.</p>

<p class="reference">Referenced by <a class="el" href="player__hardcoded__effects_8cpp_source.html#l00472">Character::hardcoded_effects()</a>, and <a class="el" href="activity__handlers_8cpp_source.html#l03489">activity_handlers::try_sleep_do_turn()</a>.</p>

</div>
</div>
<a id="a53b7fa49a536bb361b3a6b2ef669bea4" name="a53b7fa49a536bb361b3a6b2ef669bea4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53b7fa49a536bb361b3a6b2ef669bea4">&#9670;&nbsp;</a></span>search_surroundings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::search_surroundings </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search surrounding squares for traps (and maybe other things in the future). </p>

<p class="definition">Definition at line <a class="el" href="character__turn_8cpp_source.html#l01056">1056</a> of file <a class="el" href="character__turn_8cpp_source.html">character_turn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>{</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>    <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a0701e6a3f1987d9fa3f76b450dd5624a">controlling_vehicle</a> ) {</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>    }</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>    <span class="keyword">const</span> <a class="code hl_class" href="classmap.html">map</a> &amp;here = <a class="code hl_function" href="map_8cpp.html#acb0b34be6e497bdd2f9f40ae6929d562">get_map</a>();</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>    <span class="comment">// Search for traps in a larger area than before because this is the only</span></div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>    <span class="comment">// way we can &quot;find&quot; traps that aren&#39;t marked as visible.</span></div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>    <span class="comment">// Detection formula takes care of likelihood of seeing within this range.</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_struct" href="structtripoint.html">tripoint</a> &amp;tp : here.<a class="code hl_function" href="classmap.html#a4f5f812d7e89a998429958573a4c340f">points_in_radius</a>( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), 5 ) ) {</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>        <span class="keyword">const</span> <a class="code hl_struct" href="structtrap.html">trap</a> &amp;tr = here.<a class="code hl_function" href="classmap.html#a30ccb67ed3651d350f2caf214e0b5176">tr_at</a>( tp );</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>        <span class="keywordflow">if</span>( tr.<a class="code hl_function" href="structtrap.html#a6a9ac96c5c81eb31093e049ffeac8b4f">is_null</a>() || tp == who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>() ) {</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>        }</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>        <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af9c7419575e23d52745c94009929fafb">has_active_bionic</a>( <a class="code hl_variable" href="character__turn_8cpp.html#ad8239c9fba8c9d73da4db8671d7430d0">bio_ground_sonar</a> ) &amp;&amp; !who.<a class="code hl_function" href="classCharacter.html#a7cf3a039fed01ee44525ea41940cb00d">knows_trap</a>( tp ) &amp;&amp;</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>            ( tr.<a class="code hl_variable" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a> == <a class="code hl_variable" href="trap_8cpp.html#abecb554db3424388894ab98bde179238">tr_beartrap_buried</a> ||</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>              tr.<a class="code hl_variable" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a> == <a class="code hl_variable" href="trap_8cpp.html#ac666204330f19cb23e099f6870b8a1a4">tr_landmine_buried</a> || tr.<a class="code hl_variable" href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">loadid</a> == <a class="code hl_variable" href="memorial__logger_8cpp.html#ab4f7bfd1861799c55e2d7fbf2717c962">tr_sinkhole</a> ) ) {</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>            <span class="keyword">const</span> std::string <a class="code hl_enumeration" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> = <a class="code hl_function" href="line_8cpp.html#a19634ed59e09da9312d6fa110a38539c">direction_name</a>( <a class="code hl_function" href="coordinates_8h.html#a00be0762df7b46da965e55caffac53db">direction_from</a>( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), tp ) );</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>            who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096eaed9222dd268c0a08567f6c9081b3e687">m_warning</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Your ground sonar detected a %1$s to the %2$s!&quot;</span> ),</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>                                   tr.<a class="code hl_function" href="structtrap.html#a01b0ef8443ac5ba4e7455880ca2dc44b">name</a>(), <a class="code hl_enumeration" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> );</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>            who.<a class="code hl_function" href="classCharacter.html#ada34ca3fb472a8b1816e297ead2b31df">add_known_trap</a>( tp, tr );</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>        }</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>        <span class="keywordflow">if</span>( !who.<a class="code hl_function" href="classCharacter.html#aba9bd7517b334e6ed4149889ed32377a">sees</a>( tp ) ) {</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>        }</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>        <span class="keywordflow">if</span>( tr.<a class="code hl_function" href="structtrap.html#aafab5c450397fa7ea6430a9334c2859c">is_always_invisible</a>() || tr.<a class="code hl_function" href="structtrap.html#abeb5ff27f9f78475035f22aabdcfe834">can_see</a>( tp, who ) ) {</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>            <span class="comment">// Already seen, or can never be seen</span></div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>        }</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>        <span class="comment">// Chance to detect traps we haven&#39;t yet seen.</span></div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>        <span class="keywordflow">if</span>( tr.<a class="code hl_function" href="structtrap.html#afefc8440f9684bc6694c3c14dc59a727">detect_trap</a>( tp, who ) ) {</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>            <span class="keywordflow">if</span>( tr.<a class="code hl_function" href="structtrap.html#a1bd5955eae82045548ff8fc99a63edfc">get_visibility</a>() &gt; 0 ) {</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>                <span class="comment">// Only bug player about traps that aren&#39;t trivial to spot.</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>                <span class="keyword">const</span> std::string <a class="code hl_enumeration" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> = <a class="code hl_function" href="line_8cpp.html#a19634ed59e09da9312d6fa110a38539c">direction_name</a>(</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>                                                  <a class="code hl_function" href="coordinates_8h.html#a00be0762df7b46da965e55caffac53db">direction_from</a>( who.<a class="code hl_function" href="classCharacter.html#ad24859164517ed6e392e21df69527199">pos</a>(), tp ) );</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>                who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;You&#39;ve spotted a %1$s to the %2$s!&quot;</span> ),</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>                                       tr.<a class="code hl_function" href="structtrap.html#a01b0ef8443ac5ba4e7455880ca2dc44b">name</a>(), <a class="code hl_enumeration" href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a> );</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>            }</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>            who.<a class="code hl_function" href="classCharacter.html#ada34ca3fb472a8b1816e297ead2b31df">add_known_trap</a>( tp, tr );</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>        }</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>    }</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>}</div>
<div class="ttc" id="acharacter__turn_8cpp_html_ad8239c9fba8c9d73da4db8671d7430d0"><div class="ttname"><a href="character__turn_8cpp.html#ad8239c9fba8c9d73da4db8671d7430d0">bio_ground_sonar</a></div><div class="ttdeci">static const bionic_id bio_ground_sonar(&quot;bio_ground_sonar&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a0701e6a3f1987d9fa3f76b450dd5624a"><div class="ttname"><a href="classCharacter.html#a0701e6a3f1987d9fa3f76b450dd5624a">Character::controlling_vehicle</a></div><div class="ttdeci">bool controlling_vehicle</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l00246">character.h:246</a></div></div>
<div class="ttc" id="aclassCharacter_html_a7cf3a039fed01ee44525ea41940cb00d"><div class="ttname"><a href="classCharacter.html#a7cf3a039fed01ee44525ea41940cb00d">Character::knows_trap</a></div><div class="ttdeci">bool knows_trap(const tripoint &amp;pos) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10202">character.cpp:10202</a></div></div>
<div class="ttc" id="aclassCharacter_html_aba9bd7517b334e6ed4149889ed32377a"><div class="ttname"><a href="classCharacter.html#aba9bd7517b334e6ed4149889ed32377a">Character::sees</a></div><div class="ttdeci">bool sees(const tripoint &amp;t, bool is_player=false, int range_mod=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10388">character.cpp:10388</a></div></div>
<div class="ttc" id="aclassCharacter_html_ada34ca3fb472a8b1816e297ead2b31df"><div class="ttname"><a href="classCharacter.html#ada34ca3fb472a8b1816e297ead2b31df">Character::add_known_trap</a></div><div class="ttdeci">void add_known_trap(const tripoint &amp;pos, const trap &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l10208">character.cpp:10208</a></div></div>
<div class="ttc" id="acoordinates_8h_html_a00be0762df7b46da965e55caffac53db"><div class="ttname"><a href="coordinates_8h.html#a00be0762df7b46da965e55caffac53db">direction_from</a></div><div class="ttdeci">direction direction_from(const coords::coord_point&lt; Point, Origin, Scale &gt; &amp;loc1, const coords::coord_point&lt; Point, Origin, Scale &gt; &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="coordinates_8h_source.html#l00540">coordinates.h:540</a></div></div>
<div class="ttc" id="aline_8cpp_html_a19634ed59e09da9312d6fa110a38539c"><div class="ttname"><a href="line_8cpp.html#a19634ed59e09da9312d6fa110a38539c">direction_name</a></div><div class="ttdeci">std::string direction_name(const direction dir)</div><div class="ttdef"><b>Definition:</b> <a href="line_8cpp_source.html#l00528">line.cpp:528</a></div></div>
<div class="ttc" id="aline_8h_html_a3621d2006812bd84f3ed6999b38f90a3"><div class="ttname"><a href="line_8h.html#a3621d2006812bd84f3ed6999b38f90a3">direction</a></div><div class="ttdeci">direction</div><div class="ttdef"><b>Definition:</b> <a href="line_8h_source.html#l00039">line.h:39</a></div></div>
<div class="ttc" id="amemorial__logger_8cpp_html_ab4f7bfd1861799c55e2d7fbf2717c962"><div class="ttname"><a href="memorial__logger_8cpp.html#ab4f7bfd1861799c55e2d7fbf2717c962">tr_sinkhole</a></div><div class="ttdeci">static const trap_str_id tr_sinkhole(&quot;tr_sinkhole&quot;)</div></div>
<div class="ttc" id="astructtrap_html_a01b0ef8443ac5ba4e7455880ca2dc44b"><div class="ttname"><a href="structtrap.html#a01b0ef8443ac5ba4e7455880ca2dc44b">trap::name</a></div><div class="ttdeci">std::string name() const</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00177">trap.cpp:177</a></div></div>
<div class="ttc" id="astructtrap_html_a1bd5955eae82045548ff8fc99a63edfc"><div class="ttname"><a href="structtrap.html#a1bd5955eae82045548ff8fc99a63edfc">trap::get_visibility</a></div><div class="ttdeci">int get_visibility() const</div><div class="ttdoc">How easy it is to spot the trap.</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00133">trap.h:133</a></div></div>
<div class="ttc" id="astructtrap_html_aafab5c450397fa7ea6430a9334c2859c"><div class="ttname"><a href="structtrap.html#aafab5c450397fa7ea6430a9334c2859c">trap::is_always_invisible</a></div><div class="ttdeci">bool is_always_invisible() const</div><div class="ttdoc">There are special always invisible traps.</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00127">trap.h:127</a></div></div>
<div class="ttc" id="astructtrap_html_ab2767aee5179ad23b3ad0b6b4b2415af"><div class="ttname"><a href="structtrap.html#ab2767aee5179ad23b3ad0b6b4b2415af">trap::loadid</a></div><div class="ttdeci">trap_id loadid</div><div class="ttdef"><b>Definition:</b> <a href="trap_8h_source.html#l00088">trap.h:88</a></div></div>
<div class="ttc" id="astructtrap_html_abeb5ff27f9f78475035f22aabdcfe834"><div class="ttname"><a href="structtrap.html#abeb5ff27f9f78475035f22aabdcfe834">trap::can_see</a></div><div class="ttdeci">bool can_see(const tripoint &amp;pos, const Character &amp;p) const</div><div class="ttdoc">Can player/npc p see this kind of trap, either by their memory (they known there is the trap) or by t...</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00223">trap.cpp:223</a></div></div>
<div class="ttc" id="astructtrap_html_afefc8440f9684bc6694c3c14dc59a727"><div class="ttname"><a href="structtrap.html#afefc8440f9684bc6694c3c14dc59a727">trap::detect_trap</a></div><div class="ttdeci">bool detect_trap(const tripoint &amp;pos, const Character &amp;p) const</div><div class="ttdoc">Player has not yet seen the trap and returns the variable chance, at this moment, of whether the trap...</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00193">trap.cpp:193</a></div></div>
<div class="ttc" id="atrap_8cpp_html_abecb554db3424388894ab98bde179238"><div class="ttname"><a href="trap_8cpp.html#abecb554db3424388894ab98bde179238">tr_beartrap_buried</a></div><div class="ttdeci">trap_id tr_beartrap_buried</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00287">trap.cpp:287</a></div></div>
<div class="ttc" id="atrap_8cpp_html_ac666204330f19cb23e099f6870b8a1a4"><div class="ttname"><a href="trap_8cpp.html#ac666204330f19cb23e099f6870b8a1a4">tr_landmine_buried</a></div><div class="ttdeci">trap_id tr_landmine_buried</div><div class="ttdef"><b>Definition:</b> <a href="trap_8cpp_source.html#l00299">trap.cpp:299</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="character_8cpp_source.html#l10208">Character::add_known_trap()</a>, <a class="el" href="creature_8h_source.html#l00597">Creature::add_msg_if_player()</a>, <a class="el" href="character__turn_8cpp.html#ad8239c9fba8c9d73da4db8671d7430d0">bio_ground_sonar</a>, <a class="el" href="trap_8cpp_source.html#l00223">trap::can_see()</a>, <a class="el" href="character_8h_source.html#l00246">Character::controlling_vehicle</a>, <a class="el" href="trap_8cpp_source.html#l00193">trap::detect_trap()</a>, <a class="el" href="coordinates_8h_source.html#l00540">direction_from()</a>, <a class="el" href="line_8cpp_source.html#l00528">direction_name()</a>, <a class="el" href="map_8cpp_source.html#l00146">get_map()</a>, <a class="el" href="trap_8h_source.html#l00133">trap::get_visibility()</a>, <a class="el" href="character_8cpp_source.html#l01805">Character::has_active_bionic()</a>, <a class="el" href="trap_8h_source.html#l00127">trap::is_always_invisible()</a>, <a class="el" href="trap_8cpp_source.html#l00245">trap::is_null()</a>, <a class="el" href="character_8cpp_source.html#l10202">Character::knows_trap()</a>, <a class="el" href="trap_8h_source.html#l00088">trap::loadid</a>, <a class="el" href="enums_8h_source.html#l00264">m_warning</a>, <a class="el" href="trap_8cpp_source.html#l00177">trap::name()</a>, <a class="el" href="map_8cpp_source.html#l08648">map::points_in_radius()</a>, <a class="el" href="character_8cpp_source.html#l00587">Character::pos()</a>, <a class="el" href="character_8cpp_source.html#l10388">Character::sees()</a>, <a class="el" href="map_8cpp_source.html#l05167">map::tr_at()</a>, <a class="el" href="trap_8cpp_source.html#l00287">tr_beartrap_buried</a>, <a class="el" href="trap_8cpp_source.html#l00299">tr_landmine_buried</a>, and <a class="el" href="memorial__logger_8cpp.html#ab4f7bfd1861799c55e2d7fbf2717c962">tr_sinkhole</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__turn_8cpp_source.html#l00962">do_pause()</a>, and <a class="el" href="game_8cpp_source.html#l09050">game::place_player()</a>.</p>

</div>
</div>
<a id="a8b4188451961979984887e12b54e27c3" name="a8b4188451961979984887e12b54e27c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b4188451961979984887e12b54e27c3">&#9670;&nbsp;</a></span>select_ammo() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classitem__reload__option.html">item_reload_option</a> character_funcs::select_ammo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>prompt</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>include_empty_mags</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>include_potential</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select suitable ammo with which to reload the item. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> who looks for ammo </td></tr>
    <tr><td class="paramname">base</td><td>Item to select ammo for </td></tr>
    <tr><td class="paramname">prompt</td><td>Force display of the menu even if only one choice </td></tr>
    <tr><td class="paramname">include_empty_mags</td><td>Allow selection of empty magazines </td></tr>
    <tr><td class="paramname">include_potential</td><td>Include ammo that can potentially be used, but not right now </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00987">987</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>{</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    std::vector&lt;item_reload_option&gt; ammo_list;</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> ammo_match_found = <a class="code hl_function" href="namespacecharacter__funcs.html#ae7bfa36ae343bba14f1630cc9350f2d9">list_ammo</a>( who, base, ammo_list, include_empty_mags,</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>                                  include_potential );</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span> </div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    <span class="keywordflow">if</span>( ammo_list.empty() ) {</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>        <span class="keywordflow">if</span>( !who.<a class="code hl_function" href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">is_npc</a>() ) {</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>            <span class="keywordflow">if</span>( !base.<a class="code hl_function" href="classitem.html#adce43f2490a85e2dc212a26ce5ded4fc">is_magazine</a>() &amp;&amp; !base.<a class="code hl_function" href="classitem.html#aa7e9319c5779e2e1c550158ee8a2cc98">magazine_integral</a>() &amp;&amp; !base.<a class="code hl_function" href="classitem.html#ab22fc9a4e0f9c6f5569b93e00deccfac">magazine_current</a>() ) {</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>                who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;You need a compatible magazine to reload the %s!&quot;</span> ),</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>                                       base.<a class="code hl_function" href="classitem.html#a7e78e26dcf9b357cda769c3ca2938eda">tname</a>() );</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span> </div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ammo_match_found ) {</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>                who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Nothing to reload!&quot;</span> ) );</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>                std::string <a class="code hl_function" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a>;</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>                <span class="keywordflow">if</span>( base.<a class="code hl_function" href="classitem.html#a4adcc4a3a5f5fb20a4d245d79109640a">ammo_data</a>() ) {</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>                    <a class="code hl_function" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> = base.<a class="code hl_function" href="classitem.html#a4adcc4a3a5f5fb20a4d245d79109640a">ammo_data</a>()-&gt;<a class="code hl_function" href="structitype.html#ad35fbe0013544c1c396944b20b264421">nname</a>( 1 );</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( base.<a class="code hl_function" href="classitem.html#a22ad63b72a459c8f95893a853348cb06">is_watertight_container</a>() ) {</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>                    <a class="code hl_function" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> = base.<a class="code hl_function" href="classitem.html#a5996f63ca1797fc01482678b51a87680">is_container_empty</a>() ? <span class="stringliteral">&quot;liquid&quot;</span> : base.<a class="code hl_variable" href="classitem.html#a4afe851abb42cbff0857065860f96e0e">contents</a>.<a class="code hl_function" href="classitem__contents.html#a14299e40ca1440af11623c86e0b84072">front</a>().<a class="code hl_function" href="classitem.html#a7e78e26dcf9b357cda769c3ca2938eda">tname</a>();</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>                    <a class="code hl_function" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a> = <a class="code hl_function" href="output_8h.html#abc4022ff920f936d2ee400cedc458733">enumerate_as_string</a>( base.<a class="code hl_function" href="classitem.html#ac4f8c31c6aa17560f8f523290d568436">ammo_types</a>().begin(),</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>                    base.<a class="code hl_function" href="classitem.html#ac4f8c31c6aa17560f8f523290d568436">ammo_types</a>().end(), []( <span class="keyword">const</span> <a class="code hl_class" href="classstring__id.html">ammotype</a> &amp; at ) {</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>                        return at-&gt;name();</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>                    }, <a class="code hl_enumvalue" href="output_8h.html#a17a93de390fc2504e63ab6dc8cf4753aa334c4a4c42fdb79d7ebc3e73b517e6f8">enumeration_conjunction::none</a> );</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>                }</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>                who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;You don&#39;t have any %s to reload your %s!&quot;</span> ),</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>                                       <a class="code hl_function" href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">name</a>, base.<a class="code hl_function" href="classitem.html#a7e78e26dcf9b357cda769c3ca2938eda">tname</a>() );</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>            }</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>        }</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a>();</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>    }</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span> </div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>    <span class="comment">// sort in order of move cost (ascending), then remaining ammo (descending) with empty magazines always last</span></div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    std::stable_sort( ammo_list.begin(), ammo_list.end(), []( <span class="keyword">const</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a> &amp; lhs,</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    <span class="keyword">const</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a> &amp; rhs ) {</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>        return lhs.ammo-&gt;ammo_remaining() &gt; rhs.ammo-&gt;ammo_remaining();</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    } );</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>    std::stable_sort( ammo_list.begin(), ammo_list.end(), []( <span class="keyword">const</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a> &amp; lhs,</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    <span class="keyword">const</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a> &amp; rhs ) {</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>        return lhs.moves() &lt; rhs.moves();</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>    } );</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>    std::stable_sort( ammo_list.begin(), ammo_list.end(), []( <span class="keyword">const</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a> &amp; lhs,</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    <span class="keyword">const</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a> &amp; rhs ) {</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>        return ( lhs.ammo-&gt;ammo_remaining() != 0 ) &gt; ( rhs.ammo-&gt;ammo_remaining() != 0 );</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>    } );</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span> </div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    <span class="keywordflow">if</span>( !<a class="code hl_enumvalue" href="namespacepickup.html#a03a2e6f98be01a67be0ad42cb7aa4c61a29ea7ce63137484da296feacfa4f021c">prompt</a> &amp;&amp; ammo_list.size() == 1 ) {</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>        <span class="comment">// unconditionally suppress the prompt if there&#39;s only one option</span></div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        <span class="keywordflow">return</span> ammo_list[ 0 ];</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    }</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span> </div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacecharacter__funcs.html#a8b4188451961979984887e12b54e27c3">select_ammo</a>( who, base, <a class="code hl_function" href="namespaceavatar__action.html#a76ba74774376a08222b8cdcce08f7304">std::move</a>( ammo_list ) );</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>}</div>
<div class="ttc" id="aclassitem__reload__option_html"><div class="ttname"><a href="classitem__reload__option.html">item_reload_option</a></div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l00176">item.h:177</a></div></div>
<div class="ttc" id="aclassitem_html_a22ad63b72a459c8f95893a853348cb06"><div class="ttname"><a href="classitem.html#a22ad63b72a459c8f95893a853348cb06">item::is_watertight_container</a></div><div class="ttdeci">bool is_watertight_container() const</div><div class="ttdoc">Whether this is a container which can be used to store liquids.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l06724">item.cpp:6724</a></div></div>
<div class="ttc" id="aclassitem_html_a4adcc4a3a5f5fb20a4d245d79109640a"><div class="ttname"><a href="classitem.html#a4adcc4a3a5f5fb20a4d245d79109640a">item::ammo_data</a></div><div class="ttdeci">const itype * ammo_data() const</div><div class="ttdoc">Specific ammo data, returns nullptr if item is neither ammo nor loaded with any.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07533">item.cpp:7533</a></div></div>
<div class="ttc" id="aclassitem_html_ac4f8c31c6aa17560f8f523290d568436"><div class="ttname"><a href="classitem.html#ac4f8c31c6aa17560f8f523290d568436">item::ammo_types</a></div><div class="ttdeci">const std::set&lt; ammotype &gt; &amp; ammo_types(bool conversion=true) const</div><div class="ttdoc">Set of ammo types (ammunition_type) used by item.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07565">item.cpp:7565</a></div></div>
<div class="ttc" id="anamespaceavatar__action_html_a76ba74774376a08222b8cdcce08f7304"><div class="ttname"><a href="namespaceavatar__action.html#a76ba74774376a08222b8cdcce08f7304">avatar_action::move</a></div><div class="ttdeci">bool move(avatar &amp;you, map &amp;m, const tripoint &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="avatar__action_8cpp_source.html#l00096">avatar_action.cpp:96</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a8b4188451961979984887e12b54e27c3"><div class="ttname"><a href="namespacecharacter__funcs.html#a8b4188451961979984887e12b54e27c3">character_funcs::select_ammo</a></div><div class="ttdeci">item_reload_option select_ammo(const Character &amp;who, const item &amp;base, bool prompt, bool include_empty_mags, bool include_potential)</div><div class="ttdoc">Select suitable ammo with which to reload the item.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00987">character_functions.cpp:987</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_ae7bfa36ae343bba14f1630cc9350f2d9"><div class="ttname"><a href="namespacecharacter__funcs.html#ae7bfa36ae343bba14f1630cc9350f2d9">character_funcs::list_ammo</a></div><div class="ttdeci">bool list_ammo(const Character &amp;who, const item &amp;base, std::vector&lt; item_reload_option &gt; &amp;ammo_list, bool include_empty_mags, bool include_potential)</div><div class="ttdoc">List ammo suitable for given item.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00706">character_functions.cpp:706</a></div></div>
<div class="ttc" id="anamespaceom__direction_html_a8ba958ccfad28c0a5572a04dd1428f32"><div class="ttname"><a href="namespaceom__direction.html#a8ba958ccfad28c0a5572a04dd1428f32">om_direction::name</a></div><div class="ttdeci">std::string name(type dir)</div><div class="ttdoc">Get Human readable name of a direction.</div><div class="ttdef"><b>Definition:</b> <a href="overmap_8cpp_source.html#l04127">overmap.cpp:4127</a></div></div>
<div class="ttc" id="anamespacepickup_html_a03a2e6f98be01a67be0ad42cb7aa4c61a29ea7ce63137484da296feacfa4f021c"><div class="ttname"><a href="namespacepickup.html#a03a2e6f98be01a67be0ad42cb7aa4c61a29ea7ce63137484da296feacfa4f021c">pickup::prompt</a></div><div class="ttdeci">@ prompt</div><div class="ttdef"><b>Definition:</b> <a href="pickup_8h_source.html#l00031">pickup.h:30</a></div></div>
<div class="ttc" id="aoutput_8h_html_a17a93de390fc2504e63ab6dc8cf4753aa334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="output_8h.html#a17a93de390fc2504e63ab6dc8cf4753aa334c4a4c42fdb79d7ebc3e73b517e6f8">enumeration_conjunction::none</a></div><div class="ttdeci">@ none</div></div>
<div class="ttc" id="aoutput_8h_html_abc4022ff920f936d2ee400cedc458733"><div class="ttname"><a href="output_8h.html#abc4022ff920f936d2ee400cedc458733">enumerate_as_string</a></div><div class="ttdeci">std::string enumerate_as_string(const _Container &amp;values, enumeration_conjunction conj=enumeration_conjunction::and_)</div><div class="ttdef"><b>Definition:</b> <a href="output_8h_source.html#l00637">output.h:637</a></div></div>
<div class="ttc" id="astructitype_html_ad35fbe0013544c1c396944b20b264421"><div class="ttname"><a href="structitype.html#ad35fbe0013544c1c396944b20b264421">itype::nname</a></div><div class="ttdeci">std::string nname(unsigned int quantity) const</div><div class="ttdef"><b>Definition:</b> <a href="itype_8cpp_source.html#l00078">itype.cpp:78</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="creature_8h_source.html#l00597">Creature::add_msg_if_player()</a>, <a class="el" href="item_8cpp_source.html#l07533">item::ammo_data()</a>, <a class="el" href="item_8cpp_source.html#l07565">item::ammo_types()</a>, <a class="el" href="item_8h_source.html#l02158">item::contents</a>, <a class="el" href="output_8h_source.html#l00637">enumerate_as_string()</a>, <a class="el" href="item__contents_8cpp_source.html#l00190">item_contents::front()</a>, <a class="el" href="item_8cpp_source.html#l06837">item::is_container_empty()</a>, <a class="el" href="item_8cpp_source.html#l06557">item::is_magazine()</a>, <a class="el" href="creature_8h_source.html#l00098">Creature::is_npc()</a>, <a class="el" href="item_8cpp_source.html#l06724">item::is_watertight_container()</a>, <a class="el" href="character__functions_8cpp_source.html#l00706">list_ammo()</a>, <a class="el" href="enums_8h_source.html#l00265">m_info</a>, <a class="el" href="item_8cpp_source.html#l07722">item::magazine_current()</a>, <a class="el" href="item_8cpp_source.html#l07660">item::magazine_integral()</a>, <a class="el" href="avatar__action_8cpp_source.html#l00096">avatar_action::move()</a>, <a class="el" href="overmap_8cpp_source.html#l04127">om_direction::name()</a>, <a class="el" href="itype_8cpp_source.html#l00078">itype::nname()</a>, <a class="el" href="output_8h.html#a17a93de390fc2504e63ab6dc8cf4753aa334c4a4c42fdb79d7ebc3e73b517e6f8">none</a>, <a class="el" href="pickup_8h_source.html#l00030">pickup::prompt</a>, <a class="el" href="character__functions_8cpp_source.html#l00987">select_ammo()</a>, and <a class="el" href="item_8cpp_source.html#l04554">item::tname()</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l00987">select_ammo()</a>.</p>

</div>
</div>
<a id="a4c310418ea1c2bab8b4b03d7e0981df9" name="a4c310418ea1c2bab8b4b03d7e0981df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c310418ea1c2bab8b4b03d7e0981df9">&#9670;&nbsp;</a></span>select_ammo() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classitem__reload__option.html">item_reload_option</a> character_funcs::select_ammo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classitem__reload__option.html">item_reload_option</a> &gt;&#160;</td>
          <td class="paramname"><em>opts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select ammo from the provided options. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00750">750</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>{</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>    <span class="keywordflow">if</span>( opts.empty() ) {</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>        who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Never mind.&quot;</span> ) );</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a>();</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>    }</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span> </div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCreature.html#aed84fe52e1335d48d53f482f8a278c87">is_npc</a>() ) {</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>        <span class="keywordflow">return</span> opts[ 0 ];</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    }</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>    <a class="code hl_class" href="classuilist.html">uilist</a> menu;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a> = <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( base.<a class="code hl_function" href="classitem.html#a22ad63b72a459c8f95893a853348cb06">is_watertight_container</a>() ? <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Refill %s&quot;</span> ) :</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>                               base.<a class="code hl_function" href="classitem.html#aaa5aeb6f838927babb10ede535cf2a73">has_flag</a>( <span class="stringliteral">&quot;RELOAD_AND_SHOOT&quot;</span> ) ? <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Select ammo for %s&quot;</span> ) : <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Reload %s&quot;</span> ),</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>                               base.<a class="code hl_function" href="classitem.html#a7e78e26dcf9b357cda769c3ca2938eda">tname</a>() );</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <span class="comment">// Construct item names</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    std::vector&lt;std::string&gt; <a class="code hl_variable" href="namespaceName.html#a305934c1ed39204d620efdee7dbec154">names</a>;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    <a class="code hl_function" href="namespaceiexamine.html#ab9103bcb0e9cb4755b445e5395a0a62f">std::transform</a>( opts.begin(), opts.end(),</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    std::back_inserter( <a class="code hl_variable" href="namespaceName.html#a305934c1ed39204d620efdee7dbec154">names</a> ), [&amp;]( <span class="keyword">const</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a> &amp; e ) {</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>        if( e.ammo-&gt;is_magazine() &amp;&amp; e.ammo-&gt;ammo_data() ) {</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>            if( e.ammo-&gt;ammo_current() == itype_battery ) {</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>                <span class="comment">// This battery ammo is not a real object that can be recovered but pseudo-object that represents charge</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>                <span class="comment">//~ battery storage (charges)</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>                return string_format( pgettext( <span class="stringliteral">&quot;magazine&quot;</span>, <span class="stringliteral">&quot;%1$s (%2$d)&quot;</span> ), e.ammo-&gt;type_name(),</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>                                      e.ammo-&gt;ammo_remaining() );</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>            } else {</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>                <span class="comment">//~ magazine with ammo (count)</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>                return string_format( pgettext( <span class="stringliteral">&quot;magazine&quot;</span>, <span class="stringliteral">&quot;%1$s with %2$s (%3$d)&quot;</span> ), e.ammo-&gt;type_name(),</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>                                      e.ammo-&gt;ammo_data()-&gt;nname( e.ammo-&gt;ammo_remaining() ), e.ammo-&gt;ammo_remaining() );</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>            }</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( e.<a class="code hl_variable" href="classitem__reload__option.html#aaa2e80736bd76e83cd1fa4c871211bbd">ammo</a>-&gt;<a class="code hl_function" href="classitem.html#a22ad63b72a459c8f95893a853348cb06">is_watertight_container</a>() ||</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>                   ( e.<a class="code hl_variable" href="classitem__reload__option.html#aaa2e80736bd76e83cd1fa4c871211bbd">ammo</a>-&gt;<a class="code hl_function" href="classitem.html#a187a2679361c6546be613657dbad3b3f">is_ammo_container</a>() &amp;&amp; who.<a class="code hl_function" href="classCharacter.html#a4d8d747c469431f530acb05c5f7a7f45">is_worn</a>( *e.<a class="code hl_variable" href="classitem__reload__option.html#aaa2e80736bd76e83cd1fa4c871211bbd">ammo</a> ) ) ) {</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>            <span class="comment">// worn ammo containers should be named by their contents with their location also updated below</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>            return e.ammo-&gt;contents.front().display_name();</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span> </div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            const_cast&lt;item_location &amp;&gt;( who.ammo_location ).make_dirty();</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>            return ( who.ammo_location &amp;&amp; who.ammo_location == e.ammo ? <span class="stringliteral">&quot;* &quot;</span> : <span class="stringliteral">&quot;&quot;</span> ) + e.ammo-&gt;display_name();</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>        }</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    } );</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span> </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>    <span class="comment">// Get location descriptions</span></div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>    std::vector&lt;std::string&gt; where;</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    <a class="code hl_function" href="namespaceiexamine.html#ab9103bcb0e9cb4755b445e5395a0a62f">std::transform</a>( opts.begin(), opts.end(),</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    std::back_inserter( where ), [&amp;]( <span class="keyword">const</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a> &amp; e ) {</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>        bool is_ammo_container = e.ammo-&gt;is_ammo_container();</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>        if( is_ammo_container || e.ammo-&gt;is_container() ) {</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>            if( is_ammo_container &amp;&amp; who.is_worn( *e.ammo ) ) {</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>                return e.ammo-&gt;type_name();</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>            }</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>            return string_format( _( <span class="stringliteral">&quot;%s, %s&quot;</span> ), e.ammo-&gt;type_name(), e.ammo.describe( who.as_player() ) );</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>        }</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>        <span class="keywordflow">return</span> e.<a class="code hl_variable" href="classitem__reload__option.html#aaa2e80736bd76e83cd1fa4c871211bbd">ammo</a>.<a class="code hl_function" href="classitem__location.html#abc2ca6a2e19f2a5e7e92e000117bf3d7">describe</a>( who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>() );</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>    } );</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span> </div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>    <span class="comment">// Pads elements to match longest member and return length</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    <span class="keyword">auto</span> pad = []( std::vector&lt;std::string&gt; &amp;vec, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> t ) -&gt; <span class="keywordtype">int</span> {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>        <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;e : vec )</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>        {</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>            n = std::max( n, <a class="code hl_function" href="catacharset_8cpp.html#a7616a48a4b48437c60b6683439a8f3e2">utf8_width</a>( e, <span class="keyword">true</span> ) + t );</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>        }</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>        <span class="keywordflow">for</span>( <span class="keyword">auto</span> &amp;e : vec )</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>        {</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>            e += std::string( n - <a class="code hl_function" href="catacharset_8cpp.html#a7616a48a4b48437c60b6683439a8f3e2">utf8_width</a>( e, <span class="keyword">true</span> ), <span class="charliteral">&#39; &#39;</span> );</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>        }</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        <span class="keywordflow">return</span> n;</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>    };</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span> </div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    <span class="comment">// Pad the first column including 4 trailing spaces</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    <span class="keywordtype">int</span> w = pad( <a class="code hl_variable" href="namespaceName.html#a305934c1ed39204d620efdee7dbec154">names</a>, <a class="code hl_function" href="catacharset_8cpp.html#a7616a48a4b48437c60b6683439a8f3e2">utf8_width</a>( menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a>, <span class="keyword">true</span> ), 6 );</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a>.insert( 0, 2, <span class="charliteral">&#39; &#39;</span> ); <span class="comment">// add space for UI hotkeys</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a> += std::string( w + 2 - <a class="code hl_function" href="catacharset_8cpp.html#a7616a48a4b48437c60b6683439a8f3e2">utf8_width</a>( menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a>, <span class="keyword">true</span> ), <span class="charliteral">&#39; &#39;</span> );</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>    <span class="comment">// Pad the location similarly (excludes leading &quot;| &quot; and trailing &quot; &quot;)</span></div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    w = pad( where, <a class="code hl_function" href="catacharset_8cpp.html#a7616a48a4b48437c60b6683439a8f3e2">utf8_width</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;| Location &quot;</span> ) ) - 3, 6 );</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a> += <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;| Location &quot;</span> );</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a> += std::string( w + 3 - <a class="code hl_function" href="catacharset_8cpp.html#a7616a48a4b48437c60b6683439a8f3e2">utf8_width</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;| Location &quot;</span> ) ), <span class="charliteral">&#39; &#39;</span> );</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span> </div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a> += <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;| Amount  &quot;</span> );</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>    menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a> += <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;| Moves   &quot;</span> );</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span> </div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>    <span class="comment">// We only show ammo statistics for guns and magazines</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>    <span class="keywordflow">if</span>( base.<a class="code hl_function" href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">is_gun</a>() || base.<a class="code hl_function" href="classitem.html#adce43f2490a85e2dc212a26ce5ded4fc">is_magazine</a>() ) {</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        menu.<a class="code hl_variable" href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">text</a> += <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;| Damage   | Pierce   &quot;</span> );</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    }</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span> </div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>    <span class="keyword">auto</span> draw_row = [&amp;]( <span class="keywordtype">int</span> idx ) {</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;sel = opts[ idx ];</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>        std::string row = <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;%s| %s |&quot;</span>, <a class="code hl_variable" href="namespaceName.html#a305934c1ed39204d620efdee7dbec154">names</a>[ idx ], where[ idx ] );</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>        row += <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( ( sel.ammo-&gt;is_ammo() ||</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>                                sel.ammo-&gt;is_ammo_container() ) ? <span class="stringliteral">&quot; %-7d |&quot;</span> : <span class="stringliteral">&quot;         |&quot;</span>, sel.qty() );</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>        row += <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot; %-7d &quot;</span>, sel.moves() );</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>        <span class="keywordflow">if</span>( base.<a class="code hl_function" href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">is_gun</a>() || base.<a class="code hl_function" href="classitem.html#adce43f2490a85e2dc212a26ce5ded4fc">is_magazine</a>() ) {</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>            <span class="keyword">const</span> <a class="code hl_struct" href="structitype.html">itype</a> *ammo = sel.<a class="code hl_variable" href="structitype.html#a7cb80d77696cefb42ac6e75756b47e60">ammo</a>-&gt;is_ammo_container() ? sel.ammo-&gt;contents.front().ammo_data() :</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>                                sel.ammo-&gt;ammo_data();</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>            <span class="keywordflow">if</span>( ammo ) {</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>                <span class="keyword">const</span> <a class="code hl_struct" href="structdamage__instance.html">damage_instance</a> &amp;dam = ammo-&gt;<a class="code hl_variable" href="structitype.html#a7cb80d77696cefb42ac6e75756b47e60">ammo</a>-&gt;damage;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>                <span class="keyword">const</span> <a class="code hl_struct" href="structdamage__unit.html">damage_unit</a> &amp;du = dam.<a class="code hl_variable" href="structdamage__instance.html#a2cc3ee4ff8f77ab6cd74168b1999246a">damage_units</a>.front();</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>                <span class="keywordflow">if</span>( du.<a class="code hl_variable" href="structdamage__unit.html#a8c5cf76dd074bd5dac9b76aaece0ecf4">damage_multiplier</a> != 1.0f ) {</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>                    <span class="keywordtype">float</span> dam_amt = du.<a class="code hl_variable" href="structdamage__unit.html#a5937d5d78a6db9efaefb0bf9517377d3">amount</a>;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>                    row += <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;| %-3d*%3d%% &quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( dam_amt ),</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>                                          <a class="code hl_function" href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a>( <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( du.<a class="code hl_variable" href="structdamage__unit.html#a8c5cf76dd074bd5dac9b76aaece0ecf4">damage_multiplier</a> * 100 ), 0, 999 ) );</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>                    <span class="keywordtype">float</span> dam_amt = dam.<a class="code hl_function" href="structdamage__instance.html#a96f6f6d008ed8744ce549cefcfec3951">total_damage</a>();</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>                    row += <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;| %-8d &quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( dam_amt ) );</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>                }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>                <span class="keywordflow">if</span>( du.<a class="code hl_variable" href="structdamage__unit.html#af0a5ce1c282d7ed1a783fd4315404ec3">res_mult</a> != 1.0f ) {</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>                    row += <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;| %-3d/%3d%%&quot;</span>,</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>                                          <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( du.<a class="code hl_variable" href="structdamage__unit.html#ab4d1b13f7ebe2f16a43038e1441ec2b5">res_pen</a> ), <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( 100 * du.<a class="code hl_variable" href="structdamage__unit.html#af0a5ce1c282d7ed1a783fd4315404ec3">res_mult</a> ) );</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>                    row += <a class="code hl_function" href="string__formatter_8h.html#a8964099387da2f95396c67566bafce3d">string_format</a>( <span class="stringliteral">&quot;| %-8d&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( du.<a class="code hl_variable" href="structdamage__unit.html#ab4d1b13f7ebe2f16a43038e1441ec2b5">res_pen</a> ) );</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>                }</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>                row += <span class="stringliteral">&quot;|          |          &quot;</span>;</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>            }</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>        }</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>        <span class="keywordflow">return</span> row;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    };</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span> </div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    <span class="keyword">const</span> <a class="code hl_class" href="classstring__id.html">ammotype</a> base_ammotype( base.<a class="code hl_function" href="classitem.html#ab07d96e30c441a84435972df842f4c77">ammo_default</a>().<a class="code hl_function" href="classstring__id.html#aa7dabc565f0c067e1a237ea224b18f93">str</a>() );</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    <a class="code hl_class" href="classstring__id.html">itype_id</a> <a class="code hl_enumvalue" href="weather__type_8h.html#a72d839b22172d982273f161206458e25aa1a074a72eb46dfdde53e589d946ab98">last</a> = <a class="code hl_variable" href="game_8cpp.html#a764052f34a47c6dee072c67b842a222c">uistate</a>.<a class="code hl_variable" href="classuistatedata.html#a8b8f01f78f680b54f71cd02745682440">lastreload</a>[ base_ammotype ];</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    <span class="comment">// We keep the last key so that pressing the key twice (for example, r-r for reload)</span></div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>    <span class="comment">// will always pick the first option on the list.</span></div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>    <span class="keywordtype">int</span> last_key = <a class="code hl_variable" href="input_8cpp.html#af16c50890fa8503efa899fc3b6de56d7">inp_mngr</a>.<a class="code hl_function" href="classinput__manager.html#adac068207a89179b89e95d31422c9991">get_previously_pressed_key</a>();</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>    <span class="keywordtype">bool</span> last_key_bound = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>    <span class="comment">// This is the entry that has out default</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    <span class="keywordtype">int</span> default_to = 0;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span> </div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>    <span class="comment">// If last_key is RETURN, don&#39;t use that to override hotkey</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    <span class="keywordflow">if</span>( last_key == <span class="charliteral">&#39;\n&#39;</span> ) {</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>        last_key_bound = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        default_to = -1;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>    }</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span> </div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    <span class="keywordflow">for</span>( <span class="keyword">auto</span> i = 0; i &lt; static_cast&lt;int&gt;( opts.size() ); ++i ) {</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>        <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> &amp;ammo = opts[ i ].<a class="code hl_variable" href="structitype.html#a7cb80d77696cefb42ac6e75756b47e60">ammo</a>-&gt;is_ammo_container() ? opts[ i ].ammo-&gt;contents.front() :</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>                           *opts[ i ].ammo;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span> </div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>        <span class="keywordtype">char</span> hotkey = -1;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>        <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classvisitable.html#af49d5ef7b3f2f0a8664c23097a56373f">has_item</a>( ammo ) ) {</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>            <span class="comment">// if ammo in player possession and either it or any container has a valid invlet use this</span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>            <span class="keywordflow">if</span>( ammo.<a class="code hl_variable" href="classitem.html#af38d78ce6d128f6c7a1999b7f9e00965">invlet</a> ) {</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>                hotkey = ammo.<a class="code hl_variable" href="classitem.html#af38d78ce6d128f6c7a1999b7f9e00965">invlet</a>;</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>                <span class="keywordflow">for</span>( <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a> : who.<a class="code hl_function" href="classvisitable.html#a91f3c0f8e439b0ffda17e613fda94d04">parents</a>( ammo ) ) {</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>                    <span class="keywordflow">if</span>( <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>-&gt;invlet ) {</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>                        hotkey = <a class="code hl_function" href="classint__id.html#a315169d32cce4267b7c8dceff4b0d1d7">obj</a>-&gt;invlet;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>                    }</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>                }</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>            }</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>        }</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>        <span class="keywordflow">if</span>( <a class="code hl_enumvalue" href="weather__type_8h.html#a72d839b22172d982273f161206458e25aa1a074a72eb46dfdde53e589d946ab98">last</a> == ammo.<a class="code hl_function" href="classitem.html#aa79dad64e1ef6347219be2f8666e2752">typeId</a>() ) {</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>            <span class="keywordflow">if</span>( !last_key_bound &amp;&amp; hotkey == -1 ) {</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>                <span class="comment">// If this is the first occurrence of the most recently used type of ammo and the hotkey</span></div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>                <span class="comment">// was not already set above then set it to the keypress that opened this prompt</span></div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>                hotkey = last_key;</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>                last_key_bound = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>            }</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>            <span class="keywordflow">if</span>( !last_key_bound ) {</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>                <span class="comment">// Pressing the last key defaults to the first entry of compatible type</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>                default_to = i;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>                last_key_bound = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>            }</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        }</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>        <span class="keywordflow">if</span>( hotkey == last_key ) {</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>            last_key_bound = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>            <span class="comment">// Prevent the default from being used: key is bound to something already</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>            default_to = -1;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>        }</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span> </div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>        menu.<a class="code hl_function" href="classuilist.html#af99f28334902af64487e2d0758df2ab9">addentry</a>( i, <span class="keyword">true</span>, hotkey, draw_row( i ) );</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>    }</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span> </div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>    <span class="keyword">struct </span>reload_callback : <span class="keyword">public</span> <a class="code hl_class" href="classuilist__callback.html">uilist_callback</a> {</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>        <span class="keyword">public</span>:</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>            std::vector&lt;item_reload_option&gt; &amp;opts;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            <span class="keyword">const</span> std::function&lt;std::string( <span class="keywordtype">int</span> )&gt; draw_row;</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>            <span class="keywordtype">int</span> last_key;</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> default_to;</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> can_partial_reload;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span> </div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            reload_callback( std::vector&lt;item_reload_option&gt; &amp;_opts,</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>                             std::function&lt;std::string( <span class="keywordtype">int</span> )&gt; _draw_row,</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>                             <span class="keywordtype">int</span> _last_key, <span class="keywordtype">int</span> _default_to, <span class="keywordtype">bool</span> _can_partial_reload ) :</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>                opts( _opts ), draw_row( _draw_row ),</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>                last_key( _last_key ), default_to( _default_to ),</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>                can_partial_reload( _can_partial_reload )</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>            {}</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span> </div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>            <span class="keywordtype">bool</span> <a class="code hl_function" href="classuilist__callback.html#a982e00fd3b4aa68d9dfddba50e77622a">key</a>( <span class="keyword">const</span> <a class="code hl_class" href="classinput__context.html">input_context</a> &amp;, <span class="keyword">const</span> <a class="code hl_struct" href="structinput__event.html">input_event</a> &amp;event, <span class="keywordtype">int</span> idx, <a class="code hl_class" href="classuilist.html">uilist</a> *menu )<span class="keyword"> override </span>{</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>                <span class="keyword">auto</span> cur_key = <span class="keyword">event</span>.get_first_input();</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>                <span class="keywordflow">if</span>( default_to != -1 &amp;&amp; cur_key == last_key ) {</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>                    <span class="comment">// Select the first entry on the list</span></div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>                    menu-&gt;<a class="code hl_variable" href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">ret</a> = default_to;</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>                }</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>                <span class="keywordflow">if</span>( idx &lt; 0 || idx &gt;= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>( opts.size() ) ) {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>                }</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>                <span class="keyword">auto</span> &amp;sel = opts[ idx ];</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>                <span class="keywordflow">switch</span>( cur_key ) {</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>                    <span class="keywordflow">case</span> <a class="code hl_variable" href="input_8h.html#a7f98a32a40edbfcb172d2b4dde581f2c">KEY_LEFT</a>:</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>                        <span class="keywordflow">if</span>( can_partial_reload ) {</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>                            sel.qty( sel.qty() - 1 );</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>                            menu-&gt;<a class="code hl_variable" href="classuilist.html#af5fc2972d43a795c49a632dbcf58132b">entries</a>[ idx ].txt = draw_row( idx );</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>                        }</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span> </div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>                    <span class="keywordflow">case</span> <a class="code hl_variable" href="input_8h.html#aef82d50d6bc11e0fa4b39c47c2129952">KEY_RIGHT</a>:</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>                        <span class="keywordflow">if</span>( can_partial_reload ) {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>                            sel.qty( sel.qty() + 1 );</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>                            menu-&gt;<a class="code hl_variable" href="classuilist.html#af5fc2972d43a795c49a632dbcf58132b">entries</a>[ idx ].txt = draw_row( idx );</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>                        }</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>                        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>                }</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>            }</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>    } cb( opts, draw_row, last_key, default_to, !base.<a class="code hl_function" href="classitem.html#aaa5aeb6f838927babb10ede535cf2a73">has_flag</a>( <span class="stringliteral">&quot;RELOAD_ONE&quot;</span> ) );</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>    menu.<a class="code hl_variable" href="classuilist.html#ad4f5806d1d8ab3de3af8e3285faf47d6">callback</a> = &amp;cb;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span> </div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>    menu.<a class="code hl_function" href="group__UI.html#ga7604af7545244003f0a52ac87ce37979">query</a>();</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    <span class="keywordflow">if</span>( menu.<a class="code hl_variable" href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">ret</a> &lt; 0 || <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>( menu.<a class="code hl_variable" href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">ret</a> ) &gt;= opts.size() ) {</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>        who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Never mind.&quot;</span> ) );</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classitem__reload__option.html">item_reload_option</a>();</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>    }</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span> </div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>    <span class="keyword">const</span> <a class="code hl_class" href="classitem__location.html">item_location</a> &amp;sel = opts[ menu.<a class="code hl_variable" href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">ret</a> ].ammo;</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>    <a class="code hl_variable" href="game_8cpp.html#a764052f34a47c6dee072c67b842a222c">uistate</a>.<a class="code hl_variable" href="classuistatedata.html#a8b8f01f78f680b54f71cd02745682440">lastreload</a>[ <a class="code hl_typedef" href="type__id_8h.html#a4a240e1107e45f10d64b78f1b5f58d59">ammotype</a>( base.<a class="code hl_function" href="classitem.html#ab07d96e30c441a84435972df842f4c77">ammo_default</a>().<a class="code hl_function" href="classstring__id.html#aa7dabc565f0c067e1a237ea224b18f93">str</a>() ) ] = sel-&gt;<a class="code hl_function" href="classitem.html#a187a2679361c6546be613657dbad3b3f">is_ammo_container</a>() ?</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>            sel-&gt;<a class="code hl_variable" href="classitem.html#a4afe851abb42cbff0857065860f96e0e">contents</a>.<a class="code hl_function" href="classitem__contents.html#a14299e40ca1440af11623c86e0b84072">front</a>().<a class="code hl_function" href="classitem.html#aa79dad64e1ef6347219be2f8666e2752">typeId</a>() :</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>            sel-&gt;<a class="code hl_function" href="classitem.html#aa79dad64e1ef6347219be2f8666e2752">typeId</a>();</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>    <span class="keywordflow">return</span> opts[ menu.<a class="code hl_variable" href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">ret</a> ];</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>}</div>
<div class="ttc" id="acata__utility_8h_html_ad22b4a043b6eb4c2c06f87f83b720b15"><div class="ttname"><a href="cata__utility_8h.html#ad22b4a043b6eb4c2c06f87f83b720b15">clamp</a></div><div class="ttdeci">constexpr T clamp(const T &amp;val, const T &amp;min, const T &amp;max)</div><div class="ttdoc">Clamp first argument so that it is no lower than second and no higher than third.</div><div class="ttdef"><b>Definition:</b> <a href="cata__utility_8h_source.html#l00145">cata_utility.h:145</a></div></div>
<div class="ttc" id="acatacharset_8cpp_html_a7616a48a4b48437c60b6683439a8f3e2"><div class="ttname"><a href="catacharset_8cpp.html#a7616a48a4b48437c60b6683439a8f3e2">utf8_width</a></div><div class="ttdeci">int utf8_width(const char *s, const bool ignore_tags)</div><div class="ttdef"><b>Definition:</b> <a href="catacharset_8cpp_source.html#l00142">catacharset.cpp:142</a></div></div>
<div class="ttc" id="aclassCharacter_html_a4d8d747c469431f530acb05c5f7a7f45"><div class="ttname"><a href="classCharacter.html#a4d8d747c469431f530acb05c5f7a7f45">Character::is_worn</a></div><div class="ttdeci">bool is_worn(const item &amp;thing) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01086">character.h:1086</a></div></div>
<div class="ttc" id="aclassinput__context_html"><div class="ttname"><a href="classinput__context.html">input_context</a></div><div class="ttdoc">Represents a context in which a set of actions can be performed.</div><div class="ttdef"><b>Definition:</b> <a href="input_8h_source.html#l00385">input.h:386</a></div></div>
<div class="ttc" id="aclassinput__manager_html_adac068207a89179b89e95d31422c9991"><div class="ttname"><a href="classinput__manager.html#adac068207a89179b89e95d31422c9991">input_manager::get_previously_pressed_key</a></div><div class="ttdeci">int get_previously_pressed_key() const</div><div class="ttdoc">Return the previously pressed key, or 0 if there is no previous input or the previous input wasn't a ...</div><div class="ttdef"><b>Definition:</b> <a href="input_8cpp_source.html#l01304">input.cpp:1304</a></div></div>
<div class="ttc" id="aclassitem__location_html_abc2ca6a2e19f2a5e7e92e000117bf3d7"><div class="ttname"><a href="classitem__location.html#abc2ca6a2e19f2a5e7e92e000117bf3d7">item_location::describe</a></div><div class="ttdeci">std::string describe(const Character *ch=nullptr) const</div><div class="ttdoc">Describes the item location.</div><div class="ttdef"><b>Definition:</b> <a href="item__location_8cpp_source.html#l00739">item_location.cpp:739</a></div></div>
<div class="ttc" id="aclassitem__reload__option_html_aaa2e80736bd76e83cd1fa4c871211bbd"><div class="ttname"><a href="classitem__reload__option.html#aaa2e80736bd76e83cd1fa4c871211bbd">item_reload_option::ammo</a></div><div class="ttdeci">item_location ammo</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l00189">item.h:189</a></div></div>
<div class="ttc" id="aclassitem_html_ab07d96e30c441a84435972df842f4c77"><div class="ttname"><a href="classitem.html#ab07d96e30c441a84435972df842f4c77">item::ammo_default</a></div><div class="ttdeci">itype_id ammo_default(bool conversion=true) const</div><div class="ttdoc">Get default ammo used by item or a null id if item does not have a default ammo type.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07596">item.cpp:7596</a></div></div>
<div class="ttc" id="aclassitem_html_af38d78ce6d128f6c7a1999b7f9e00965"><div class="ttname"><a href="classitem.html#af38d78ce6d128f6c7a1999b7f9e00965">item::invlet</a></div><div class="ttdeci">char invlet</div><div class="ttdef"><b>Definition:</b> <a href="item_8h_source.html#l02233">item.h:2233</a></div></div>
<div class="ttc" id="aclassstring__id_html_aa7dabc565f0c067e1a237ea224b18f93"><div class="ttname"><a href="classstring__id.html#aa7dabc565f0c067e1a237ea224b18f93">string_id::str</a></div><div class="ttdeci">const std::string &amp; str() const</div><div class="ttdoc">Returns the identifier as plain std::string.</div><div class="ttdef"><b>Definition:</b> <a href="string__id_8h_source.html#l00255">string_id.h:255</a></div></div>
<div class="ttc" id="aclassuilist__callback_html"><div class="ttname"><a href="classuilist__callback.html">uilist_callback</a></div><div class="ttdoc">uilist::query() handles most input events first, and then passes the event to the callback if it can'...</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00166">ui.h:167</a></div></div>
<div class="ttc" id="aclassuilist__callback_html_a982e00fd3b4aa68d9dfddba50e77622a"><div class="ttname"><a href="classuilist__callback.html#a982e00fd3b4aa68d9dfddba50e77622a">uilist_callback::key</a></div><div class="ttdeci">virtual bool key(const input_context &amp;, const input_event &amp;, int, uilist *)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00174">ui.h:174</a></div></div>
<div class="ttc" id="aclassuilist_html"><div class="ttname"><a href="classuilist.html">uilist</a></div><div class="ttdoc">uilist: scrolling vertical list menu</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00186">ui.h:187</a></div></div>
<div class="ttc" id="aclassuilist_html_a0baa34622db6972a59d47d478bfd21d6"><div class="ttname"><a href="classuilist.html#a0baa34622db6972a59d47d478bfd21d6">uilist::ret</a></div><div class="ttdeci">int ret</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00412">ui.h:412</a></div></div>
<div class="ttc" id="aclassuilist_html_ad4f5806d1d8ab3de3af8e3285faf47d6"><div class="ttname"><a href="classuilist.html#ad4f5806d1d8ab3de3af8e3285faf47d6">uilist::callback</a></div><div class="ttdeci">uilist_callback * callback</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00335">ui.h:335</a></div></div>
<div class="ttc" id="aclassuilist_html_af59dd3fdde04746dbc5cb52b355577ce"><div class="ttname"><a href="classuilist.html#af59dd3fdde04746dbc5cb52b355577ce">uilist::text</a></div><div class="ttdeci">std::string text</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00320">ui.h:320</a></div></div>
<div class="ttc" id="aclassuilist_html_af5fc2972d43a795c49a632dbcf58132b"><div class="ttname"><a href="classuilist.html#af5fc2972d43a795c49a632dbcf58132b">uilist::entries</a></div><div class="ttdeci">std::vector&lt; uilist_entry &gt; entries</div><div class="ttdef"><b>Definition:</b> <a href="ui_8h_source.html#l00323">ui.h:323</a></div></div>
<div class="ttc" id="aclassuilist_html_af99f28334902af64487e2d0758df2ab9"><div class="ttname"><a href="classuilist.html#af99f28334902af64487e2d0758df2ab9">uilist::addentry</a></div><div class="ttdeci">void addentry(const std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l00942">ui.cpp:942</a></div></div>
<div class="ttc" id="aclassuistatedata_html_a8b8f01f78f680b54f71cd02745682440"><div class="ttname"><a href="classuistatedata.html#a8b8f01f78f680b54f71cd02745682440">uistatedata::lastreload</a></div><div class="ttdeci">std::map&lt; ammotype, itype_id &gt; lastreload</div><div class="ttdef"><b>Definition:</b> <a href="uistate_8h_source.html#l00151">uistate.h:151</a></div></div>
<div class="ttc" id="aclassvisitable_html_a91f3c0f8e439b0ffda17e613fda94d04"><div class="ttname"><a href="classvisitable.html#a91f3c0f8e439b0ffda17e613fda94d04">visitable::parents</a></div><div class="ttdeci">std::vector&lt; item * &gt; parents(const item &amp;it)</div><div class="ttdoc">Returns vector of parent containers (if any) starting with the innermost.</div><div class="ttdef"><b>Definition:</b> <a href="visitable_8cpp_source.html#l00073">visitable.cpp:73</a></div></div>
<div class="ttc" id="aclassvisitable_html_af49d5ef7b3f2f0a8664c23097a56373f"><div class="ttname"><a href="classvisitable.html#af49d5ef7b3f2f0a8664c23097a56373f">visitable::has_item</a></div><div class="ttdeci">bool has_item(const item &amp;it) const</div><div class="ttdoc">Returns true if this visitable instance contains the item.</div><div class="ttdef"><b>Definition:</b> <a href="visitable_8cpp_source.html#l00095">visitable.cpp:95</a></div></div>
<div class="ttc" id="agame_8cpp_html_a764052f34a47c6dee072c67b842a222c"><div class="ttname"><a href="game_8cpp.html#a764052f34a47c6dee072c67b842a222c">uistate</a></div><div class="ttdeci">uistatedata uistate</div><div class="ttdef"><b>Definition:</b> <a href="game_8cpp_source.html#l00284">game.cpp:284</a></div></div>
<div class="ttc" id="agroup__UI_html_ga7604af7545244003f0a52ac87ce37979"><div class="ttname"><a href="group__UI.html#ga7604af7545244003f0a52ac87ce37979">uilist::query</a></div><div class="ttdeci">void query(bool loop=true, int timeout=-1)</div><div class="ttdoc">Handle input and update display.</div><div class="ttdef"><b>Definition:</b> <a href="ui_8cpp_source.html#l00838">ui.cpp:838</a></div></div>
<div class="ttc" id="ainput_8cpp_html_af16c50890fa8503efa899fc3b6de56d7"><div class="ttname"><a href="input_8cpp.html#af16c50890fa8503efa899fc3b6de56d7">inp_mngr</a></div><div class="ttdeci">input_manager inp_mngr</div><div class="ttdef"><b>Definition:</b> <a href="input_8cpp_source.html#l00109">input.cpp:109</a></div></div>
<div class="ttc" id="ainput_8h_html_a7f98a32a40edbfcb172d2b4dde581f2c"><div class="ttname"><a href="input_8h.html#a7f98a32a40edbfcb172d2b4dde581f2c">KEY_LEFT</a></div><div class="ttdeci">static constexpr int KEY_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="input_8h_source.html#l00039">input.h:39</a></div></div>
<div class="ttc" id="ainput_8h_html_aef82d50d6bc11e0fa4b39c47c2129952"><div class="ttname"><a href="input_8h.html#aef82d50d6bc11e0fa4b39c47c2129952">KEY_RIGHT</a></div><div class="ttdeci">static constexpr int KEY_RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="input_8h_source.html#l00040">input.h:40</a></div></div>
<div class="ttc" id="anamespaceName_html_a305934c1ed39204d620efdee7dbec154"><div class="ttname"><a href="namespaceName.html#a305934c1ed39204d620efdee7dbec154">Name::names</a></div><div class="ttdeci">static std::map&lt; nameFlags, std::vector&lt; std::string &gt; &gt; names</div><div class="ttdef"><b>Definition:</b> <a href="name_8cpp_source.html#l00018">name.cpp:18</a></div></div>
<div class="ttc" id="anamespaceiexamine_html_ab9103bcb0e9cb4755b445e5395a0a62f"><div class="ttname"><a href="namespaceiexamine.html#ab9103bcb0e9cb4755b445e5395a0a62f">iexamine::transform</a></div><div class="ttdeci">void transform(player &amp;p, const tripoint &amp;pos)</div><div class="ttdoc">Transform the examined object into the object specified by its transforms_into property.</div><div class="ttdef"><b>Definition:</b> <a href="iexamine_8cpp_source.html#l01639">iexamine.cpp:1639</a></div></div>
<div class="ttc" id="astructdamage__instance_html"><div class="ttname"><a href="structdamage__instance.html">damage_instance</a></div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00051">damage.h:51</a></div></div>
<div class="ttc" id="astructdamage__instance_html_a2cc3ee4ff8f77ab6cd74168b1999246a"><div class="ttname"><a href="structdamage__instance.html#a2cc3ee4ff8f77ab6cd74168b1999246a">damage_instance::damage_units</a></div><div class="ttdeci">std::vector&lt; damage_unit &gt; damage_units</div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00052">damage.h:52</a></div></div>
<div class="ttc" id="astructdamage__instance_html_a96f6f6d008ed8744ce549cefcfec3951"><div class="ttname"><a href="structdamage__instance.html#a96f6f6d008ed8744ce549cefcfec3951">damage_instance::total_damage</a></div><div class="ttdeci">float total_damage() const</div><div class="ttdef"><b>Definition:</b> <a href="damage_8cpp_source.html#l00075">damage.cpp:75</a></div></div>
<div class="ttc" id="astructdamage__unit_html"><div class="ttname"><a href="structdamage__unit.html">damage_unit</a></div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00035">damage.h:35</a></div></div>
<div class="ttc" id="astructdamage__unit_html_a8c5cf76dd074bd5dac9b76aaece0ecf4"><div class="ttname"><a href="structdamage__unit.html#a8c5cf76dd074bd5dac9b76aaece0ecf4">damage_unit::damage_multiplier</a></div><div class="ttdeci">float damage_multiplier</div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00040">damage.h:40</a></div></div>
<div class="ttc" id="astructdamage__unit_html_ab4d1b13f7ebe2f16a43038e1441ec2b5"><div class="ttname"><a href="structdamage__unit.html#ab4d1b13f7ebe2f16a43038e1441ec2b5">damage_unit::res_pen</a></div><div class="ttdeci">float res_pen</div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00038">damage.h:38</a></div></div>
<div class="ttc" id="astructdamage__unit_html_af0a5ce1c282d7ed1a783fd4315404ec3"><div class="ttname"><a href="structdamage__unit.html#af0a5ce1c282d7ed1a783fd4315404ec3">damage_unit::res_mult</a></div><div class="ttdeci">float res_mult</div><div class="ttdef"><b>Definition:</b> <a href="damage_8h_source.html#l00039">damage.h:39</a></div></div>
<div class="ttc" id="astructinput__event_html"><div class="ttname"><a href="structinput__event.html">input_event</a></div><div class="ttdoc">An instance of an input, like a keypress etc.</div><div class="ttdef"><b>Definition:</b> <a href="input_8h_source.html#l00095">input.h:95</a></div></div>
<div class="ttc" id="astructitype_html"><div class="ttname"><a href="structitype.html">itype</a></div><div class="ttdef"><b>Definition:</b> <a href="itype_8h_source.html#l00836">itype.h:836</a></div></div>
<div class="ttc" id="astructitype_html_a7cb80d77696cefb42ac6e75756b47e60"><div class="ttname"><a href="structitype.html#a7cb80d77696cefb42ac6e75756b47e60">itype::ammo</a></div><div class="ttdeci">cata::value_ptr&lt; islot_ammo &gt; ammo</div><div class="ttdef"><b>Definition:</b> <a href="itype_8h_source.html#l00864">itype.h:864</a></div></div>
<div class="ttc" id="atype__id_8h_html_a4a240e1107e45f10d64b78f1b5f58d59"><div class="ttname"><a href="type__id_8h.html#a4a240e1107e45f10d64b78f1b5f58d59">ammotype</a></div><div class="ttdeci">string_id&lt; ammunition_type &gt; ammotype</div><div class="ttdef"><b>Definition:</b> <a href="type__id_8h_source.html#l00012">type_id.h:12</a></div></div>
<div class="ttc" id="aweather__type_8h_html_a72d839b22172d982273f161206458e25aa1a074a72eb46dfdde53e589d946ab98"><div class="ttname"><a href="weather__type_8h.html#a72d839b22172d982273f161206458e25aa1a074a72eb46dfdde53e589d946ab98">last</a></div><div class="ttdeci">@ last</div><div class="ttdef"><b>Definition:</b> <a href="weather__type_8h_source.html#l00064">weather_type.h:63</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="creature_8h_source.html#l00597">Creature::add_msg_if_player()</a>, <a class="el" href="item_8h_source.html#l00189">item_reload_option::ammo</a>, <a class="el" href="item_8cpp_source.html#l05303">item::has_flag()</a>, <a class="el" href="item_8cpp_source.html#l06662">item::is_ammo_container()</a>, <a class="el" href="creature_8h_source.html#l00098">Creature::is_npc()</a>, <a class="el" href="item_8cpp_source.html#l06724">item::is_watertight_container()</a>, <a class="el" href="character_8h_source.html#l01086">Character::is_worn()</a>, <a class="el" href="enums_8h_source.html#l00265">m_info</a>, <a class="el" href="name_8cpp_source.html#l00018">Name::names</a>, <a class="el" href="string__formatter_8h_source.html#l00431">string_format()</a>, <a class="el" href="ui_8h_source.html#l00320">uilist::text</a>, <a class="el" href="item_8cpp_source.html#l04554">item::tname()</a>, and <a class="el" href="iexamine_8cpp_source.html#l01639">iexamine::transform()</a>.</p>

<p class="reference">Referenced by <a class="el" href="npcmove_8cpp_source.html#l04560">npc::do_reload()</a>, <a class="el" href="avatar__action_8cpp_source.html#l01111">favorite_ammo_or_select()</a>, <a class="el" href="npcmove_8cpp_source.html#l01487">npc::find_reloadable()</a>, <a class="el" href="npcmove_8cpp_source.html#l01534">npc::find_usable_ammo()</a>, <a class="el" href="vehicle__use_8cpp_source.html#l01926">vehicle::interact_with()</a>, <a class="el" href="activity__actor_8cpp_source.html#l00285">aim_activity_actor::load_RAS_weapon()</a>, <a class="el" href="ranged_8cpp_source.html#l03798">ranged::prompt_select_default_ammo_for()</a>, <a class="el" href="iuse__actor_8cpp_source.html#l02872">bandolier_actor::reload()</a>, and <a class="el" href="iuse__actor_8cpp_source.html#l02998">ammobelt_actor::use()</a>.</p>

</div>
</div>
<a id="a35eeb8ee18c0888409eb1a131da3aae1" name="a35eeb8ee18c0888409eb1a131da3aae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35eeb8ee18c0888409eb1a131da3aae1">&#9670;&nbsp;</a></span>show_skill_capped_notice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::show_skill_capped_notice </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#a13f6e54f55e89d7c6cd86da6d0a7e785">skill_id</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This shows warning to the player that their current activity will not give them xp. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l01221">1221</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>{</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>    <span class="keywordflow">if</span>( !who.<a class="code hl_function" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    }</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>    <span class="keyword">const</span> <a class="code hl_class" href="classSkillLevel.html">SkillLevel</a> &amp;level = who.<a class="code hl_function" href="classCharacter.html#a2726ac089fa49e864b486e289f53fade">get_skill_level_object</a>( <span class="keywordtype">id</span> );</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span> </div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>    <span class="keyword">const</span> <a class="code hl_class" href="classSkill.html">Skill</a> &amp;skill = <span class="keywordtype">id</span>.obj();</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>    std::string skill_name = skill.<a class="code hl_function" href="classSkill.html#a11c69074ce9b251983f170510808bd85">name</a>();</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>    <span class="keywordtype">int</span> curLevel = level.<a class="code hl_function" href="classSkillLevel.html#a28763c074460e59ab2851ab31f9e2a3c">level</a>();</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span> </div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>    <a class="code hl_function" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;This task is too simple to train your %s beyond %d.&quot;</span> ),</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>             skill_name, curLevel );</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>}</div>
<div class="ttc" id="aclassCharacter_html_a2726ac089fa49e864b486e289f53fade"><div class="ttname"><a href="classCharacter.html#a2726ac089fa49e864b486e289f53fade">Character::get_skill_level_object</a></div><div class="ttdeci">SkillLevel &amp; get_skill_level_object(const skill_id &amp;ident)</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03312">character.cpp:3312</a></div></div>
<div class="ttc" id="aclassSkillLevel_html"><div class="ttname"><a href="classSkillLevel.html">SkillLevel</a></div><div class="ttdef"><b>Definition:</b> <a href="skill_8h_source.html#l00106">skill.h:107</a></div></div>
<div class="ttc" id="aclassSkillLevel_html_a28763c074460e59ab2851ab31f9e2a3c"><div class="ttname"><a href="classSkillLevel.html#a28763c074460e59ab2851ab31f9e2a3c">SkillLevel::level</a></div><div class="ttdeci">int level() const</div><div class="ttdef"><b>Definition:</b> <a href="skill_8h_source.html#l00125">skill.h:125</a></div></div>
<div class="ttc" id="aclassSkill_html"><div class="ttname"><a href="classSkill.html">Skill</a></div><div class="ttdef"><b>Definition:</b> <a href="skill_8h_source.html#l00032">skill.h:33</a></div></div>
<div class="ttc" id="aclassSkill_html_a11c69074ce9b251983f170510808bd85"><div class="ttname"><a href="classSkill.html#a11c69074ce9b251983f170510808bd85">Skill::name</a></div><div class="ttdeci">std::string name() const</div><div class="ttdef"><b>Definition:</b> <a href="skill_8h_source.html#l00068">skill.h:68</a></div></div>
<div class="ttc" id="amessages_8cpp_html_a54489326fc37823819c5105addfa27f2"><div class="ttname"><a href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a></div><div class="ttdeci">void add_msg(std::string msg)</div><div class="ttdef"><b>Definition:</b> <a href="messages_8cpp_source.html#l00884">messages.cpp:884</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="messages_8cpp_source.html#l00884">add_msg()</a>, <a class="el" href="character_8cpp_source.html#l03312">Character::get_skill_level_object()</a>, <a class="el" href="creature_8h_source.html#l00095">Creature::is_avatar()</a>, <a class="el" href="skill_8h_source.html#l00125">SkillLevel::level()</a>, <a class="el" href="enums_8h_source.html#l00265">m_info</a>, and <a class="el" href="skill_8h_source.html#l00068">Skill::name()</a>.</p>

<p class="reference">Referenced by <a class="el" href="character_8cpp_source.html#l03383">Character::practice()</a>, and <a class="el" href="crafting_8cpp_source.html#l00728">player::start_craft()</a>.</p>

</div>
</div>
<a id="adaa760a90e1a9cc452c7b756bcde2a60" name="adaa760a90e1a9cc452c7b756bcde2a60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa760a90e1a9cc452c7b756bcde2a60">&#9670;&nbsp;</a></span>siphon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::siphon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvehicle.html">vehicle</a> &amp;&#160;</td>
          <td class="paramname"><em>veh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="type__id_8h.html#ac2f82f863d4e9e8f267a77a73910ebbf">itype_id</a> &amp;&#160;</td>
          <td class="paramname"><em>desired_liquid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Siphons fuel (if available) from the specified vehicle into container or similar via game::handle_liquid. </p>
<p >May start a character activity. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00083">83</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>{</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="keywordflow">if</span>( !ch.<a class="code hl_function" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>() ) {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        <span class="comment">// TODO: implement for NPCs</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        <a class="code hl_define" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Siphoning not implemented for NPCs.&quot;</span> );</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <span class="keyword">auto</span> qty = veh.<a class="code hl_function" href="classvehicle.html#a5b3c37a197c21cdd469e7779f8c1db50">fuel_left</a>( desired_liquid );</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keywordflow">if</span>( qty &lt;= 0 ) {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        ch.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea72e7b82d57a6df0d4263c2043139b1b1">m_bad</a>, <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;There is not enough %s left to siphon it.&quot;</span> ),</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                              <a class="code hl_function" href="classitem.html#a438855ffd52d33307e1dfba6d607535b">item::nname</a>( desired_liquid ) );</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    }</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    <a class="code hl_class" href="classitem.html">item</a> liquid( desired_liquid, <a class="code hl_variable" href="namespacecalendar.html#ae15fcbf1c971589eb49c1a657fb6a580">calendar::turn</a>, qty );</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="keywordflow">if</span>( <a class="code hl_function" href="namespaceliquid__handler.html#a30393ea5ae789bd91dc85e09f7c504e2">liquid_handler::handle_liquid</a>( liquid, <span class="keyword">nullptr</span>, 1, <span class="keyword">nullptr</span>, &amp;veh ) ) {</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        veh.<a class="code hl_function" href="classvehicle.html#a2b28d63a4879b75d5a186289c54f6330">drain</a>( desired_liquid, qty - liquid.charges );</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    }</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>}</div>
<div class="ttc" id="aclassitem_html_a438855ffd52d33307e1dfba6d607535b"><div class="ttname"><a href="classitem.html#a438855ffd52d33307e1dfba6d607535b">item::nname</a></div><div class="ttdeci">static std::string nname(const itype_id &amp;id, unsigned int quantity=1)</div><div class="ttdoc">Returns the translated item name for the item with given id.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l09917">item.cpp:9917</a></div></div>
<div class="ttc" id="aclassvehicle_html_a2b28d63a4879b75d5a186289c54f6330"><div class="ttname"><a href="classvehicle.html#a2b28d63a4879b75d5a186289c54f6330">vehicle::drain</a></div><div class="ttdeci">int drain(const itype_id &amp;ftype, int amount)</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03427">vehicle.cpp:3427</a></div></div>
<div class="ttc" id="aclassvehicle_html_a5b3c37a197c21cdd469e7779f8c1db50"><div class="ttname"><a href="classvehicle.html#a5b3c37a197c21cdd469e7779f8c1db50">vehicle::fuel_left</a></div><div class="ttdeci">int fuel_left(const itype_id &amp;ftype, bool recurse=false) const</div><div class="ttdef"><b>Definition:</b> <a href="vehicle_8cpp_source.html#l03360">vehicle.cpp:3360</a></div></div>
<div class="ttc" id="anamespaceliquid__handler_html_a30393ea5ae789bd91dc85e09f7c504e2"><div class="ttname"><a href="namespaceliquid__handler.html#a30393ea5ae789bd91dc85e09f7c504e2">liquid_handler::handle_liquid</a></div><div class="ttdeci">bool handle_liquid(item &amp;liquid, item *const source, const int radius, const tripoint *const source_pos, const vehicle *const source_veh, const int part_num, const monster *const source_mon)</div><div class="ttdoc">This may start a player activity if either source_pos or source_veh is not null.</div><div class="ttdef"><b>Definition:</b> <a href="handle__liquid_8cpp_source.html#l00400">handle_liquid.cpp:400</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="creature_8h_source.html#l00597">Creature::add_msg_if_player()</a>, <a class="el" href="item_8h_source.html#l02196">item::charges</a>, <a class="el" href="debug_8h_source.html#l00074">debugmsg</a>, <a class="el" href="vehicle_8cpp_source.html#l03427">vehicle::drain()</a>, <a class="el" href="vehicle_8cpp_source.html#l03360">vehicle::fuel_left()</a>, <a class="el" href="handle__liquid_8cpp_source.html#l00400">liquid_handler::handle_liquid()</a>, <a class="el" href="creature_8h_source.html#l00095">Creature::is_avatar()</a>, <a class="el" href="enums_8h_source.html#l00261">m_bad</a>, <a class="el" href="item_8cpp_source.html#l09917">item::nname()</a>, and <a class="el" href="calendar_8cpp_source.html#l00036">calendar::turn</a>.</p>

<p class="reference">Referenced by <a class="el" href="vehicle__use_8cpp_source.html#l01926">vehicle::interact_with()</a>.</p>

</div>
</div>
<a id="a6bb166af94213cb87deb941f1852509e" name="a6bb166af94213cb87deb941f1852509e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bb166af94213cb87deb941f1852509e">&#9670;&nbsp;</a></span>store_in_container()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::store_in_container </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>container</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>put</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>penalties</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>base_cost</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores an item inside another consuming moves proportional to weapon skill and volume. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> doing the storing </td></tr>
    <tr><td class="paramname">container</td><td>Container in which to store the item </td></tr>
    <tr><td class="paramname">put</td><td>Item to add to the container </td></tr>
    <tr><td class="paramname">penalties</td><td>Whether item volume and temporary effects (e.g. GRABBED, DOWNED) should be considered </td></tr>
    <tr><td class="paramname">base_cost</td><td>Cost due to storage type </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00499">499</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>{</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    who.<a class="code hl_variable" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> -= who.<a class="code hl_function" href="classCharacter.html#aa93e1d185933bc96b038c4844b38ca90">item_store_cost</a>( put, container, penalties, base_cost );</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    container.<a class="code hl_function" href="classitem.html#a3841e9e250af73e45b14d5bb3cc7a043">put_in</a>( who.<a class="code hl_function" href="classCharacter.html#a35f89e2e6eb1144b623be5281f4f221b">i_rem</a>( &amp;put ) );</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    who.<a class="code hl_function" href="classCharacter.html#ad67a790400ac88405241f279b566b89e">reset_encumbrance</a>();</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>}</div>
<div class="ttc" id="aclassCharacter_html_a35f89e2e6eb1144b623be5281f4f221b"><div class="ttname"><a href="classCharacter.html#a35f89e2e6eb1144b623be5281f4f221b">Character::i_rem</a></div><div class="ttdeci">item i_rem(int pos)</div><div class="ttdoc">Remove a specific item from player possession.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l02342">character.cpp:2342</a></div></div>
<div class="ttc" id="aclassCharacter_html_aa93e1d185933bc96b038c4844b38ca90"><div class="ttname"><a href="classCharacter.html#aa93e1d185933bc96b038c4844b38ca90">Character::item_store_cost</a></div><div class="ttdeci">int item_store_cost(const item &amp;it, const item &amp;container, bool penalties=true, int base_cost=INVENTORY_HANDLING_PENALTY) const</div><div class="ttdoc">Calculate (but do not deduct) the number of moves required when storing an item in a container.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07456">character.cpp:7456</a></div></div>
<div class="ttc" id="aclassCharacter_html_ad67a790400ac88405241f279b566b89e"><div class="ttname"><a href="classCharacter.html#ad67a790400ac88405241f279b566b89e">Character::reset_encumbrance</a></div><div class="ttdeci">void reset_encumbrance()</div><div class="ttdoc">Recalculates encumbrance cache.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03631">character.cpp:3631</a></div></div>
<div class="ttc" id="aclassitem_html_a3841e9e250af73e45b14d5bb3cc7a043"><div class="ttname"><a href="classitem.html#a3841e9e250af73e45b14d5bb3cc7a043">item::put_in</a></div><div class="ttdeci">void put_in(const item &amp;payload)</div><div class="ttdoc">Puts the given item into this one, no checks are performed.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l00995">item.cpp:995</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character_8cpp_source.html#l02342">Character::i_rem()</a>, <a class="el" href="character_8cpp_source.html#l07456">Character::item_store_cost()</a>, <a class="el" href="creature_8h_source.html#l00574">Creature::moves</a>, <a class="el" href="item_8cpp_source.html#l00995">item::put_in()</a>, and <a class="el" href="character_8cpp_source.html#l03631">Character::reset_encumbrance()</a>.</p>

<p class="reference">Referenced by <a class="el" href="iuse__actor_8cpp_source.html#l02674">holster_actor::store()</a>.</p>

</div>
</div>
<a id="ab11c9faad62fd3d26d41cbf1d68391bb" name="ab11c9faad62fd3d26d41cbf1d68391bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11c9faad62fd3d26d41cbf1d68391bb">&#9670;&nbsp;</a></span>try_uncanny_dodge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::try_uncanny_dodge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to execute an uncanny dodge bionic ability. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> doing the dodging </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00578">578</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>{</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>    <span class="keyword">const</span> <a class="code hl_class" href="classunits_1_1quantity.html">units::energy</a> trigger_cost = <a class="code hl_variable" href="character__functions_8cpp.html#a798aca7aaa95fcd49a98b52c7be9b3cc">bio_uncanny_dodge</a>-&gt;<a class="code hl_variable" href="structbionic__data.html#a01bb3ba6e83ceeb4fed579177f084ae3">power_trigger</a>;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">get_power_level</a>() &lt; trigger_cost || !who.<a class="code hl_function" href="classCharacter.html#af9c7419575e23d52745c94009929fafb">has_active_bionic</a>( <a class="code hl_variable" href="character__functions_8cpp.html#a798aca7aaa95fcd49a98b52c7be9b3cc">bio_uncanny_dodge</a> ) ) {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>    }</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    who.<a class="code hl_function" href="classCharacter.html#a17446e14fd6046648a505c4aaec3d976">mod_power_level</a>( -trigger_cost );</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>    <span class="keywordtype">bool</span> is_u = who.<a class="code hl_function" href="classCreature.html#ac209d32cbfd3774af3d5c0500e2fae52">is_avatar</a>();</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>    <span class="keywordtype">bool</span> seen = is_u || <a class="code hl_function" href="character_8cpp.html#a2fcb25d686f4a35fca374c6f71280311">get_player_character</a>().<a class="code hl_function" href="classCharacter.html#aba9bd7517b334e6ed4149889ed32377a">sees</a>( who );</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>    <a class="code hl_class" href="classcata_1_1optional.html">cata::optional&lt;tripoint&gt;</a> adjacent = <a class="code hl_function" href="namespacecharacter__funcs.html#a13637305f9b6578e07749ae4ab8e784d">pick_safe_adjacent_tile</a>( who );</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>    <span class="keywordflow">if</span>( adjacent ) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        <span class="keywordflow">if</span>( is_u ) {</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>            <a class="code hl_function" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Time seems to slow down and you instinctively dodge!&quot;</span> ) );</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( seen ) {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>            <a class="code hl_function" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;%s dodges so fast!&quot;</span> ), who.<a class="code hl_function" href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">disp_name</a>() );</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>        }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>        <span class="keywordflow">if</span>( is_u ) {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            <a class="code hl_function" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;You try to dodge but there&#39;s no room!&quot;</span> ) );</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( seen ) {</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>            <a class="code hl_function" href="messages_8cpp.html#a54489326fc37823819c5105addfa27f2">add_msg</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;%s tries to dodge but there&#39;s no room!&quot;</span> ), who.<a class="code hl_function" href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">disp_name</a>() );</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        }</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    }</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>}</div>
<div class="ttc" id="acharacter_8cpp_html_a2fcb25d686f4a35fca374c6f71280311"><div class="ttname"><a href="character_8cpp.html#a2fcb25d686f4a35fca374c6f71280311">get_player_character</a></div><div class="ttdeci">Character &amp; get_player_character()</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00393">character.cpp:393</a></div></div>
<div class="ttc" id="acharacter__functions_8cpp_html_a798aca7aaa95fcd49a98b52c7be9b3cc"><div class="ttname"><a href="character__functions_8cpp.html#a798aca7aaa95fcd49a98b52c7be9b3cc">bio_uncanny_dodge</a></div><div class="ttdeci">static const bionic_id bio_uncanny_dodge(&quot;bio_uncanny_dodge&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a17446e14fd6046648a505c4aaec3d976"><div class="ttname"><a href="classCharacter.html#a17446e14fd6046648a505c4aaec3d976">Character::mod_power_level</a></div><div class="ttdeci">void mod_power_level(const units::energy &amp;npower)</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l01905">character.cpp:1905</a></div></div>
<div class="ttc" id="aclassCharacter_html_a1e1996b6d6fc0a86d917cd155e1656d8"><div class="ttname"><a href="classCharacter.html#a1e1996b6d6fc0a86d917cd155e1656d8">Character::disp_name</a></div><div class="ttdeci">std::string disp_name(bool possessive=false, bool capitalize_first=false) const override</div><div class="ttdoc">Returns either &quot;you&quot; or the player's name.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l00566">character.cpp:566</a></div></div>
<div class="ttc" id="aclassCharacter_html_add22510ff2fa20a662868b4dd86e030e"><div class="ttname"><a href="classCharacter.html#add22510ff2fa20a662868b4dd86e030e">Character::get_power_level</a></div><div class="ttdeci">units::energy get_power_level() const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l01885">character.cpp:1885</a></div></div>
<div class="ttc" id="aclassunits_1_1quantity_html"><div class="ttname"><a href="classunits_1_1quantity.html">units::quantity</a></div><div class="ttdef"><b>Definition:</b> <a href="units__def_8h_source.html#l00014">units_def.h:15</a></div></div>
<div class="ttc" id="anamespacecharacter__funcs_html_a13637305f9b6578e07749ae4ab8e784d"><div class="ttname"><a href="namespacecharacter__funcs.html#a13637305f9b6578e07749ae4ab8e784d">character_funcs::pick_safe_adjacent_tile</a></div><div class="ttdeci">cata::optional&lt; tripoint &gt; pick_safe_adjacent_tile(const Character &amp;who)</div><div class="ttdoc">Returns an unoccupied, safe adjacent point.</div><div class="ttdef"><b>Definition:</b> <a href="character__functions_8cpp_source.html#l00605">character_functions.cpp:605</a></div></div>
<div class="ttc" id="astructbionic__data_html_a01bb3ba6e83ceeb4fed579177f084ae3"><div class="ttname"><a href="structbionic__data.html#a01bb3ba6e83ceeb4fed579177f084ae3">bionic_data::power_trigger</a></div><div class="ttdeci">units::energy power_trigger</div><div class="ttdoc">Power cost when the bionic's special effect is triggered.</div><div class="ttdef"><b>Definition:</b> <a href="bionics_8h_source.html#l00043">bionics.h:43</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="messages_8cpp_source.html#l00884">add_msg()</a>, <a class="el" href="character__functions_8cpp.html#a798aca7aaa95fcd49a98b52c7be9b3cc">bio_uncanny_dodge</a>, <a class="el" href="character_8cpp_source.html#l00566">Character::disp_name()</a>, <a class="el" href="character_8cpp_source.html#l00393">get_player_character()</a>, <a class="el" href="character_8cpp_source.html#l01885">Character::get_power_level()</a>, <a class="el" href="character_8cpp_source.html#l01805">Character::has_active_bionic()</a>, <a class="el" href="creature_8h_source.html#l00095">Creature::is_avatar()</a>, <a class="el" href="character_8cpp_source.html#l01905">Character::mod_power_level()</a>, <a class="el" href="character__functions_8cpp_source.html#l00605">pick_safe_adjacent_tile()</a>, <a class="el" href="bionics_8h_source.html#l00043">bionic_data::power_trigger</a>, and <a class="el" href="character_8cpp_source.html#l10388">Character::sees()</a>.</p>

<p class="reference">Referenced by <a class="el" href="character_8cpp_source.html#l10615">Character::uncanny_dodge()</a>.</p>

</div>
</div>
<a id="a4da89a8af73cef834ada9624a6669a31" name="a4da89a8af73cef834ada9624a6669a31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da89a8af73cef834ada9624a6669a31">&#9670;&nbsp;</a></span>try_wield_contents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool character_funcs::try_wield_contents </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classitem.html">item</a> &amp;&#160;</td>
          <td class="paramname"><em>container</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classitem.html">item</a> *&#160;</td>
          <td class="paramname"><em>internal_item</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>penalties</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>base_cost</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to wield a contained item consuming moves proportional to weapon skill and volume. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">who</td><td><a class="el" href="classCharacter.html">Character</a> doing the wielding </td></tr>
    <tr><td class="paramname">container</td><td>Container containing the item to be wielded </td></tr>
    <tr><td class="paramname">internal_item</td><td>Reference to contained item to wield </td></tr>
    <tr><td class="paramname">penalties</td><td>Whether item volume and temporary effects (e.g. GRABBED, DOWNED) should be considered </td></tr>
    <tr><td class="paramname">base_cost</td><td>Cost due to storage type </td></tr>
  </table>
  </dd>
</dl>
Pistol decreases time taken to draw pistols from holsters Smg decreases time taken to draw smgs from holsters Rifle decreases time taken to draw rifles from holsters Shotgun decreases time taken to draw shotguns from holsters Launcher decreases time taken to draw launchers from holsters Stabbing decreases time taken to draw stabbing weapons from sheathes Cutting decreases time taken to draw cutting weapons from scabbards Bashing decreases time taken to draw bashing weapons from holsters 
<p class="definition">Definition at line <a class="el" href="character__functions_8cpp_source.html#l00506">506</a> of file <a class="el" href="character__functions_8cpp_source.html">character_functions.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>{</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    <span class="comment">// if index not specified and container has multiple items then ask the player to choose one</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    <span class="keywordflow">if</span>( internal_item == <span class="keyword">nullptr</span> ) {</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>        std::vector&lt;std::string&gt; opts;</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        std::list&lt;item *&gt; container_contents = container.<a class="code hl_variable" href="classitem.html#a4afe851abb42cbff0857065860f96e0e">contents</a>.<a class="code hl_function" href="classitem__contents.html#a7f56c09b0d592bdc425a578d02b4b44d">all_items_top</a>();</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        <a class="code hl_function" href="namespaceiexamine.html#ab9103bcb0e9cb4755b445e5395a0a62f">std::transform</a>( container_contents.begin(), container_contents.end(),</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>        std::back_inserter( opts ), []( <span class="keyword">const</span> <a class="code hl_class" href="classitem.html">item</a> * elem ) {</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>            return elem-&gt;display_name();</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        } );</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>        <span class="keywordflow">if</span>( opts.size() &gt; 1 ) {</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>            <span class="keywordtype">int</span> pos = <a class="code hl_class" href="classuilist.html">uilist</a>( <a class="code hl_define" href="translations_8h.html#aa829053017e23ef22d44dccecba63a34">_</a>( <span class="stringliteral">&quot;Wield what?&quot;</span> ), opts );</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>            <span class="keywordflow">if</span>( pos &lt; 0 ) {</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>            }</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            internal_item = *std::next( container_contents.begin(), pos );</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>            internal_item = &amp;container.<a class="code hl_variable" href="classitem.html#a4afe851abb42cbff0857065860f96e0e">contents</a>.<a class="code hl_function" href="classitem__contents.html#a14299e40ca1440af11623c86e0b84072">front</a>();</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>        }</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    }</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span> </div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    <span class="keywordflow">if</span>( !container.<a class="code hl_function" href="classvisitable.html#af49d5ef7b3f2f0a8664c23097a56373f">has_item</a>( *internal_item ) ) {</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        <a class="code hl_define" href="debug_8h.html#a87e509562277a7ada3a75330d00cb445">debugmsg</a>( <span class="stringliteral">&quot;Tried to wield non-existent item from container (player::wield_contents)&quot;</span> );</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    }</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span> </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    <span class="keyword">const</span> <a class="code hl_class" href="classret__val.html">ret_val&lt;bool&gt;</a> <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a> = who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>()-&gt;<a class="code hl_function" href="classCharacter.html#a8753a96ef412e005e487a5234abba7d5">can_wield</a>( *internal_item );</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>    <span class="keywordflow">if</span>( !<a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.success() ) {</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        who.<a class="code hl_function" href="classCreature.html#a91dc4715c36eef7d116f944be9a4d435">add_msg_if_player</a>( <a class="code hl_enumvalue" href="enums_8h.html#a3baf36d700701401b6baf94db93d096ea5d3734a51686ceb1848704dd277dfc7f">m_info</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_variable" href="namespacecata_1_1hash64__detail.html#a5ca825db6fd06946302c60daa97333e4">ret</a>.c_str() );</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    }</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span> </div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    <span class="keywordtype">int</span> mv = 0;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span> </div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#ad79464264cb8a2061f5888d092f5cd86">is_armed</a>() ) {</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="keywordflow">if</span>( !who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>()-&gt;<a class="code hl_function" href="classCharacter.html#a5140a7e16506aaabd28cf36c287b7619">unwield</a>() ) {</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        }</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        who.<a class="code hl_variable" href="classCharacter.html#a3d69eddc0a03b21378fc68cc08d32c7f">inv</a>.<a class="code hl_function" href="classinventory.html#a14ac26748e30d2d0f6c137734d55b2b5">unsort</a>();</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    }</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span> </div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    who.<a class="code hl_variable" href="classCharacter.html#ae68b7a6565646ba662e448bded8b6599">weapon</a> = <a class="code hl_function" href="namespaceavatar__action.html#a76ba74774376a08222b8cdcce08f7304">std::move</a>( *internal_item );</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>    container.<a class="code hl_function" href="classvisitable.html#adeb03e3af46e1b106a5f88f112add296">remove_item</a>( *internal_item );</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    container.<a class="code hl_function" href="classitem.html#a6d1575c31b1dc0df51cbe3a1dfbfef16">on_contents_changed</a>();</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    <a class="code hl_class" href="classitem.html">item</a> &amp;weapon = who.<a class="code hl_variable" href="classCharacter.html#ae68b7a6565646ba662e448bded8b6599">weapon</a>;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    who.<a class="code hl_variable" href="classCharacter.html#a3d69eddc0a03b21378fc68cc08d32c7f">inv</a>.<a class="code hl_function" href="classinventory.html#a4814b0d8a4fe394998ba690fb19a1d16">update_invlet</a>( weapon );</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    who.<a class="code hl_variable" href="classCharacter.html#a3d69eddc0a03b21378fc68cc08d32c7f">inv</a>.<a class="code hl_function" href="classinventory.html#a6632e04576710c1d9ee979850958e63c">update_cache_with_item</a>( weapon );</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    who.<a class="code hl_variable" href="classCharacter.html#a1819679d2d4e9f8ba5d62ae26737f34c">last_item</a> = weapon.<a class="code hl_function" href="classitem.html#aa79dad64e1ef6347219be2f8666e2752">typeId</a>();</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span><span class="comment"></span> </div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span><span class="comment">    /**</span></div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span><span class="comment">     * @EFFECT_PISTOL decreases time taken to draw pistols from holsters</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span><span class="comment">     * @EFFECT_SMG decreases time taken to draw smgs from holsters</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span><span class="comment">     * @EFFECT_RIFLE decreases time taken to draw rifles from holsters</span></div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span><span class="comment">     * @EFFECT_SHOTGUN decreases time taken to draw shotguns from holsters</span></div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span><span class="comment">     * @EFFECT_LAUNCHER decreases time taken to draw launchers from holsters</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span><span class="comment">     * @EFFECT_STABBING decreases time taken to draw stabbing weapons from sheathes</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span><span class="comment">     * @EFFECT_CUTTING decreases time taken to draw cutting weapons from scabbards</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span><span class="comment">     * @EFFECT_BASHING decreases time taken to draw bashing weapons from holsters</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span><span class="comment">     */</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    <span class="keywordtype">int</span> lvl = who.<a class="code hl_function" href="classCharacter.html#afa95fe499ca6b55ab97f1b442a4c95c5">get_skill_level</a>( weapon.<a class="code hl_function" href="classitem.html#a2912b2e15a4eec07a5070fffbbd152e8">is_gun</a>() ? weapon.<a class="code hl_function" href="classitem.html#a3d8542661f2e2a82e8cb3792584912f3">gun_skill</a>() : weapon.<a class="code hl_function" href="classitem.html#a634166a0674bcf69eb3874c7e7789344">melee_skill</a>() );</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    mv += who.<a class="code hl_function" href="classCharacter.html#a33b54fd8799f4b1c9f6b0af42dbf33f8">item_handling_cost</a>( weapon, penalties, base_cost ) / ( ( lvl + 10.0f ) / 10.0f );</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    who.<a class="code hl_variable" href="classCreature.html#a8c5a392caa213bee9581b47e9f0e2052">moves</a> -= mv;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    weapon.<a class="code hl_function" href="classitem.html#a435e1e28dc59e71f8cb985dd5c7db42c">on_wield</a>( *who.<a class="code hl_function" href="classCreature.html#acb1d0a1210d3dd4c86350f3ad4c58649">as_player</a>(), mv );</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span> </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>}</div>
<div class="ttc" id="aclassCharacter_html_a1819679d2d4e9f8ba5d62ae26737f34c"><div class="ttname"><a href="classCharacter.html#a1819679d2d4e9f8ba5d62ae26737f34c">Character::last_item</a></div><div class="ttdeci">itype_id last_item</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01545">character.h:1545</a></div></div>
<div class="ttc" id="aclassCharacter_html_a33b54fd8799f4b1c9f6b0af42dbf33f8"><div class="ttname"><a href="classCharacter.html#a33b54fd8799f4b1c9f6b0af42dbf33f8">Character::item_handling_cost</a></div><div class="ttdeci">int item_handling_cost(const item &amp;it, bool penalties=true, int base_cost=INVENTORY_HANDLING_PENALTY) const</div><div class="ttdoc">Calculate (but do not deduct) the number of moves required when handling (e.g.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l07432">character.cpp:7432</a></div></div>
<div class="ttc" id="aclassCharacter_html_a3d69eddc0a03b21378fc68cc08d32c7f"><div class="ttname"><a href="classCharacter.html#a3d69eddc0a03b21378fc68cc08d32c7f">Character::inv</a></div><div class="ttdeci">inventory inv</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01544">character.h:1544</a></div></div>
<div class="ttc" id="aclassCharacter_html_a5140a7e16506aaabd28cf36c287b7619"><div class="ttname"><a href="classCharacter.html#a5140a7e16506aaabd28cf36c287b7619">Character::unwield</a></div><div class="ttdeci">bool unwield()</div><div class="ttdoc">Removes currently wielded item (if any)</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03104">character.cpp:3104</a></div></div>
<div class="ttc" id="aclassCharacter_html_a8753a96ef412e005e487a5234abba7d5"><div class="ttname"><a href="classCharacter.html#a8753a96ef412e005e487a5234abba7d5">Character::can_wield</a></div><div class="ttdeci">ret_val&lt; bool &gt; can_wield(const item &amp;it) const</div><div class="ttdoc">Check whether character is capable of wielding given item.</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03056">character.cpp:3056</a></div></div>
<div class="ttc" id="aclassCharacter_html_afa95fe499ca6b55ab97f1b442a4c95c5"><div class="ttname"><a href="classCharacter.html#afa95fe499ca6b55ab97f1b442a4c95c5">Character::get_skill_level</a></div><div class="ttdeci">int get_skill_level(const skill_id &amp;ident) const</div><div class="ttdef"><b>Definition:</b> <a href="character_8cpp_source.html#l03317">character.cpp:3317</a></div></div>
<div class="ttc" id="aclassinventory_html_a14ac26748e30d2d0f6c137734d55b2b5"><div class="ttname"><a href="classinventory.html#a14ac26748e30d2d0f6c137734d55b2b5">inventory::unsort</a></div><div class="ttdeci">void unsort()</div><div class="ttdef"><b>Definition:</b> <a href="inventory_8cpp_source.html#l00227">inventory.cpp:227</a></div></div>
<div class="ttc" id="aclassinventory_html_a4814b0d8a4fe394998ba690fb19a1d16"><div class="ttname"><a href="classinventory.html#a4814b0d8a4fe394998ba690fb19a1d16">inventory::update_invlet</a></div><div class="ttdeci">void update_invlet(item &amp;it, bool assign_invlet=true)</div><div class="ttdef"><b>Definition:</b> <a href="inventory_8cpp_source.html#l01217">inventory.cpp:1217</a></div></div>
<div class="ttc" id="aclassinventory_html_a6632e04576710c1d9ee979850958e63c"><div class="ttname"><a href="classinventory.html#a6632e04576710c1d9ee979850958e63c">inventory::update_cache_with_item</a></div><div class="ttdeci">void update_cache_with_item(item &amp;newit)</div><div class="ttdef"><b>Definition:</b> <a href="inventory_8cpp_source.html#l00253">inventory.cpp:253</a></div></div>
<div class="ttc" id="aclassitem__contents_html_a7f56c09b0d592bdc425a578d02b4b44d"><div class="ttname"><a href="classitem__contents.html#a7f56c09b0d592bdc425a578d02b4b44d">item_contents::all_items_top</a></div><div class="ttdeci">std::list&lt; item * &gt; all_items_top()</div><div class="ttdoc">returns a list of pointers to all top-level items</div><div class="ttdef"><b>Definition:</b> <a href="item__contents_8cpp_source.html#l00128">item_contents.cpp:128</a></div></div>
<div class="ttc" id="aclassitem_html_a3d8542661f2e2a82e8cb3792584912f3"><div class="ttname"><a href="classitem.html#a3d8542661f2e2a82e8cb3792584912f3">item::gun_skill</a></div><div class="ttdeci">skill_id gun_skill() const</div><div class="ttdoc">The skill used to operate the gun.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07182">item.cpp:7182</a></div></div>
<div class="ttc" id="aclassitem_html_a435e1e28dc59e71f8cb985dd5c7db42c"><div class="ttname"><a href="classitem.html#a435e1e28dc59e71f8cb985dd5c7db42c">item::on_wield</a></div><div class="ttdeci">void on_wield(player &amp;p, int mv=0)</div><div class="ttdoc">Callback when a player starts wielding the item.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l04415">item.cpp:4415</a></div></div>
<div class="ttc" id="aclassitem_html_a634166a0674bcf69eb3874c7e7789344"><div class="ttname"><a href="classitem.html#a634166a0674bcf69eb3874c7e7789344">item::melee_skill</a></div><div class="ttdeci">skill_id melee_skill() const</div><div class="ttdoc">The most relevant skill used with this melee weapon.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l07203">item.cpp:7203</a></div></div>
<div class="ttc" id="aclassitem_html_a6d1575c31b1dc0df51cbe3a1dfbfef16"><div class="ttname"><a href="classitem.html#a6d1575c31b1dc0df51cbe3a1dfbfef16">item::on_contents_changed</a></div><div class="ttdeci">void on_contents_changed()</div><div class="ttdoc">Callback when contents of the item are affected in any way other than just processing.</div><div class="ttdef"><b>Definition:</b> <a href="item_8cpp_source.html#l04538">item.cpp:4538</a></div></div>
<div class="ttc" id="aclassret__val_html"><div class="ttname"><a href="classret__val.html">ret_val</a></div><div class="ttdoc">The class represents a composite return value of an arbitrary function (result).</div><div class="ttdef"><b>Definition:</b> <a href="ret__val_8h_source.html#l00020">ret_val.h:21</a></div></div>
<div class="ttc" id="aclassvisitable_html_adeb03e3af46e1b106a5f88f112add296"><div class="ttname"><a href="classvisitable.html#adeb03e3af46e1b106a5f88f112add296">visitable::remove_item</a></div><div class="ttdeci">item remove_item(item &amp;it)</div><div class="ttdoc">Removes and returns the item which must be contained by this instance.</div><div class="ttdef"><b>Definition:</b> <a href="visitable_8cpp_source.html#l00563">visitable.cpp:563</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="translations_8h_source.html#l00116">_</a>, <a class="el" href="creature_8h_source.html#l00597">Creature::add_msg_if_player()</a>, <a class="el" href="item__contents_8cpp_source.html#l00128">item_contents::all_items_top()</a>, <a class="el" href="creature_8h_source.html#l00122">Creature::as_player()</a>, <a class="el" href="character_8cpp_source.html#l03056">Character::can_wield()</a>, <a class="el" href="item_8h_source.html#l02158">item::contents</a>, <a class="el" href="debug_8h_source.html#l00074">debugmsg</a>, <a class="el" href="item__contents_8cpp_source.html#l00190">item_contents::front()</a>, <a class="el" href="character_8cpp_source.html#l03317">Character::get_skill_level()</a>, <a class="el" href="item_8cpp_source.html#l07182">item::gun_skill()</a>, <a class="el" href="visitable_8cpp_source.html#l00095">visitable&lt; T &gt;::has_item()</a>, <a class="el" href="character_8h_source.html#l01544">Character::inv</a>, <a class="el" href="melee_8cpp_source.html#l00148">Character::is_armed()</a>, <a class="el" href="item_8cpp_source.html#l06517">item::is_gun()</a>, <a class="el" href="character_8cpp_source.html#l07432">Character::item_handling_cost()</a>, <a class="el" href="character_8h_source.html#l01545">Character::last_item</a>, <a class="el" href="enums_8h_source.html#l00265">m_info</a>, <a class="el" href="item_8cpp_source.html#l07203">item::melee_skill()</a>, <a class="el" href="avatar__action_8cpp_source.html#l00096">avatar_action::move()</a>, <a class="el" href="creature_8h_source.html#l00574">Creature::moves</a>, <a class="el" href="item_8cpp_source.html#l04538">item::on_contents_changed()</a>, <a class="el" href="item_8cpp_source.html#l04415">item::on_wield()</a>, <a class="el" href="visitable_8cpp_source.html#l00563">visitable&lt; T &gt;::remove_item()</a>, <a class="el" href="hash__utils_8h_source.html#l00097">cata::hash64_detail::ret</a>, <a class="el" href="iexamine_8cpp_source.html#l01639">iexamine::transform()</a>, <a class="el" href="item_8cpp_source.html#l08353">item::typeId()</a>, <a class="el" href="inventory_8cpp_source.html#l00227">inventory::unsort()</a>, <a class="el" href="character_8cpp_source.html#l03104">Character::unwield()</a>, <a class="el" href="inventory_8cpp_source.html#l00253">inventory::update_cache_with_item()</a>, <a class="el" href="inventory_8cpp_source.html#l01217">inventory::update_invlet()</a>, and <a class="el" href="character_8h_source.html#l01546">Character::weapon</a>.</p>

<p class="reference">Referenced by <a class="el" href="iuse__actor_8cpp_source.html#l02723">holster_actor::use()</a>.</p>

</div>
</div>
<a id="afa9463f9c384d1e193bdbc8dc337f8d3" name="afa9463f9c384d1e193bdbc8dc337f8d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa9463f9c384d1e193bdbc8dc337f8d3">&#9670;&nbsp;</a></span>update_body_wetness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::update_body_wetness </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structw__point.html">w_point</a> &amp;&#160;</td>
          <td class="paramname"><em>weather</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maintains body wetness and handles the rate at which the player dries. </p>

<p class="definition">Definition at line <a class="el" href="character__turn_8cpp_source.html#l00892">892</a> of file <a class="el" href="character__turn_8cpp_source.html">character_turn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>{</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>    <span class="comment">// Average number of turns to go from completely soaked to fully dry</span></div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    <span class="comment">// assuming average temperature and humidity</span></div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    <span class="keyword">constexpr</span> <a class="code hl_class" href="classtime__duration.html">time_duration</a> average_drying = 2_hours;</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span> </div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    <span class="comment">// A modifier on drying time</span></div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <span class="keywordtype">double</span> delay = 1.0;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>    <span class="comment">// Weather slows down drying</span></div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>    delay += ( ( <a class="code hl_namespace" href="namespaceweather.html">weather</a>.humidity - 66 ) - ( <a class="code hl_function" href="namespaceunits.html#a375816854bc926ebda4d9240e7d6cf64">units::to_fahrenheit</a>( <a class="code hl_namespace" href="namespaceweather.html">weather</a>.temperature ) - 65 ) ) / 100;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>    delay = std::max( 0.1, delay );</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>    <span class="comment">// Fur/slime retains moisture</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a80c61d54a8759044f6c7c841469ee11d">trait_LIGHTFUR</a> ) ||</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>        who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#aa9c71c27aec3d6c98d982792f15e613c">trait_FUR</a> ) ||</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>        who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a83afbd8e4dbefc1f99df9624fd9d7824">trait_FELINE_FUR</a> ) ||</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>        who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#aeced506658f24495d18152830064a45f">trait_LUPINE_FUR</a> ) ||</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>        who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a328aaa21f9e64c2d22a68b9764a6a550">trait_CHITIN_FUR</a> ) ||</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>        who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#afeabd53c61defabb9ba3721de6b91280">trait_CHITIN_FUR2</a> ) ||</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>        who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a7b9b5dc5aace58de30f3602e0413cfb8">trait_CHITIN_FUR3</a> ) ) {</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>        delay = delay * 6 / 5;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>    }</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    <span class="keywordflow">if</span>( who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#af83add4ee97cce1fc50812e5c46f73cc">trait_URSINE_FUR</a> ) || who.<a class="code hl_function" href="classCharacter.html#af06dd97724f4f05df782e7a4b4f9cfe1">has_trait</a>( <a class="code hl_variable" href="character__turn_8cpp.html#a0651a103f4530a625fc7defcd7372b37">trait_SLIMY</a> ) ) {</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>        delay *= 1.5;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    }</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span> </div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>    <span class="keywordflow">if</span>( !<a class="code hl_function" href="calendar_8cpp.html#a359120c15f92d54a49fec9de7bcb571f">x_in_y</a>( 1, to_turns&lt;int&gt;( average_drying * delay / 100.0 ) ) ) {</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>        <span class="comment">// No drying this turn</span></div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    }</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>    <span class="comment">// Now per-body-part stuff</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>    <span class="comment">// To make drying uniform, make just one roll and reuse it</span></div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> drying_roll = <a class="code hl_function" href="artifact_8cpp.html#a70800e95389f34dd34186fafaea2a840">rng</a>( 1, 80 );</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span> </div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>    <span class="keywordflow">for</span>( <span class="keyword">const</span> <a class="code hl_enumeration" href="bodypart_8h.html#af618290c4c2de42aab87977ac7311980">body_part</a> bp : <a class="code hl_variable" href="bodypart_8h.html#a089a199d69623f528a3883672f0a084e">all_body_parts</a> ) {</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>        <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a66520fe7648d455282596ead87701655">body_wetness</a>[bp] == 0 ) {</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>        }</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>        <span class="comment">// This is to normalize drying times</span></div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>        <span class="keywordtype">int</span> drying_chance = who.<a class="code hl_variable" href="classCharacter.html#ab7700517fb07e9155e559b3c2e427a65">drench_capacity</a>[bp];</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>        <span class="comment">// Body temperature affects duration of wetness</span></div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>        <span class="comment">// Note: Using temp_conv rather than temp_cur, to better approximate environment</span></div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>        <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a450ed42503c02c36c04faa550a5b8f70">temp_conv</a>[bp] &gt;= <a class="code hl_variable" href="weather_8h.html#a353f46362b1fd4a5eb685d5f7b271079">BODYTEMP_SCORCHING</a> ) {</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            drying_chance *= 2;</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a450ed42503c02c36c04faa550a5b8f70">temp_conv</a>[bp] &gt;= <a class="code hl_variable" href="weather_8h.html#a8220ffde7e07de66ab06bdeba262a2c3">BODYTEMP_VERY_HOT</a> ) {</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>            drying_chance = drying_chance * 3 / 2;</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a450ed42503c02c36c04faa550a5b8f70">temp_conv</a>[bp] &gt;= <a class="code hl_variable" href="weather_8h.html#aa69b18b562ac33b8688ca8e3e95a9205">BODYTEMP_HOT</a> ) {</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>            drying_chance = drying_chance * 4 / 3;</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a450ed42503c02c36c04faa550a5b8f70">temp_conv</a>[bp] &gt; <a class="code hl_variable" href="weather_8h.html#a08fc0049be5212458556d07723095141">BODYTEMP_COLD</a> ) {</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>            <span class="comment">// Comfortable, doesn&#39;t need any changes</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>            <span class="comment">// Evaporation doesn&#39;t change that much at lower temp</span></div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>            drying_chance = drying_chance * 3 / 4;</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        }</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span> </div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>        <span class="keywordflow">if</span>( drying_chance &lt; 1 ) {</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>            drying_chance = 1;</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        }</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span> </div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        <span class="comment">// TODO: Make evaporation reduce body heat</span></div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        <span class="keywordflow">if</span>( drying_chance &gt;= drying_roll ) {</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>            who.<a class="code hl_variable" href="classCharacter.html#a66520fe7648d455282596ead87701655">body_wetness</a>[bp] -= 1;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>            <span class="keywordflow">if</span>( who.<a class="code hl_variable" href="classCharacter.html#a66520fe7648d455282596ead87701655">body_wetness</a>[bp] &lt; 0 ) {</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>                who.<a class="code hl_variable" href="classCharacter.html#a66520fe7648d455282596ead87701655">body_wetness</a>[bp] = 0;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>            }</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>        }</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>    }</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    <span class="comment">// TODO: Make clothing slow down drying</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>}</div>
<div class="ttc" id="acharacter__turn_8cpp_html_a0651a103f4530a625fc7defcd7372b37"><div class="ttname"><a href="character__turn_8cpp.html#a0651a103f4530a625fc7defcd7372b37">trait_SLIMY</a></div><div class="ttdeci">static const trait_id trait_SLIMY(&quot;SLIMY&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_a328aaa21f9e64c2d22a68b9764a6a550"><div class="ttname"><a href="character__turn_8cpp.html#a328aaa21f9e64c2d22a68b9764a6a550">trait_CHITIN_FUR</a></div><div class="ttdeci">static const trait_id trait_CHITIN_FUR(&quot;CHITIN_FUR&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_a7b9b5dc5aace58de30f3602e0413cfb8"><div class="ttname"><a href="character__turn_8cpp.html#a7b9b5dc5aace58de30f3602e0413cfb8">trait_CHITIN_FUR3</a></div><div class="ttdeci">static const trait_id trait_CHITIN_FUR3(&quot;CHITIN_FUR3&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_a80c61d54a8759044f6c7c841469ee11d"><div class="ttname"><a href="character__turn_8cpp.html#a80c61d54a8759044f6c7c841469ee11d">trait_LIGHTFUR</a></div><div class="ttdeci">static const trait_id trait_LIGHTFUR(&quot;LIGHTFUR&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_a83afbd8e4dbefc1f99df9624fd9d7824"><div class="ttname"><a href="character__turn_8cpp.html#a83afbd8e4dbefc1f99df9624fd9d7824">trait_FELINE_FUR</a></div><div class="ttdeci">static const trait_id trait_FELINE_FUR(&quot;FELINE_FUR&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_aa9c71c27aec3d6c98d982792f15e613c"><div class="ttname"><a href="character__turn_8cpp.html#aa9c71c27aec3d6c98d982792f15e613c">trait_FUR</a></div><div class="ttdeci">static const trait_id trait_FUR(&quot;FUR&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_aeced506658f24495d18152830064a45f"><div class="ttname"><a href="character__turn_8cpp.html#aeced506658f24495d18152830064a45f">trait_LUPINE_FUR</a></div><div class="ttdeci">static const trait_id trait_LUPINE_FUR(&quot;LUPINE_FUR&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_af83add4ee97cce1fc50812e5c46f73cc"><div class="ttname"><a href="character__turn_8cpp.html#af83add4ee97cce1fc50812e5c46f73cc">trait_URSINE_FUR</a></div><div class="ttdeci">static const trait_id trait_URSINE_FUR(&quot;URSINE_FUR&quot;)</div></div>
<div class="ttc" id="acharacter__turn_8cpp_html_afeabd53c61defabb9ba3721de6b91280"><div class="ttname"><a href="character__turn_8cpp.html#afeabd53c61defabb9ba3721de6b91280">trait_CHITIN_FUR2</a></div><div class="ttdeci">static const trait_id trait_CHITIN_FUR2(&quot;CHITIN_FUR2&quot;)</div></div>
<div class="ttc" id="aclassCharacter_html_a66520fe7648d455282596ead87701655"><div class="ttname"><a href="classCharacter.html#a66520fe7648d455282596ead87701655">Character::body_wetness</a></div><div class="ttdeci">std::array&lt; int, num_bp &gt; body_wetness</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02259">character.h:2259</a></div></div>
<div class="ttc" id="aclassCharacter_html_ab7700517fb07e9155e559b3c2e427a65"><div class="ttname"><a href="classCharacter.html#ab7700517fb07e9155e559b3c2e427a65">Character::drench_capacity</a></div><div class="ttdeci">std::array&lt; int, num_bp &gt; drench_capacity</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l02260">character.h:2260</a></div></div>
<div class="ttc" id="anamespaceunits_html_a375816854bc926ebda4d9240e7d6cf64"><div class="ttname"><a href="namespaceunits.html#a375816854bc926ebda4d9240e7d6cf64">units::to_fahrenheit</a></div><div class="ttdeci">constexpr value_type to_fahrenheit(const quantity&lt; value_type, temperature_in_millidegree_celsius_tag &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="units__temperature_8h_source.html#l00124">units_temperature.h:124</a></div></div>
<div class="ttc" id="anamespaceweather_html"><div class="ttname"><a href="namespaceweather.html">weather</a></div><div class="ttdef"><b>Definition:</b> <a href="weather_8cpp_source.html#l01150">weather.cpp:1151</a></div></div>
<div class="ttc" id="aweather_8h_html_a08fc0049be5212458556d07723095141"><div class="ttname"><a href="weather_8h.html#a08fc0049be5212458556d07723095141">BODYTEMP_COLD</a></div><div class="ttdeci">static constexpr int BODYTEMP_COLD</div><div class="ttdoc">Do not change this value, it is an arbitrary anchor on which other calculations are made.</div><div class="ttdef"><b>Definition:</b> <a href="weather_8h_source.html#l00034">weather.h:34</a></div></div>
<div class="ttc" id="aweather_8h_html_a353f46362b1fd4a5eb685d5f7b271079"><div class="ttname"><a href="weather_8h.html#a353f46362b1fd4a5eb685d5f7b271079">BODYTEMP_SCORCHING</a></div><div class="ttdeci">static constexpr int BODYTEMP_SCORCHING</div><div class="ttdef"><b>Definition:</b> <a href="weather_8h_source.html#l00042">weather.h:42</a></div></div>
<div class="ttc" id="aweather_8h_html_a8220ffde7e07de66ab06bdeba262a2c3"><div class="ttname"><a href="weather_8h.html#a8220ffde7e07de66ab06bdeba262a2c3">BODYTEMP_VERY_HOT</a></div><div class="ttdeci">static constexpr int BODYTEMP_VERY_HOT</div><div class="ttdoc">Level 3 hotness.</div><div class="ttdef"><b>Definition:</b> <a href="weather_8h_source.html#l00040">weather.h:40</a></div></div>
<div class="ttc" id="aweather_8h_html_aa69b18b562ac33b8688ca8e3e95a9205"><div class="ttname"><a href="weather_8h.html#aa69b18b562ac33b8688ca8e3e95a9205">BODYTEMP_HOT</a></div><div class="ttdeci">static constexpr int BODYTEMP_HOT</div><div class="ttdoc">Level 2 hotness.</div><div class="ttdef"><b>Definition:</b> <a href="weather_8h_source.html#l00038">weather.h:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="bodypart_8h_source.html#l00082">all_body_parts</a>, <a class="el" href="character_8h_source.html#l02259">Character::body_wetness</a>, <a class="el" href="weather_8h_source.html#l00034">BODYTEMP_COLD</a>, <a class="el" href="weather_8h_source.html#l00038">BODYTEMP_HOT</a>, <a class="el" href="weather_8h_source.html#l00042">BODYTEMP_SCORCHING</a>, <a class="el" href="weather_8h_source.html#l00040">BODYTEMP_VERY_HOT</a>, <a class="el" href="character_8h_source.html#l02260">Character::drench_capacity</a>, <a class="el" href="mutation_8cpp_source.html#l00101">Character::has_trait()</a>, <a class="el" href="artifact_8cpp_source.html#l00032">rng()</a>, <a class="el" href="character_8h_source.html#l02258">Character::temp_conv</a>, <a class="el" href="units__temperature_8h_source.html#l00124">units::to_fahrenheit()</a>, <a class="el" href="character__turn_8cpp.html#a328aaa21f9e64c2d22a68b9764a6a550">trait_CHITIN_FUR</a>, <a class="el" href="character__turn_8cpp.html#afeabd53c61defabb9ba3721de6b91280">trait_CHITIN_FUR2</a>, <a class="el" href="character__turn_8cpp.html#a7b9b5dc5aace58de30f3602e0413cfb8">trait_CHITIN_FUR3</a>, <a class="el" href="character__turn_8cpp.html#a83afbd8e4dbefc1f99df9624fd9d7824">trait_FELINE_FUR</a>, <a class="el" href="character__turn_8cpp.html#aa9c71c27aec3d6c98d982792f15e613c">trait_FUR</a>, <a class="el" href="character__turn_8cpp.html#a80c61d54a8759044f6c7c841469ee11d">trait_LIGHTFUR</a>, <a class="el" href="character__turn_8cpp.html#aeced506658f24495d18152830064a45f">trait_LUPINE_FUR</a>, <a class="el" href="character__turn_8cpp.html#a0651a103f4530a625fc7defcd7372b37">trait_SLIMY</a>, <a class="el" href="character__turn_8cpp.html#af83add4ee97cce1fc50812e5c46f73cc">trait_URSINE_FUR</a>, and <a class="el" href="calendar_8cpp_source.html#l00521">x_in_y()</a>.</p>

<p class="reference">Referenced by <a class="el" href="game_8cpp_source.html#l01343">game::do_turn()</a>.</p>

</div>
</div>
<a id="a641323aa837163a8a245868a5043035a" name="a641323aa837163a8a245868a5043035a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a641323aa837163a8a245868a5043035a">&#9670;&nbsp;</a></span>update_mental_focus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void character_funcs::update_mental_focus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCharacter.html">Character</a> &amp;&#160;</td>
          <td class="paramname"><em>who</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uses calc_focus_change to update the player's current focus. </p>

<p class="definition">Definition at line <a class="el" href="character__turn_8cpp_source.html#l01099">1099</a> of file <a class="el" href="character__turn_8cpp_source.html">character_turn.cpp</a>.</p>
<div class="fragment"><div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>{</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>    who.<a class="code hl_variable" href="classCharacter.html#a1a22be593582c9aef166a12777bb79a8">focus_pool</a> += <a class="code hl_function" href="namespacecharacter__effects.html#a8cb6340e4be4183a0afdaaed94697f48">character_effects::calc_focus_change</a>( who );</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>}</div>
<div class="ttc" id="aclassCharacter_html_a1a22be593582c9aef166a12777bb79a8"><div class="ttname"><a href="classCharacter.html#a1a22be593582c9aef166a12777bb79a8">Character::focus_pool</a></div><div class="ttdeci">int focus_pool</div><div class="ttdef"><b>Definition:</b> <a href="character_8h_source.html#l01560">character.h:1560</a></div></div>
<div class="ttc" id="anamespacecharacter__effects_html_a8cb6340e4be4183a0afdaaed94697f48"><div class="ttname"><a href="namespacecharacter__effects.html#a8cb6340e4be4183a0afdaaed94697f48">character_effects::calc_focus_change</a></div><div class="ttdeci">int calc_focus_change(const Character &amp;who)</div><div class="ttdoc">Calculates actual focus gain/loss value from focus equilibrium.</div><div class="ttdef"><b>Definition:</b> <a href="character__effects_8cpp_source.html#l00248">character_effects.cpp:248</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="character__effects_8cpp_source.html#l00248">character_effects::calc_focus_change()</a>, and <a class="el" href="character_8h_source.html#l01560">Character::focus_pool</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__turn_8cpp_source.html#l00575">Character::reset_stats()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4e103652bd1f087acad98fa135eca4a4" name="a4e103652bd1f087acad98fa135eca4a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e103652bd1f087acad98fa135eca4a4">&#9670;&nbsp;</a></span>FINE_VISION_PERFECT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float character_funcs::FINE_VISION_PERFECT = 1.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Value for perfect fine detail vision. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8h_source.html#l00044">44</a> of file <a class="el" href="character__functions_8h_source.html">character_functions.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="avatar_8cpp_source.html#l00387">avatar::read()</a>.</p>

</div>
</div>
<a id="ac767ac632c0c783c8615f5e920cc938e" name="ac767ac632c0c783c8615f5e920cc938e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac767ac632c0c783c8615f5e920cc938e">&#9670;&nbsp;</a></span>FINE_VISION_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr float character_funcs::FINE_VISION_THRESHOLD = 4.0f</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Threshold for fine detail vision mod. </p>

<p class="definition">Definition at line <a class="el" href="character__functions_8h_source.html#l00042">42</a> of file <a class="el" href="character__functions_8h_source.html">character_functions.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="character__functions_8cpp_source.html#l00177">can_see_fine_details()</a>, and <a class="el" href="crafting_8cpp_source.html#l00132">lighting_crafting_speed_multiplier()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecharacter__funcs.html">character_funcs</a></li>
    <li class="footer">Generated on Tue Apr 4 2023 22:41:00 for Cataclysm BN by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
